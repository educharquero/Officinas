{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\ud83d\udc27 Bem-vindo \u00e0 Comunidade Officinas \ud83d\udcda Este \u00e9 o portal de conhecimento t\u00e9cnico e colaborativo da Comunidade Officinas , voltado ao aprendizado, pr\u00e1tica e documenta\u00e7\u00e3o de tecnologias voltadas ao uso de Linux , servidores , infraestrutura de rede e muito mais. \ud83d\udc49 Objetivos RESPONSABILIDADE SOCIAL - Promover o Software Livre com todo o entusiasmo que vem da cria\u00e7\u00e3o e edi\u00e7\u00e3o de arquivos e os resultados pr\u00e1ticos desse trabalho, proporcionando liberdade, transpar\u00eancia, estabilidade e seguran\u00e7a ao parque de TI regional. INCLUS\u00c3O DIGITAL - A possibilidade de crescimento comunit\u00e1rio aliado a capacidade de impactar pessoas, \u00e1 que percebam novas possibilidades no futuro. FORMA\u00c7\u00c3O PROFISSIONAL - Possibilitar a forma\u00e7\u00e3o de novos gestores de TI \u00e1 m\u00e9dio e longo prazo. TRANSPAR\u00caNCIA - Incentivando a ado\u00e7\u00e3o de ferramentas com c\u00f3digo fonte audit\u00e1vel, para uso na m\u00e1quina p\u00fablica ou privada. Abaixo voc\u00ea encontrar\u00e1 conte\u00fados organizados em m\u00f3dulos, tutoriais pr\u00e1ticos, configura\u00e7\u00f5es de servi\u00e7os e materiais de apoio. \ud83d\udcc2 Vis\u00e3o Geral Vis\u00e3o Geral Hist\u00f3ria \ud83d\udee0\ufe0f Servidores DC1 Compilado DC1 Binarios DC1 Rocky DC2 Rocky DHCP Server DNS Server Fileserver Debian binario Fileserver Rocky Fileserver Rocky Linux Firewall Server MkDocs Server NFS Server Fileserver sem RSAT RAID \ud83d\udcdf Sistema Operacional OpenSUSE Systemd FHS \ud83d\udd29 M\u00f3dulos M\u00f3dulo 103.1 - Aula 00 M\u00f3dulo 103.1 - Aula 01 M\u00f3dulo 103.1 - Aula 02 M\u00f3dulo 103.1 - Aula 03 M\u00f3dulo 103.1 - Aula 04 M\u00f3dulo 103.1 - Aula 05 M\u00f3dulo 103.2 - Aula 01 \ud83d\udd12 Permiss\u00f5es e Usu\u00e1rios Permiss\u00f5es Linux - Parte 01 Permiss\u00f5es Linux - Parte 02 Usu\u00e1rios e Grupos - Parte 01 Usu\u00e1rios e Grupos - Parte 02 \ud83d\udd27 Outros Universo *NIX \ud83e\uddd1\u200d\ud83d\udcbb Propostas LABORAT\u00d3RIO pr\u00e1tico com computadores, Sistema operacional, aplica\u00e7\u00f5es e arquivos de configura\u00e7\u00e3o, no melhor estilo \"m\u00e3o na massa\". DOCUMENTA\u00c7\u00c3O te\u00f3rica de apoio, atualizada, formatada e disponibilizada para estudos dentro ou fora da sala. INSTRUTOR dispon\u00edvel \u00e1 turma de alunos, para subirmos juntos cada degrau dessa tremenda escalada! SOFTWARE LIVRE aliando os conceitos de divers\u00e3o e responsabilidade. Visite a p\u00e1gina do Linux Professional Institute aqui . Baixe uma c\u00f3pia do Debian Linux \ud83d\udc27 Imagem ISO O SENHOR \u00e9 quem d\u00e1 sabedoria e o entendimento procede dEle! (Prov 2:6) \ud83d\udca1","title":"\ud83d\udc27 Bem-vindo \u00e0 Comunidade Officinas"},{"location":"#bem-vindo-a-comunidade-officinas","text":"\ud83d\udcda Este \u00e9 o portal de conhecimento t\u00e9cnico e colaborativo da Comunidade Officinas , voltado ao aprendizado, pr\u00e1tica e documenta\u00e7\u00e3o de tecnologias voltadas ao uso de Linux , servidores , infraestrutura de rede e muito mais.","title":"\ud83d\udc27 Bem-vindo \u00e0 Comunidade Officinas"},{"location":"#objetivos","text":"RESPONSABILIDADE SOCIAL - Promover o Software Livre com todo o entusiasmo que vem da cria\u00e7\u00e3o e edi\u00e7\u00e3o de arquivos e os resultados pr\u00e1ticos desse trabalho, proporcionando liberdade, transpar\u00eancia, estabilidade e seguran\u00e7a ao parque de TI regional. INCLUS\u00c3O DIGITAL - A possibilidade de crescimento comunit\u00e1rio aliado a capacidade de impactar pessoas, \u00e1 que percebam novas possibilidades no futuro. FORMA\u00c7\u00c3O PROFISSIONAL - Possibilitar a forma\u00e7\u00e3o de novos gestores de TI \u00e1 m\u00e9dio e longo prazo. TRANSPAR\u00caNCIA - Incentivando a ado\u00e7\u00e3o de ferramentas com c\u00f3digo fonte audit\u00e1vel, para uso na m\u00e1quina p\u00fablica ou privada. Abaixo voc\u00ea encontrar\u00e1 conte\u00fados organizados em m\u00f3dulos, tutoriais pr\u00e1ticos, configura\u00e7\u00f5es de servi\u00e7os e materiais de apoio.","title":"\ud83d\udc49 Objetivos"},{"location":"#visao-geral","text":"Vis\u00e3o Geral Hist\u00f3ria","title":"\ud83d\udcc2 Vis\u00e3o Geral"},{"location":"#servidores","text":"DC1 Compilado DC1 Binarios DC1 Rocky DC2 Rocky DHCP Server DNS Server Fileserver Debian binario Fileserver Rocky Fileserver Rocky Linux Firewall Server MkDocs Server NFS Server Fileserver sem RSAT RAID","title":"\ud83d\udee0\ufe0f Servidores"},{"location":"#sistema-operacional","text":"OpenSUSE Systemd FHS","title":"\ud83d\udcdf Sistema Operacional"},{"location":"#modulos","text":"M\u00f3dulo 103.1 - Aula 00 M\u00f3dulo 103.1 - Aula 01 M\u00f3dulo 103.1 - Aula 02 M\u00f3dulo 103.1 - Aula 03 M\u00f3dulo 103.1 - Aula 04 M\u00f3dulo 103.1 - Aula 05 M\u00f3dulo 103.2 - Aula 01","title":"\ud83d\udd29 M\u00f3dulos"},{"location":"#permissoes-e-usuarios","text":"Permiss\u00f5es Linux - Parte 01 Permiss\u00f5es Linux - Parte 02 Usu\u00e1rios e Grupos - Parte 01 Usu\u00e1rios e Grupos - Parte 02","title":"\ud83d\udd12 Permiss\u00f5es e Usu\u00e1rios"},{"location":"#outros","text":"Universo *NIX","title":"\ud83d\udd27 Outros"},{"location":"#propostas","text":"LABORAT\u00d3RIO pr\u00e1tico com computadores, Sistema operacional, aplica\u00e7\u00f5es e arquivos de configura\u00e7\u00e3o, no melhor estilo \"m\u00e3o na massa\". DOCUMENTA\u00c7\u00c3O te\u00f3rica de apoio, atualizada, formatada e disponibilizada para estudos dentro ou fora da sala. INSTRUTOR dispon\u00edvel \u00e1 turma de alunos, para subirmos juntos cada degrau dessa tremenda escalada! SOFTWARE LIVRE aliando os conceitos de divers\u00e3o e responsabilidade. Visite a p\u00e1gina do Linux Professional Institute aqui . Baixe uma c\u00f3pia do Debian Linux \ud83d\udc27 Imagem ISO O SENHOR \u00e9 quem d\u00e1 sabedoria e o entendimento procede dEle! (Prov 2:6) \ud83d\udca1","title":"\ud83e\uddd1\u200d\ud83d\udcbb Propostas"},{"location":"DC1_Rocky/","text":"\ud83d\udcc1 DC1 Rocky Controlador de Dom\u00ednio Prim\u00e1rio no Rocky Linux 9 Update do sistema: yum update -y && yum upgrade -y Instalar o editor de texto nano : dnf install nano Verificar sua configura\u00e7\u00e3o de rede e DNS , bem como nome de dom\u00ednio . Uma das formas: Abra um terminal e chame o nmtui: nmtui Selecione Editar uma conex\u00e3o . Ent\u00e3o a op\u00e7\u00e3o Editar . Verificar ou alterar seu endere\u00e7o ip e m\u00e1scara de sub-rede e seu Gateway . Na op\u00e7\u00e3o Servidor DNS : inserir o DNS desejado. N\u00e3o esquecer de inserir em Dom\u00ednios de pesquisa: seu.dom\u00ednio . V\u00e1 at\u00e9 o fim e selecione OK para salvar. Selecione Voltar e ent\u00e3o no menu: selecionar a op\u00e7\u00e3o: Definir nome de m\u00e1quina do sistema : dc1.seu.dominio. Agora selecione a op\u00e7\u00e3o: OK para salvar. Novamente selecione OK . Deve retornar para o terminal. Editar o arquivo /etc/host : nano /etc/hosts Inserir os dados referentes ao seu servidor: 127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6 # inserir os dados de seu server 10.1.1.31 dc1 dc1.seu.dominio Onde: 10.1.1.31 = IP de seu pr\u00f3prio AD-DC (controlador de dom\u00ednio) dc1 = nome simplificado do seu host de seu controlador de dom\u00ednio dc1.seu.dom\u00ednio = nome do host + seu.dom\u00ednio Veririficar se existe algum processo do samba rodando: # ps ax | egrep \"samba|smbd|nmbd|winbindd\" Remover qualquer config file que houver, checando com o comando: # smbd -b | grep \"CONFIGFILE\" CONFIGFILE: /usr/local/samba/etc/samba/smb.conf Remover todos arquivos de data base que houver. Como: .tdb e .ldb: # smbd -b | egrep \"LOCKDIR|STATEDIR|CACHEDIR|PRIVATE_DIR\" LOCKDIR: /usr/local/samba/var/lock/ STATEDIR: /usr/local/samba/var/locks/ CACHEDIR: /usr/local/samba/var/cache/ PRIVATE_DIR: /usr/local/samba/private/ Remover o arquivo /etc/krb5.conf se houver, com o comando: rm /etc/krb5.conf Instalar plugins e habilitar o reposit\u00f3rio PowerTools com os comandos abaixo: dnf install dnf-plugins-core dnf install epel-release dnf config-manager --set-enabled powertools dnf update Checar os reposit\u00f3rios adicionados com o comando: dnf repolist O resultado deve ser algo como: id do repo nome do repo appstream Rocky Linux 8 - AppStream baseos Rocky Linux 8 - BaseOS devel Rocky Linux 8 - Devel WARNING! FOR BUILDROOT AND KOJI USE - epel Extra Packages for Enterprise Linux 8 - x86_64 - extras Rocky Linux 8 - Extras - powertools Rocky Linux 8 - PowerTools Setar a hora local (ntp): Listando as op\u00e7\u00f5es de hora local. timedatectl list-timezones Para setar o timezone desejado, usar o comando: timedatectl set-timezone America/Sao_Paulo Verificando o timezone setado: timedatectl O resultado deve parecer como abaixo: Local time: qua 2023-04-12 09:04:22 -03 Universal time: qua 2023-04-12 12:04:22 UTC RTC time: qua 2023-04-12 12:00:16 Time zone: America/Sao_Paulo (-03, -0300) System clock synchronized: yes NTP service: active RTC in local TZ: no Instalar as depend\u00eancias dos pacotes. Fazer um arquivo do tipo script execut\u00e1vel e inserir os comandos: nano depende.sh Inserir os comandos: set -xueo pipefail yum update -y yum install -y dnf-plugins-core yum install -y epel-release yum -v repolist all yum config-manager --set-enabled PowerTools -y || \\ yum config-manager --set-enabled powertools -y yum config-manager --set-enabled Devel -y || \\ yum config-manager --set-enabled devel -y yum update -y yum install -y \\ --setopt=install_weak_deps=False \\ \"@Development Tools\" \\ acl \\ attr \\ autoconf \\ avahi-devel \\ bind-utils \\ binutils \\ bison \\ ccache \\ chrpath \\ cups-devel \\ curl \\ dbus-devel \\ docbook-dtds \\ docbook-style-xsl \\ flex \\ gawk \\ gcc \\ gdb \\ git \\ glib2-devel \\ glibc-common \\ glibc-langpack-en \\ glusterfs-api-devel \\ glusterfs-devel \\ gnutls-devel \\ gpgme-devel \\ gzip \\ hostname \\ htop \\ jansson-devel \\ keyutils-libs-devel \\ krb5-devel \\ krb5-server \\ libacl-devel \\ libarchive-devel \\ libattr-devel \\ libblkid-devel \\ libbsd-devel \\ libcap-devel \\ libcephfs-devel \\ libicu-devel \\ libnsl2-devel \\ libpcap-devel \\ libtasn1-devel \\ libtasn1-tools \\ libtirpc-devel \\ libunwind-devel \\ libuuid-devel \\ libxslt \\ lmdb \\ lmdb-devel \\ make \\ mingw64-gcc \\ ncurses-devel \\ openldap-devel \\ pam-devel \\ patch \\ perl \\ perl-Archive-Tar \\ perl-ExtUtils-MakeMaker \\ perl-JSON \\ perl-Parse-Yapp \\ perl-Test-Simple \\ perl-generators \\ perl-interpreter \\ pkgconfig \\ popt-devel \\ procps-ng \\ psmisc \\ python3 \\ python3-cryptography \\ python3-devel \\ python3-dns \\ python3-gpg \\ python3-iso8601 \\ python3-libsemanage \\ python3-markdown \\ python3-policycoreutils \\ python3-pyasn1 \\ python3-setproctitle \\ quota-devel \\ readline-devel \\ redhat-lsb \\ rng-tools \\ rpcgen \\ rpcsvc-proto-devel \\ rsync \\ sed \\ sudo \\ systemd-devel \\ tar \\ tree \\ wget \\ which \\ xfsprogs-devel \\ yum-utils \\ zlib-devel \\ nano \\ krb5-workstation yum clean all Salvar o arquivo Transformar o arquivo em um execut\u00e1vel com o comando: chmod +x depende.sh Executar o aquivo com o comando: ./depende.sh Fazer download da \u00faltima vers\u00e3o do samba ou da vers\u00e3o desejada: wget https://download.samba.org/pub/samba/stable/samba-4.18.0.tar.gz Descompactar o arquivo baixado: tar -zxvf samba-nome-arquivo Mudar para o diret\u00f3rio onde foi descompactado: cd samba-nome-arquivo/ Compilar o samba para o arquivo de configura\u00e7\u00e3o ficar em: /etc/samba/smb.conf com o comando: ./configure --sysconfdir=/etc/samba/ Aguarde o processo finalizar. E ent\u00e3o fa\u00e7a os comandos make e make install: make && make install No diret\u00f3rio /root edite o arquivo .bash_profile nano .bash_profile E inserir a linha: # User specific environment and startup programs PATH=$PATH:$HOME/bin # ESTA LINHA PATH=/usr/local/samba/bin/:/usr/local/samba/sbin/:$PATH export PATH Salvar o arquivo Criar um arquivo de servi\u00e7o systemd. Executar os comandos: # systemctl mask smbd nmbd winbind # systemctl disable smbd nmbd winbind Criar o arquivo em: /etc/systemd/system/samba-ad-dc.service nano /etc/systemd/system/samba-ad-dc.service Com as seguintes linhas: [Unit] Description=Samba Active Directory Domain Controller After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/usr/local/samba/sbin/samba -D PIDFile=/usr/local/samba/var/run/samba.pid ExecReload=/bin/kill -HUP $MAINPID [Install] WantedBy=multi-user.target Salvar o arquivo Recarrregar o systemd com o comando: systemctl daemon-reload Habilitar o samba-ad-dc para iniciar no boot do sistema: systemctl enable samba-ad-dc Verificar em qual dispositivo de rede est\u00e1 sua conex\u00e3o: ip a O resultado deve ser parecido com isso: 2: ens18: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000 link/ether de:1e:07:63:42:51 brd ff:ff:ff:ff:ff:ff altname enp0s18 inet 10.1.1.31/24 brd 10.1.1.255 scope global noprefixroute ens18 OBS : o ens18 neste caso \u00e9 seu dispositivo Reestart o sistema: reboot Vamos Provisionar o Samba. Abrir um terminal: samba-tool domain provision --use-rfc2307 --interactive --option=\"interfaces= lo ens18\" --option=\"bind interfaces only=yes\" Responda as quest\u00f5es referente sua configura\u00e7\u00e3o: Realm: SEU.Dominio Domain [AD]: Dom\u00ednio Server Role (dc, member, standalone) [dc]: dc DNS backend (SAMBA_INTERNAL, BIND9_FLATFILE, BIND9_DLZ, NONE) SAMBA_INTERNAL]: SAMBA_INTERNAL DNS forwarder IP address (write 'none' to disable forwarding) [SEU_IP_DNS]:IP DNS Administrator password: escolher uma senha Retype password: repetir a mesma senha OBS: Guarde a senha de provisionamento Configurar Kerberos: cp /usr/local/samba/private/krb5.conf /etc/krb5.conf Reestart o servi\u00e7o do samba-ad com o comando: systemctl restart samba-ad-dc Para parar servi\u00e7o fazer o comando: systemctl stop samba-ad-dc Se necessitar desabilitar o servi\u00e7o, utilizar o comando: systemctl disable samba-ad-dc Verificar a vers\u00e3o do samba: smbclient --version Testar o samba com o comando: smbclient -L localhost -U% Verificar o DNS (_ldap): host -t SRV _ldap._tcp.seu.dominio Verificar _kerberos : host -t SRV _kerberos._udp.seu.dominio. A Grava\u00e7\u00e3o A host -t A seu.dominio Verificando o Kerberos kinit Administrator Password for Administrator@SEU.DOMINIO: Warning: Your password will expire in 41 days on Tue 22 Sep 2020 03:41:22 PM IST Listar o cache dos tickets klist Com a resposta parecida com essa: Valid starting Expires Service principal 13/04/2023 13:54:57 13/04/2023 23:54:57 krbtgt/SEU.DOMINIO@SEU.DOMINIO renew until 14/04/2023 13:54:50 Configurar o Firewall Adicionar servi\u00e7os: firewall-cmd --add-service={dns,ldap,ldaps,kerberos} Adicionar portas: firewall-cmd --add-port={389/udp,135/tcp,135/udp,138/udp,138/tcp,137/tcp,137/udp,139/udp,139/tcp,445/tcp,445/udp,3268/udp,3268/tcp,3269/tcp,3269/udp,49152/tcp} Recarregar o Firewall: firewall-cmd --reload Para Criar um Segundo DC, clique aqui Replica\u00e7\u00e3o do SysVol (backup do AD) para um DC2 Gerar uma chave SSH-Keygen no DC1 com o comando: ssh-keygen -t rsa Algumas perguntas ser\u00e3o feitas: Onde salvar o arquvo de chave, que neste caso: (/root/.ssh/id_rsa) teclar enter Entre com uma senha (ou apenas digite enter para ficar sem senha), teclar enter Entre com a senha novamente: teclar enter A sa\u00edda ser\u00e1 algo como: Your identification has been saved in /root/.ssh/id_rsa. Your public key has been saved in /root/.ssh/id_rsa.pub. Quando a chave for criada, copiar para o servidor que ser\u00e1 o segundo DC2 com o comando: ssh-copy-id user-dc2@IP-Seu-DC2 Agora pode-se conectar com ssh sem requerer senha de acesso. Conecte-se via ssh em seu DC2 e mude as permiss\u00f5es de acesso para que o usu\u00e1rio do dc2 possa escrever no diret\u00f3rio com o comando: chown root.user-dc2 -R /usr/local/samba/var/locks/sysvol/ Fazendo o backup do DC1 para o DC2. Para um teste antes, fazer o comando usando a op\u00e7\u00e3o --dry-run para apenas um teste sem altera\u00e7\u00e3o. rsync --dry-run -XAavz --delete-after --progress --stats /usr/local/samba/var/locks/sysvol/ user-dc2@IP-DC2:/usr/local/samba/var/locks/sysvol/ O comando rsync far\u00e1 uma copia do sysvol de seu DC1 ( parte1 ) para o sysvol de seu DC2 ( parte2 ): Parte 1: rsync --dry-run -XAavz --delete-after --progress --stats /usr/local/samba/var/locks/sysvol/ Parte 2: user-dc2@ IP-DC2:/usr/local/samba/var/locks/sysvol/ O resultado deve ser algo parecido com: building file list ... 12 files to consider ./ seu.dominio/ seu.dominio/Policies/ seu.dominio/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/ seu.dominio/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/GPT.INI seu.dominio/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/MACHINE/ seu.dominio/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/USER/ seu.dominio/Policies/{6AC1786C-016F-11D2-945F-00C04FB984F9}/ seu.dominio/Policies/{6AC1786C-016F-11D2-945F-00C04FB984F9}/GPT.INI seu.dominio/Policies/{6AC1786C-016F-11D2-945F-00C04FB984F9}/MACHINE/ seu.dominio/Policies/{6AC1786C-016F-11D2-945F-00C04FB984F9}/USER/ seu.dominio/scripts/ Number of files: 12 (reg: 2, dir: 10) Number of created files: 9 (reg: 2, dir: 7) Number of deleted files: 0 Number of regular files transferred: 2 Total file size: 40 bytes Total transferred file size: 40 bytes Literal data: 0 bytes Matched data: 0 bytes File list size: 0 File list generation time: 0.038 seconds File list transfer time: 0.000 seconds Total bytes sent: 2,011 Total bytes received: 51 sent 2,011 bytes received 51 bytes 1,374.67 bytes/sec total size is 40 speedup is 0.02 **(DRY RUN)** Com o resultado positivo, pode-se rodar o comando sem a op\u00e7\u00e3o --dry-run : rsync -XAavz --delete-after --progress --stats /usr/local/samba/var/locks/sysvol/ dc2@IP-DC2:/usr/local/samba/var/locks/sysvol/ Para automatizar o processo, inserir o comando no crontab . Para aprender mais sobre o crontab clique aqui Adicionar um script no crontab com o comando: crontab -e E insira a linha: 0 12 * * 1-5 root rsync -XAavz --delete-after --progress --stats /usr/local/samba/var/locks/sysvol/ srvad2@10.1.1.38:/usr/local/samba/var/locks/sysvol/ THAT\u2019S ALL FOLKS!!","title":"\ud83d\udcc1 DC1 Rocky"},{"location":"DC1_Rocky/#dc1-rocky","text":"","title":"\ud83d\udcc1 DC1 Rocky"},{"location":"DC1_Rocky/#controlador-de-dominio-primario-no-rocky-linux-9","text":"Update do sistema: yum update -y && yum upgrade -y Instalar o editor de texto nano : dnf install nano Verificar sua configura\u00e7\u00e3o de rede e DNS , bem como nome de dom\u00ednio . Uma das formas: Abra um terminal e chame o nmtui: nmtui Selecione Editar uma conex\u00e3o . Ent\u00e3o a op\u00e7\u00e3o Editar . Verificar ou alterar seu endere\u00e7o ip e m\u00e1scara de sub-rede e seu Gateway . Na op\u00e7\u00e3o Servidor DNS : inserir o DNS desejado. N\u00e3o esquecer de inserir em Dom\u00ednios de pesquisa: seu.dom\u00ednio . V\u00e1 at\u00e9 o fim e selecione OK para salvar. Selecione Voltar e ent\u00e3o no menu: selecionar a op\u00e7\u00e3o: Definir nome de m\u00e1quina do sistema : dc1.seu.dominio. Agora selecione a op\u00e7\u00e3o: OK para salvar. Novamente selecione OK . Deve retornar para o terminal. Editar o arquivo /etc/host : nano /etc/hosts Inserir os dados referentes ao seu servidor: 127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6 # inserir os dados de seu server 10.1.1.31 dc1 dc1.seu.dominio Onde: 10.1.1.31 = IP de seu pr\u00f3prio AD-DC (controlador de dom\u00ednio) dc1 = nome simplificado do seu host de seu controlador de dom\u00ednio dc1.seu.dom\u00ednio = nome do host + seu.dom\u00ednio Veririficar se existe algum processo do samba rodando: # ps ax | egrep \"samba|smbd|nmbd|winbindd\" Remover qualquer config file que houver, checando com o comando: # smbd -b | grep \"CONFIGFILE\" CONFIGFILE: /usr/local/samba/etc/samba/smb.conf Remover todos arquivos de data base que houver. Como: .tdb e .ldb: # smbd -b | egrep \"LOCKDIR|STATEDIR|CACHEDIR|PRIVATE_DIR\" LOCKDIR: /usr/local/samba/var/lock/ STATEDIR: /usr/local/samba/var/locks/ CACHEDIR: /usr/local/samba/var/cache/ PRIVATE_DIR: /usr/local/samba/private/ Remover o arquivo /etc/krb5.conf se houver, com o comando: rm /etc/krb5.conf Instalar plugins e habilitar o reposit\u00f3rio PowerTools com os comandos abaixo: dnf install dnf-plugins-core dnf install epel-release dnf config-manager --set-enabled powertools dnf update Checar os reposit\u00f3rios adicionados com o comando: dnf repolist O resultado deve ser algo como: id do repo nome do repo appstream Rocky Linux 8 - AppStream baseos Rocky Linux 8 - BaseOS devel Rocky Linux 8 - Devel WARNING! FOR BUILDROOT AND KOJI USE - epel Extra Packages for Enterprise Linux 8 - x86_64 - extras Rocky Linux 8 - Extras - powertools Rocky Linux 8 - PowerTools","title":"Controlador de Dom\u00ednio Prim\u00e1rio no Rocky Linux 9"},{"location":"DC1_Rocky/#setar-a-hora-local-ntp","text":"Listando as op\u00e7\u00f5es de hora local. timedatectl list-timezones Para setar o timezone desejado, usar o comando: timedatectl set-timezone America/Sao_Paulo Verificando o timezone setado: timedatectl O resultado deve parecer como abaixo: Local time: qua 2023-04-12 09:04:22 -03 Universal time: qua 2023-04-12 12:04:22 UTC RTC time: qua 2023-04-12 12:00:16 Time zone: America/Sao_Paulo (-03, -0300) System clock synchronized: yes NTP service: active RTC in local TZ: no Instalar as depend\u00eancias dos pacotes. Fazer um arquivo do tipo script execut\u00e1vel e inserir os comandos: nano depende.sh Inserir os comandos: set -xueo pipefail yum update -y yum install -y dnf-plugins-core yum install -y epel-release yum -v repolist all yum config-manager --set-enabled PowerTools -y || \\ yum config-manager --set-enabled powertools -y yum config-manager --set-enabled Devel -y || \\ yum config-manager --set-enabled devel -y yum update -y yum install -y \\ --setopt=install_weak_deps=False \\ \"@Development Tools\" \\ acl \\ attr \\ autoconf \\ avahi-devel \\ bind-utils \\ binutils \\ bison \\ ccache \\ chrpath \\ cups-devel \\ curl \\ dbus-devel \\ docbook-dtds \\ docbook-style-xsl \\ flex \\ gawk \\ gcc \\ gdb \\ git \\ glib2-devel \\ glibc-common \\ glibc-langpack-en \\ glusterfs-api-devel \\ glusterfs-devel \\ gnutls-devel \\ gpgme-devel \\ gzip \\ hostname \\ htop \\ jansson-devel \\ keyutils-libs-devel \\ krb5-devel \\ krb5-server \\ libacl-devel \\ libarchive-devel \\ libattr-devel \\ libblkid-devel \\ libbsd-devel \\ libcap-devel \\ libcephfs-devel \\ libicu-devel \\ libnsl2-devel \\ libpcap-devel \\ libtasn1-devel \\ libtasn1-tools \\ libtirpc-devel \\ libunwind-devel \\ libuuid-devel \\ libxslt \\ lmdb \\ lmdb-devel \\ make \\ mingw64-gcc \\ ncurses-devel \\ openldap-devel \\ pam-devel \\ patch \\ perl \\ perl-Archive-Tar \\ perl-ExtUtils-MakeMaker \\ perl-JSON \\ perl-Parse-Yapp \\ perl-Test-Simple \\ perl-generators \\ perl-interpreter \\ pkgconfig \\ popt-devel \\ procps-ng \\ psmisc \\ python3 \\ python3-cryptography \\ python3-devel \\ python3-dns \\ python3-gpg \\ python3-iso8601 \\ python3-libsemanage \\ python3-markdown \\ python3-policycoreutils \\ python3-pyasn1 \\ python3-setproctitle \\ quota-devel \\ readline-devel \\ redhat-lsb \\ rng-tools \\ rpcgen \\ rpcsvc-proto-devel \\ rsync \\ sed \\ sudo \\ systemd-devel \\ tar \\ tree \\ wget \\ which \\ xfsprogs-devel \\ yum-utils \\ zlib-devel \\ nano \\ krb5-workstation yum clean all Salvar o arquivo Transformar o arquivo em um execut\u00e1vel com o comando: chmod +x depende.sh Executar o aquivo com o comando: ./depende.sh Fazer download da \u00faltima vers\u00e3o do samba ou da vers\u00e3o desejada: wget https://download.samba.org/pub/samba/stable/samba-4.18.0.tar.gz Descompactar o arquivo baixado: tar -zxvf samba-nome-arquivo Mudar para o diret\u00f3rio onde foi descompactado: cd samba-nome-arquivo/ Compilar o samba para o arquivo de configura\u00e7\u00e3o ficar em: /etc/samba/smb.conf com o comando: ./configure --sysconfdir=/etc/samba/ Aguarde o processo finalizar. E ent\u00e3o fa\u00e7a os comandos make e make install: make && make install No diret\u00f3rio /root edite o arquivo .bash_profile nano .bash_profile E inserir a linha: # User specific environment and startup programs PATH=$PATH:$HOME/bin # ESTA LINHA PATH=/usr/local/samba/bin/:/usr/local/samba/sbin/:$PATH export PATH Salvar o arquivo","title":"Setar a hora local (ntp):"},{"location":"DC1_Rocky/#criar-um-arquivo-de-servico-systemd","text":"Executar os comandos: # systemctl mask smbd nmbd winbind # systemctl disable smbd nmbd winbind Criar o arquivo em: /etc/systemd/system/samba-ad-dc.service nano /etc/systemd/system/samba-ad-dc.service Com as seguintes linhas: [Unit] Description=Samba Active Directory Domain Controller After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/usr/local/samba/sbin/samba -D PIDFile=/usr/local/samba/var/run/samba.pid ExecReload=/bin/kill -HUP $MAINPID [Install] WantedBy=multi-user.target Salvar o arquivo Recarrregar o systemd com o comando: systemctl daemon-reload Habilitar o samba-ad-dc para iniciar no boot do sistema: systemctl enable samba-ad-dc Verificar em qual dispositivo de rede est\u00e1 sua conex\u00e3o: ip a O resultado deve ser parecido com isso: 2: ens18: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000 link/ether de:1e:07:63:42:51 brd ff:ff:ff:ff:ff:ff altname enp0s18 inet 10.1.1.31/24 brd 10.1.1.255 scope global noprefixroute ens18 OBS : o ens18 neste caso \u00e9 seu dispositivo Reestart o sistema: reboot Vamos Provisionar o Samba. Abrir um terminal: samba-tool domain provision --use-rfc2307 --interactive --option=\"interfaces= lo ens18\" --option=\"bind interfaces only=yes\" Responda as quest\u00f5es referente sua configura\u00e7\u00e3o: Realm: SEU.Dominio Domain [AD]: Dom\u00ednio Server Role (dc, member, standalone) [dc]: dc DNS backend (SAMBA_INTERNAL, BIND9_FLATFILE, BIND9_DLZ, NONE) SAMBA_INTERNAL]: SAMBA_INTERNAL DNS forwarder IP address (write 'none' to disable forwarding) [SEU_IP_DNS]:IP DNS Administrator password: escolher uma senha Retype password: repetir a mesma senha OBS: Guarde a senha de provisionamento Configurar Kerberos: cp /usr/local/samba/private/krb5.conf /etc/krb5.conf Reestart o servi\u00e7o do samba-ad com o comando: systemctl restart samba-ad-dc Para parar servi\u00e7o fazer o comando: systemctl stop samba-ad-dc Se necessitar desabilitar o servi\u00e7o, utilizar o comando: systemctl disable samba-ad-dc Verificar a vers\u00e3o do samba: smbclient --version Testar o samba com o comando: smbclient -L localhost -U% Verificar o DNS (_ldap): host -t SRV _ldap._tcp.seu.dominio Verificar _kerberos : host -t SRV _kerberos._udp.seu.dominio. A Grava\u00e7\u00e3o A host -t A seu.dominio Verificando o Kerberos kinit Administrator Password for Administrator@SEU.DOMINIO: Warning: Your password will expire in 41 days on Tue 22 Sep 2020 03:41:22 PM IST Listar o cache dos tickets klist Com a resposta parecida com essa: Valid starting Expires Service principal 13/04/2023 13:54:57 13/04/2023 23:54:57 krbtgt/SEU.DOMINIO@SEU.DOMINIO renew until 14/04/2023 13:54:50","title":"Criar um arquivo de servi\u00e7o systemd."},{"location":"DC1_Rocky/#configurar-o-firewall","text":"Adicionar servi\u00e7os: firewall-cmd --add-service={dns,ldap,ldaps,kerberos} Adicionar portas: firewall-cmd --add-port={389/udp,135/tcp,135/udp,138/udp,138/tcp,137/tcp,137/udp,139/udp,139/tcp,445/tcp,445/udp,3268/udp,3268/tcp,3269/tcp,3269/udp,49152/tcp} Recarregar o Firewall: firewall-cmd --reload","title":"Configurar o Firewall"},{"location":"DC1_Rocky/#para-criar-um-segundo-dc-clique-aqui","text":"","title":"Para Criar um Segundo DC, clique aqui"},{"location":"DC1_Rocky/#replicacao-do-sysvol-backup-do-ad-para-um-dc2","text":"Gerar uma chave SSH-Keygen no DC1 com o comando: ssh-keygen -t rsa Algumas perguntas ser\u00e3o feitas: Onde salvar o arquvo de chave, que neste caso: (/root/.ssh/id_rsa) teclar enter Entre com uma senha (ou apenas digite enter para ficar sem senha), teclar enter Entre com a senha novamente: teclar enter A sa\u00edda ser\u00e1 algo como: Your identification has been saved in /root/.ssh/id_rsa. Your public key has been saved in /root/.ssh/id_rsa.pub. Quando a chave for criada, copiar para o servidor que ser\u00e1 o segundo DC2 com o comando: ssh-copy-id user-dc2@IP-Seu-DC2 Agora pode-se conectar com ssh sem requerer senha de acesso. Conecte-se via ssh em seu DC2 e mude as permiss\u00f5es de acesso para que o usu\u00e1rio do dc2 possa escrever no diret\u00f3rio com o comando: chown root.user-dc2 -R /usr/local/samba/var/locks/sysvol/ Fazendo o backup do DC1 para o DC2. Para um teste antes, fazer o comando usando a op\u00e7\u00e3o --dry-run para apenas um teste sem altera\u00e7\u00e3o. rsync --dry-run -XAavz --delete-after --progress --stats /usr/local/samba/var/locks/sysvol/ user-dc2@IP-DC2:/usr/local/samba/var/locks/sysvol/ O comando rsync far\u00e1 uma copia do sysvol de seu DC1 ( parte1 ) para o sysvol de seu DC2 ( parte2 ): Parte 1: rsync --dry-run -XAavz --delete-after --progress --stats /usr/local/samba/var/locks/sysvol/ Parte 2: user-dc2@ IP-DC2:/usr/local/samba/var/locks/sysvol/ O resultado deve ser algo parecido com: building file list ... 12 files to consider ./ seu.dominio/ seu.dominio/Policies/ seu.dominio/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/ seu.dominio/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/GPT.INI seu.dominio/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/MACHINE/ seu.dominio/Policies/{31B2F340-016D-11D2-945F-00C04FB984F9}/USER/ seu.dominio/Policies/{6AC1786C-016F-11D2-945F-00C04FB984F9}/ seu.dominio/Policies/{6AC1786C-016F-11D2-945F-00C04FB984F9}/GPT.INI seu.dominio/Policies/{6AC1786C-016F-11D2-945F-00C04FB984F9}/MACHINE/ seu.dominio/Policies/{6AC1786C-016F-11D2-945F-00C04FB984F9}/USER/ seu.dominio/scripts/ Number of files: 12 (reg: 2, dir: 10) Number of created files: 9 (reg: 2, dir: 7) Number of deleted files: 0 Number of regular files transferred: 2 Total file size: 40 bytes Total transferred file size: 40 bytes Literal data: 0 bytes Matched data: 0 bytes File list size: 0 File list generation time: 0.038 seconds File list transfer time: 0.000 seconds Total bytes sent: 2,011 Total bytes received: 51 sent 2,011 bytes received 51 bytes 1,374.67 bytes/sec total size is 40 speedup is 0.02 **(DRY RUN)** Com o resultado positivo, pode-se rodar o comando sem a op\u00e7\u00e3o --dry-run : rsync -XAavz --delete-after --progress --stats /usr/local/samba/var/locks/sysvol/ dc2@IP-DC2:/usr/local/samba/var/locks/sysvol/ Para automatizar o processo, inserir o comando no crontab . Para aprender mais sobre o crontab clique aqui Adicionar um script no crontab com o comando: crontab -e E insira a linha: 0 12 * * 1-5 root rsync -XAavz --delete-after --progress --stats /usr/local/samba/var/locks/sysvol/ srvad2@10.1.1.38:/usr/local/samba/var/locks/sysvol/ THAT\u2019S ALL FOLKS!!","title":"Replica\u00e7\u00e3o do SysVol (backup do AD) para um DC2"},{"location":"DC1_pacotes_binarios/","text":"\ud83d\udcc1 DC01 instala\u00e7\u00e3o por pacotes bin\u00e1rios Atualizando o Sistema operacional: sudo apt update && sudo apt full-upgrade Setando as Configura\u00e7\u00f5es e rede: vim /etc/network/interfaces iface enp7s0 inet static address 192.168.70.250 netmask 255.255.255.0 gateway 192.168.70.254 Setando as Configura\u00e7\u00f5es de DNS: vim /etc/resolv.conf nameserver 192.168.70.254 Setando as Configura\u00e7\u00f5es de hosts: hostnamectl set-hostname dc01 vim /etc/hosts 127.0.0.1 localhost 127.0.1.1 dc01.esharknet.edu dc01 192.168.70.250 dc01.esharknet.edu dc01 Instala\u00e7\u00e3o dos pacotes necess\u00e1rios: apt install samba samba-client krb5-user dns-utils # validar krb5-config winbind acl attr Durante a configura\u00e7\u00e3o do krb5-user, voc\u00ea ser\u00e1 solicitado a inserir as informa\u00e7\u00f5es: - Default Kerberos version 5 realm: ESHARKNET.EDU - KDCs for your realm: dc01 - Administrative server for your Kerberos realm: dc01 SE vc errar nessa parte, pode rodar o reconfigure para o Kerberos, depois: dpkg-reconfigure krb5.conf Siga as instru\u00e7\u00f5es interativas para configurar o dom\u00ednio ESHARKNET.edu. SE precisar siga o modelo abaixo: [libdefaults] default_realm = ESHARKNET.EDU dns_lookup_realm = false dns_lookup_kdc = true # The following krb5.conf variables are only for MIT Kerberos. kdc_timesync = 1 ccache_type = 4 forwardable = true proxiable = true rdns = false # The following libdefaults parameters are only for Heimdal Kerberos. fcc-mit-ticketflags = true [realms] officinas.edu = { kdc = dc01.esharknet.edu admin_server = dc01.esharknet.edu default_domain = esharknet.edu } [domain_realm] .esharknet.edu = ESHARKNET.EDU esharknet.edu = ESHARKNET.EDU Valide o arquivo do nsswitch.conf: vim /etc/nsswitch.conf passwd: files systemd winbind group: files systemd winbind Parando os servi\u00e7os smbd , nmbd , winbind , ANTES de provisionar o dom\u00ednio: systemctl stop smbd nmbd winbind systemctl disable smbd nmbd winbind Efetivando o provisionamento do dom\u00ednio: mv /etc/samba/smb.conf{,.orig} samba-tool domain provision --use-rfc2307 --interactive Realm [ESHARKNET.EDU]: (nome de seu dom\u00ednio completo). dcmaster [esharknet]: (nome de seu dom\u00ednio abreviado). Server Role (dc, member, standalone) [dc]: (tipo de servidor controlador de dom\u00ednio). DNS backend (SAMBA_INTERNAL, BIND9_FLATFILE, BIND9_DLZ, NONE) [SAMBA_INTERNAL]: (tipo de servi\u00e7o DNS). DNS forwarder IP address (write \u2018none\u2019 to disable forwarding) [192.168.0.1]: (Encaminhador DNS) Validando as portas em escuta: netstat -pultan Ativando os servi\u00e7os do samba-ad-dc systemctl unmask samba-ad-dc.service systemctl enable samba-ad-dc.service systemctl start samba-ad-dc.service Reapontando o Servidor de DNS para o pr\u00f3prio DC01: vim /etc/resolv.conf nameserver 127.0.0.1 Travando o arquivo contra altera\u00e7\u00f5es autom\u00e1ticas: chattr +i /etc/resolv.conf Configura\u00e7\u00e3o do arquivo smb.conf : vim /etc/samba/smb.conf Adicione ou modifique as seguintes se\u00e7\u00f5es: -[global] -workgroup = ESHARKNET -realm = ESHARKNET.EDU -netbios name = dc01 -server role = active directory domain controller -idmap_ldb:use rfc2307 = yes -dns forwarder = 192.168.70.254 -vfs objects = dfs_samba4 acl_xattr recycle -vfs objects = dfs_samba4 acl_xattr audit -recycle:repository = .recycle -recycle:keeptree = yes -recycle:versions = yes -recycle:touch = no -recycle:directory_mode = 0777 -recycle:subdir_mode = 0700 -recycle:exclude = *.tmp,*.temp,*.o,*.obj -recycle:exclude_dir = /tmp,/temp,/cache -template homedir = /home/%U -log file = /var/log/samba/%m.log -log level = 3 -[sysvol] -path = /var/lib/samba/sysvol -read only = No -browseable = No -[netlogon] -path = /var/lib/samba/sysvol/ESHARKNET.edu/scripts -read only = No -browseable = No -[ARQUIVOS] -path = /srv/samba/arquivos -comment = Compartilhamentos da Rede -browsable = yes -writable = yes -read only = no Criando o diret\u00f3rio compartilhado: mkdir -p /srv/samba/arquivos Setando as permiss\u00f5es de acesso: chmod -R 0770 /srv/samba/arquivos chown -R root:\"Domain Users\" /srv/samba/arquivos Revisando usu\u00e1rios e grupos: cat /etc/passwd # ( usu\u00e1rios locais do Linux gerencia do LDAP ) samba-tool user list # ( usu\u00e1rios de rede gerenciados pelo SAMBA4 ) Outras valida\u00e7\u00f5es no dom\u00ednio: wbinfo -u wbinfo -g wbinfo --ping-dc wbinfo --all-domains getent group \u201cDomain Admins\u201d Verificando servi\u00e7o ativo: ps aux | grep samba ps ax | egrep \"samba|smbd|nmbd|winbindd\" ps axf Consultando o Servidor: testparm smbclient --version smbclient -L localhost -U% smbclient -L -U Administrator Enter Administrator's password: Password for [Administrator@ESHARKNET.EDU]: Sharename Type Comment --------- ---- ------- sysvol Disk netlogon Disk IPC$ IPC IPC Service (Samba 4.21.4-Debian-4.21.4+dfsg-1) SMB1 disabled -- no workgroup available samba-tool domain level show dcmaster and forest function level for dcmaster 'DC=officinas,DC=edu' Forest function level: (Windows) 2008 R2 dcmaster function level: (Windows) 2008 R2 Lowest function level of a DC: (Windows) 2008 R2 Desabilitando a complexidade de senhas (INSEGURO!): samba-tool domain passwordsettings show samba-tool domain passwordsettings set --complexity=off samba-tool domain passwordsettings set --history-length=0 samba-tool domain passwordsettings set --min-pwd-length=0 samba-tool domain passwordsettings set --min-pwd-age=0 samba-tool user setexpiry Administrator --noexpiry Relendo as configura\u00e7\u00f5es do Samba4: smbcontrol all reload-config Validando a troca de tickets do Kerberos: kinit Administrator@ESHARKNET.EDU klist Consultando servi\u00e7os do kerberos e do ldap : host -t A esharknet.edu host -t Using dcmaster server: Name: officinas.edu Address: 192.168.0.1#53 Aliases: A has no SRV record host -t srv _kerberos._tcp.ESHARKNET.edu _ldap._tcp.officinas.edu has SRV record 0 100 389 dcmaster.officinas.edu. host -t srv _ldap._tcp.ESHARKNET.edu _kerberos._udp.officinas.edu has SRV record 0 100 88 dcmaster.officinas.edu. dig ESHARKNET.edu Agora \u00e9 s\u00f3 instalar as ferramentas do rsat em uma m\u00e1quina Windows e gerenciar o Servidor! THAT\u2019S ALL FOLKS!!","title":"\ud83d\udcc1 DC01 instala\u00e7\u00e3o por pacotes bin\u00e1rios"},{"location":"DC1_pacotes_binarios/#dc01-instalacao-por-pacotes-binarios","text":"","title":"\ud83d\udcc1 DC01 instala\u00e7\u00e3o por pacotes bin\u00e1rios"},{"location":"DC1_pacotes_binarios/#atualizando-o-sistema-operacional","text":"sudo apt update && sudo apt full-upgrade","title":"Atualizando o Sistema operacional:"},{"location":"DC1_pacotes_binarios/#setando-as-configuracoes-e-rede","text":"vim /etc/network/interfaces iface enp7s0 inet static address 192.168.70.250 netmask 255.255.255.0 gateway 192.168.70.254","title":"Setando as Configura\u00e7\u00f5es e rede:"},{"location":"DC1_pacotes_binarios/#setando-as-configuracoes-de-dns","text":"vim /etc/resolv.conf nameserver 192.168.70.254","title":"Setando as Configura\u00e7\u00f5es de DNS:"},{"location":"DC1_pacotes_binarios/#setando-as-configuracoes-de-hosts","text":"hostnamectl set-hostname dc01 vim /etc/hosts 127.0.0.1 localhost 127.0.1.1 dc01.esharknet.edu dc01 192.168.70.250 dc01.esharknet.edu dc01","title":"Setando as Configura\u00e7\u00f5es de hosts:"},{"location":"DC1_pacotes_binarios/#instalacao-dos-pacotes-necessarios","text":"apt install samba samba-client krb5-user dns-utils # validar krb5-config winbind acl attr Durante a configura\u00e7\u00e3o do krb5-user, voc\u00ea ser\u00e1 solicitado a inserir as informa\u00e7\u00f5es: - Default Kerberos version 5 realm: ESHARKNET.EDU - KDCs for your realm: dc01 - Administrative server for your Kerberos realm: dc01 SE vc errar nessa parte, pode rodar o reconfigure para o Kerberos, depois: dpkg-reconfigure krb5.conf Siga as instru\u00e7\u00f5es interativas para configurar o dom\u00ednio ESHARKNET.edu. SE precisar siga o modelo abaixo: [libdefaults] default_realm = ESHARKNET.EDU dns_lookup_realm = false dns_lookup_kdc = true # The following krb5.conf variables are only for MIT Kerberos. kdc_timesync = 1 ccache_type = 4 forwardable = true proxiable = true rdns = false # The following libdefaults parameters are only for Heimdal Kerberos. fcc-mit-ticketflags = true [realms] officinas.edu = { kdc = dc01.esharknet.edu admin_server = dc01.esharknet.edu default_domain = esharknet.edu } [domain_realm] .esharknet.edu = ESHARKNET.EDU esharknet.edu = ESHARKNET.EDU","title":"Instala\u00e7\u00e3o dos pacotes necess\u00e1rios:"},{"location":"DC1_pacotes_binarios/#valide-o-arquivo-do-nsswitchconf","text":"vim /etc/nsswitch.conf passwd: files systemd winbind group: files systemd winbind","title":"Valide o arquivo do nsswitch.conf:"},{"location":"DC1_pacotes_binarios/#parando-os-servicos-smbd-nmbd-winbind-antes-de-provisionar-o-dominio","text":"systemctl stop smbd nmbd winbind systemctl disable smbd nmbd winbind","title":"Parando os servi\u00e7os smbd, nmbd, winbind, ANTES de provisionar o dom\u00ednio:"},{"location":"DC1_pacotes_binarios/#efetivando-o-provisionamento-do-dominio","text":"mv /etc/samba/smb.conf{,.orig} samba-tool domain provision --use-rfc2307 --interactive Realm [ESHARKNET.EDU]: (nome de seu dom\u00ednio completo). dcmaster [esharknet]: (nome de seu dom\u00ednio abreviado). Server Role (dc, member, standalone) [dc]: (tipo de servidor controlador de dom\u00ednio). DNS backend (SAMBA_INTERNAL, BIND9_FLATFILE, BIND9_DLZ, NONE) [SAMBA_INTERNAL]: (tipo de servi\u00e7o DNS). DNS forwarder IP address (write \u2018none\u2019 to disable forwarding) [192.168.0.1]: (Encaminhador DNS)","title":"Efetivando o provisionamento do dom\u00ednio:"},{"location":"DC1_pacotes_binarios/#validando-as-portas-em-escuta","text":"netstat -pultan","title":"Validando as portas em escuta:"},{"location":"DC1_pacotes_binarios/#ativando-os-servicos-do-samba-ad-dc","text":"systemctl unmask samba-ad-dc.service systemctl enable samba-ad-dc.service systemctl start samba-ad-dc.service","title":"Ativando os servi\u00e7os do samba-ad-dc"},{"location":"DC1_pacotes_binarios/#reapontando-o-servidor-de-dns-para-o-proprio-dc01","text":"vim /etc/resolv.conf nameserver 127.0.0.1","title":"Reapontando o Servidor de DNS para o pr\u00f3prio DC01:"},{"location":"DC1_pacotes_binarios/#travando-o-arquivo-contra-alteracoes-automaticas","text":"chattr +i /etc/resolv.conf","title":"Travando o arquivo contra altera\u00e7\u00f5es autom\u00e1ticas:"},{"location":"DC1_pacotes_binarios/#configuracao-do-arquivo-smbconf","text":"vim /etc/samba/smb.conf Adicione ou modifique as seguintes se\u00e7\u00f5es: -[global] -workgroup = ESHARKNET -realm = ESHARKNET.EDU -netbios name = dc01 -server role = active directory domain controller -idmap_ldb:use rfc2307 = yes -dns forwarder = 192.168.70.254 -vfs objects = dfs_samba4 acl_xattr recycle -vfs objects = dfs_samba4 acl_xattr audit -recycle:repository = .recycle -recycle:keeptree = yes -recycle:versions = yes -recycle:touch = no -recycle:directory_mode = 0777 -recycle:subdir_mode = 0700 -recycle:exclude = *.tmp,*.temp,*.o,*.obj -recycle:exclude_dir = /tmp,/temp,/cache -template homedir = /home/%U -log file = /var/log/samba/%m.log -log level = 3 -[sysvol] -path = /var/lib/samba/sysvol -read only = No -browseable = No -[netlogon] -path = /var/lib/samba/sysvol/ESHARKNET.edu/scripts -read only = No -browseable = No -[ARQUIVOS] -path = /srv/samba/arquivos -comment = Compartilhamentos da Rede -browsable = yes -writable = yes -read only = no","title":"Configura\u00e7\u00e3o do arquivo smb.conf:"},{"location":"DC1_pacotes_binarios/#criando-o-diretorio-compartilhado","text":"mkdir -p /srv/samba/arquivos","title":"Criando o diret\u00f3rio compartilhado:"},{"location":"DC1_pacotes_binarios/#setando-as-permissoes-de-acesso","text":"chmod -R 0770 /srv/samba/arquivos chown -R root:\"Domain Users\" /srv/samba/arquivos","title":"Setando as permiss\u00f5es de acesso:"},{"location":"DC1_pacotes_binarios/#revisando-usuarios-e-grupos","text":"cat /etc/passwd # ( usu\u00e1rios locais do Linux gerencia do LDAP ) samba-tool user list # ( usu\u00e1rios de rede gerenciados pelo SAMBA4 )","title":"Revisando usu\u00e1rios e grupos:"},{"location":"DC1_pacotes_binarios/#outras-validacoes-no-dominio","text":"wbinfo -u wbinfo -g wbinfo --ping-dc wbinfo --all-domains getent group \u201cDomain Admins\u201d","title":"Outras valida\u00e7\u00f5es no dom\u00ednio:"},{"location":"DC1_pacotes_binarios/#verificando-servico-ativo","text":"ps aux | grep samba ps ax | egrep \"samba|smbd|nmbd|winbindd\" ps axf","title":"Verificando servi\u00e7o ativo:"},{"location":"DC1_pacotes_binarios/#consultando-o-servidor","text":"testparm smbclient --version smbclient -L localhost -U% smbclient -L -U Administrator Enter Administrator's password: Password for [Administrator@ESHARKNET.EDU]: Sharename Type Comment --------- ---- ------- sysvol Disk netlogon Disk IPC$ IPC IPC Service (Samba 4.21.4-Debian-4.21.4+dfsg-1) SMB1 disabled -- no workgroup available samba-tool domain level show dcmaster and forest function level for dcmaster 'DC=officinas,DC=edu' Forest function level: (Windows) 2008 R2 dcmaster function level: (Windows) 2008 R2 Lowest function level of a DC: (Windows) 2008 R2","title":"Consultando o Servidor:"},{"location":"DC1_pacotes_binarios/#desabilitando-a-complexidade-de-senhas-inseguro","text":"samba-tool domain passwordsettings show samba-tool domain passwordsettings set --complexity=off samba-tool domain passwordsettings set --history-length=0 samba-tool domain passwordsettings set --min-pwd-length=0 samba-tool domain passwordsettings set --min-pwd-age=0 samba-tool user setexpiry Administrator --noexpiry","title":"Desabilitando a complexidade de senhas (INSEGURO!):"},{"location":"DC1_pacotes_binarios/#relendo-as-configuracoes-do-samba4","text":"smbcontrol all reload-config","title":"Relendo as configura\u00e7\u00f5es do Samba4:"},{"location":"DC1_pacotes_binarios/#validando-a-troca-de-tickets-do-kerberos","text":"kinit Administrator@ESHARKNET.EDU klist","title":"Validando a troca de tickets do Kerberos:"},{"location":"DC1_pacotes_binarios/#consultando-servicos-do-kerberos-e-do-ldap","text":"host -t A esharknet.edu host -t Using dcmaster server: Name: officinas.edu Address: 192.168.0.1#53 Aliases: A has no SRV record host -t srv _kerberos._tcp.ESHARKNET.edu _ldap._tcp.officinas.edu has SRV record 0 100 389 dcmaster.officinas.edu. host -t srv _ldap._tcp.ESHARKNET.edu _kerberos._udp.officinas.edu has SRV record 0 100 88 dcmaster.officinas.edu. dig ESHARKNET.edu","title":"Consultando servi\u00e7os do kerberos e do ldap:"},{"location":"DC1_pacotes_binarios/#agora-e-so-instalar-as-ferramentas-do-rsat-em-uma-maquina-windows-e-gerenciar-o-servidor","text":"THAT\u2019S ALL FOLKS!!","title":"Agora \u00e9 s\u00f3 instalar as ferramentas do rsat em uma m\u00e1quina Windows e gerenciar o Servidor!"},{"location":"DC1_pacotes_compilados/","text":"\ud83d\udcc1 DC1 instala\u00e7\u00e3o por pacotes compilados Controlador de Dom\u00ednio Prim\u00e1rio, Secund\u00e1rio e Fileserver no Debian Linux 12 Layout de rede usado no laborat\u00f3rio: firewall 192.168.70.254 (enp1s0) - 192.168.122.254 (enp7s0) (ssh 2277) dcmaster 192.168.70.250 (ssh 22250) mkdocs 192.168.70.222 (ssh 22222) dcslave 192.168.70.200 (ssh 22200) fileserver 192.168.70.150 (ssh 22100) ; firewall Roteamento por Iptables ; dcmaster Controlador de Dom\u00ednio prim\u00e1rio ; mkdocs Servidor de Documentos ; dcslave Controlador de Dom\u00ednio secund\u00e1rio ; fileserver Servidor de Arquivos Instalando as depend\u00eancias para compila\u00e7\u00e3o do c\u00f3digo fonte do Samba4: export DEBIAN_FRONTEND=noninteractive;apt-get update; apt-get install vim net-tools rsync acl apt-utils attr autoconf bind9-utils binutils bison build-essential ccache chrpath curl debhelper bind9-dnsutils docbook-xml docbook-xsl flex gcc gdb git glusterfs-common gzip heimdal-multidev hostname htop krb5-config krb5-user lcov libacl1-dev libarchive-dev libattr1-dev libavahi-common-dev libblkid-dev libbsd-dev libcap-dev libcephfs-dev libcups2-dev libdbus-1-dev libglib2.0-dev libgnutls28-dev libgpgme-dev libicu-dev libjansson-dev libjs-jquery libjson-perl libkrb5-dev libldap2-dev liblmdb-dev libncurses-dev libpam0g-dev libparse-yapp-perl libpcap-dev libpopt-dev libreadline-dev libsystemd-dev libtasn1-bin libtasn1-6-dev libunwind-dev lmdb-utils locales lsb-release make mawk mingw-w64 patch perl perl-modules-5.40 pkg-config procps psmisc python3 python3-cryptography python3-dbg python3-dev python3-dnspython python3-gpg python3-iso8601 python3-markdown python3-matplotlib python3-pexpect python3-pyasn1 rsync sed tar tree uuid-dev wget xfslibs-dev xsltproc zlib1g-dev -y Setando e validando o hostname do dcmaster: hostnamectl set-hostname dcmaster Configurando o arquivo de hosts: vim /etc/hosts .0.0.1 localhost 127.0.1.1 dcmaster.officinas.edu dcmaster 192.168.70.254 dcmaster.officinas.edu dcmaster hostname -f Setando ip fixo no servidor dcmaster: vim /etc/network/interfaces iface enp1s0 inet static address 192.168.70.250 netmask 255.255.255.0 gateway 192.168.70.254 dns-nameserver 192.168.70.254 #(firewall) dns-search officinas.edu Setando endere\u00e7o do firewall como resolvedor externo (tempor\u00e1rio at\u00e9 provisionar o dom\u00ednio): vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.254 #(firewall) Validando o ip da placa: ip -c addr ip -br link Baixando e compilando o c\u00f3digo fonte do Samba4: wget https://download.samba.org/pub/samba/samba-4.22.1.tar.gz tar -xvzf samba-4.22.1.tar.gz cd samba-4.22.1 ./configure --prefix=/opt/samba make make install Adicionando /opt/Samba ao path padr\u00e3o do Linux, colando a linha completa ao final do .bashrc: PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\" vim ~/.bashrc PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\" Relendo o arquivo de profile: source ~/.bashrc Criando o daemon de inicializa\u00e7\u00e3o do Samba4 com o sistema: vim /etc/systemd/system/samba-ad-dc.service [Unit] Description=Samba4 Active Directory Master Domain Controller After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/samba -D PIDFile=/opt/samba/var/run/samba.pid [Install] WantedBy=multi-user.target chmod +x /etc/systemd/system/samba-ad-dc.service Instalando e editando o servi\u00e7o de sincroniza\u00e7\u00e3o de hor\u00e1rio: cp /etc/ntpsec/ntp.conf{,.orig} vim /etc/ntpsec/ntp.conf driftfile /var/lib/ntpsec/ntp.drift leapfile /usr/share/zoneinfo/leap-seconds.list pool a.ntp.org iburst pool b.ntp.org iburst pool 2.debian.pool.ntp.org iburst pool 3.debian.pool.ntp.org iburst restrict 127.0.0.1 restrict ::1 tinker panic 0 #(Flag usada SOMENTE em VMs) systemctl restart ntpd ntpq -p Provisionando o novo dom\u00ednio suportado pelo dcmaster: samba-tool domain provision --use-rfc2307 --interactive --option=\u201dinterfaces=lo enp1s0\u201d --option=\u201dbind interfaces only=yes\u201d Habilitando o daemon pra subir no boot do sistema: systemctl daemon-reload systemctl enable samba-ad-dc.service systemctl start samba-ad-dc.service systemctl status samba-ad-dc.service Linkando o arquivo krb5.conf do Samba4 ao /etc do sistema: mv /etc/krb5.conf{,.orig} ln -sf /opt/samba/private/krb5.conf /etc/krb5.conf AP\u00d3S o provisionamento da Samba4, precisamos reconfigurar o /etc/resolv.conf e setar o DNS apontando a resolu\u00e7\u00e3o de nomes para o pr\u00f3prio dcmaster: vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 127.0.0.1 #(localhost) Bloqueando altera\u00e7\u00e3o do resolv.conf: chattr +i /etc/resolv.conf Validando resolvedor de nomes pelo dcmaster: nslookup dcmaster.officinas.edu Vai validar na tela: Server: 127.0.0.1 Address: 127.0.0.1#53 Name: dcmaster.officinas.edu Address: 192.168.70.250 Reboot do servidor dcmaster: reboot Validando os servi\u00e7os do Samba4 no boot do sistema: ps aux | grep samba ps aux | egrep \"samba|smbd|nmbd|winbind\" find / -name samba.pid pgrep samba Dando poderes de root ao Administrator: vim /opt/samba/etc/user.map !root=officinas.edu\\Administrator Linkando bibliotecas do Samba4 para mapeamento de usu\u00e1rios no sistema Linux (rode esses comandos manualmente sem copiar e colar): /opt/samba/sbin/smbd -b | grep LIBDIR ln -s /opt/samba/lib/libnss_winbind.so.2 /lib/x86-64-linux-gnu ln -s /lib/x86_64-linux-gnu/libnss_winbind.so.2 /lib/x86_64-linux-gnu/libnss_winbind.so ldconfig Validando a autentica\u00e7\u00e3o de usu\u00e1rios de rede no sistema Linux mas tb\u00e9m no winbind: vim /etc/nsswitch.conf passwd: files systemd winbind group: files systemd winbind shadow: files Editando o arquivo smb.conf e adicionando no dns forwarder, quem resolve nomes para consultas externas (o firewall e o google): cp /opt/samba/etc/smb.conf{,.orig} vim /opt/samba/etc/smb.conf [global] bind interfaces only = Yes dns forwarder = 192.168.70.254 8.8.8.8 #(firewall + google) interfaces = lo enp1s0 netbios name = DCMASTER realm = OFFICINAS.EDU server role = active directory domain controller workgroup = OFFICINAS idmap_ldb:use rfc2307 = yes [sysvol] path = /opt/samba/var/locks/sysvol read only = No [netlogon] path = /opt/samba/var/locks/sysvol/officinas.edu/scripts read only = No Relendo a configura\u00e7\u00e3o do Samba4: smbcontrol all reload-config Validando usu\u00e1rios da base do ldap local: cat /etc/passwd | grep root Validando usu\u00e1rios de rede do Samba4 (Intermediados pelo winbind): samba-tool user show administrator getent passwd administrator wbinfo -u wbinfo -g wbinfo --ping-dc getent group \"Domain Admins\" Validando daemons ativos: ps aux | egrep \"samba|smbd|nmbd|winbind\" ps axf Consultando servi\u00e7os do SAMBA4: smbclient --version smbclient -L dc01 -U Administrator smbclient //localhost/netlogon -UAdministrator -c \"ls\" testparm samba-tool domain level show Desabilitando complexidade de senhas (inseguro): samba-tool domain passwordsettings show samba-tool domain passwordsettings set --complexity=off samba-tool domain passwordsettings set --history-length=0 samba-tool domain passwordsettings set --min-pwd-length=0 samba-tool domain passwordsettings set --min-pwd-age=0 samba-tool user setexpiry Administrator --noexpiry Relendo as configura\u00e7\u00f5es do SAMBA4: smbcontrol all reload-config Validando a troca de tickets do Kerberos: kinit Administrator@OFFICINAS.EDU klist Consultando as bases do kerberos, ldap e dns: host -t srv _kerberos._tcp.officinas.edu host -t srv _ldap._tcp.officinas.edu host -t A dcmaster.officinas.edu. dig officinas.edu THAT\u2019S ALL FOLKS!! Controlador de Dom\u00ednio secund\u00e1rio com Samba4 no Debian 12 Layout de rede usado no laborat\u00f3rio: firewall 192.168.70.254 (enp1s0) - 192.168.122.254 (enp7s0) (ssh 2277) dcmaster 192.168.70.250 (ssh 22250) mkdocs 192.168.70.222 (ssh 22222) dcslave 192.168.70.200 (ssh 22200) fileserver 192.168.70.150 (ssh 22100) ; firewall Roteamento por Iptables ; dcmaster Controlador de Dom\u00ednio prim\u00e1rio ; mkdocs Servidor de Documentos ; dcslave Controlador de Dom\u00ednio secund\u00e1rio ; fileserver Servidor de Arquivos Instalando as depend\u00eancias para compila\u00e7\u00e3o do c\u00f3digo fonte do Samba4: export DEBIAN_FRONTEND=noninteractive;apt-get update; apt-get install vim net-tools rsync acl apt-utils attr autoconf bind9-utils binutils bison build-essential ntp rsync ccache chrpath curl debhelper bind9-dnsutils docbook-xml docbook-xsl flex gcc gdb git glusterfs-common gzip heimdal-multidev hostname htop krb5-config krb5-user lcov libacl1-dev libarchive-dev libattr1-dev libavahi-common-dev libblkid-dev libbsd-dev libcap-dev libcephfs-dev libcups2-dev libdbus-1-dev libglib2.0-dev libgnutls28-dev libgpgme-dev libicu-dev libjansson-dev libjs-jquery libjson-perl libkrb5-dev libldap2-dev liblmdb-dev libncurses-dev libpam0g-dev libparse-yapp-perl libpcap-dev libpopt-dev libreadline-dev libsystemd-dev libtasn1-bin libtasn1--5-dev libunwind-dev lmdb-utils locales lsb-release make mawk mingw-w64 patch perl perl-modules-5.40 pkg-config procps psmisc python3 python3-cryptography python3-dbg python3-dev python3-dnspython python3-gpg python3-iso8601 python3-markdown python3-matplotlib python3-pexpect python3-pyasn1 rsync sed tar tree uuid-dev wget xfslibs-dev xsltproc zlib1g-dev -y Setando e validando o hostname do dcslave: vim /etc/hostname dcslave hostname -f dcslave.officinas.edu Configurando o arquivo de hosts: vim /etc/hosts .0.0.1 localhost 127.0.1.1 dcslave.officinas.edu dcslave 192.168.70.150 fileserver.officinas.edu fileserver 192.168.70.200 dcslave.officinas.edu dcslave 192.168.70.222 mkdocs.officinas.edu mkdocs 192.168.70.250 dcmaster.officinas.edu dcmaster 192.168.70.254 firewall.officinas.edu firewall Setando ip fixo no servidor dcslave: vim /etc/network/interfaces allow-hotplug enp1s0 iface enp1s0 inet static address 192.168.70.200 netmask 255.255.255.0 gateway 192.168.70.254 Apontando o endere\u00e7o do resolvedor de nomes principal da rede pro Controlador de dom\u00ednio prim\u00e1rio, dcmaster (tempor\u00e1rio, at\u00e9 provisionar): vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.250 #(dcmaster) nameserver 127.0.0.1 Validando a resolu\u00e7\u00e3o de nomes pelo dcmaster: nslookup officinas.edu Server: 192.168.70.250 Address: 192.168.70.250#53 Name: officinas.edu Address: 192.168.70.250 Name: officinas.edu Address: 192.168.70.200 Relendo as configura\u00e7\u00f5es de rede: systemctl restart networking Validando o ip da placa: ip -c addr ip -br link Baixando e compilando o c\u00f3digo fonte do Samba4: wget https://download.samba.org/pub/samba/samba-4.19.4.tar.gz tar -xvzf samba-4.19.4.tar.gz cd samba-4.19.4 ./configure --prefix=/opt/samba make && make install Adicionando /opt/Samba ao path padr\u00e3o do Linux, colando a linha completa ao final do .bashrc: PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\" vim ~/.bashrc PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\" Relendo o arquivo de profile: source ~/.bashrc Criando o daemon de inicializa\u00e7\u00e3o do Samba4 com o sistema: vim /etc/systemd/system/samba-ad-dc.service [Unit] Description=Samba4 Active Directory Slave Domain Controller After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/samba -D PIDFile=/opt/samba/var/run/samba.pid [Install] WantedBy=multi-user.target chmod +x /etc/systemd/system/samba-ad-dc.service Configurando o servi\u00e7o de sincroniza\u00e7\u00e3o de hor\u00e1rio, apontando pro Controlador de dom\u00ednio prim\u00e1rio, dcmaster: mv /etc/ntpsec/ntp.conf{,.orig} vim /etc/ntpsec/ntp.conf driftfile /var/lib/ntpsec/ntp.drift leapfile /usr/share/zoneinfo/leap-seconds.list tos minclock 4 minsane 3 pool 192.168.70.250 iburst #(dcmaster) restrict default kod nomodify nopeer noquery limited restrict 127.0.0.1 restrict ::1 tinker panic 0 #(Flag usada SOMENTE em VMs) systemctl restart ntp ntpq -p date As m\u00e1quinas Windows/Linux, membros do dom\u00ednio, usar\u00e3o o DC1 que ret\u00e9m a fun\u00e7\u00e3o FSMO emulador PDC como fonte de tempo padr\u00e3o! Provisionando o servidor DCSLAVE: samba-tool domain join OFFICINAS.EDU DC -U Administrator --realm=OFFICINAS.EDU --dns-backend=SAMBA_INTERNAL --option=\"interfaces=lo enp1s0\" --option=\"bind interfaces only=yes\" --option=\"idmap_ldb:use-rfc2307=yes\" Habilitando o daemon pra subir no boot do sistema: systemctl daemon reload systemctl enable samba-ad-dc.service systemctl start samba-ad-dc.service systemctl status samba-ad-dc.service Editando o arquivo do kerberos: mv /etc/krb5.conf{,.orig} vim /etc/krb5.conf [libdefaults] #(sem espa\u00e7o no canto dessa linha) dns_lookup_realm = false dns_lookup_kdc = true default_realm = OFFICINAS.EDU Visualizando o arquivo smb.conf: cat /opt/samba/etc/smb.conf # Global parameters [global] bind interfaces only = Yes interfaces = lo enp1s0 netbios name = DCSLAVE realm = OFFICINAS.EDU server role = active directory domain controller workgroup = OFFICINAS idmap_ldb:use-rfc2307 = yes [sysvol] path = /opt/samba/var/locks/sysvol read only = No [netlogon] path = /opt/samba/var/locks/sysvol/officinas.edu/scripts read only = No Validando as entradas DNS usadas: apt install ldb-tools host -t A officinas.edu. (SE NECESS\u00c1RIO), SE Necess\u00e1rio, adicione as entradas do dcslave, manualmente AO DNS do Samba4, no dcmaster: samba-tool dns add dcmaster OFFICINAS.EDU dcslave A 192.168.70.200 -U administrator ldbsearch -H /opt/samba/private/sam.ldb '(invocationId=*)' --cross-ncs objectguid host -t CNAME df4bdd8c-abc7-4779-b01e-4dd4553ca3e9._msdcs.officinas.edu. SE n\u00e3o rodar, execute a replica\u00e7\u00e3o para todos os DCs: samba-tool dns add dcmaster _msdcs.officinas.edu df4bdd8c-abc7-4779-b01e-4dd4553ca3e9 CNAME dcslave.officinas.edu -Uadministrator PASTA SYSVOL Replicando a pasta sysvol. Mapeando IDs de grupos e usu\u00e1rios para o dcslave (execute estes comando NO DCMASTER): tdbbackup -s .bak /opt/samba/private/idmap.ldb scp -rv -p22200 /opt/samba/private/idmap.ldb.bak root@dcslave:/root scp -rv -p22200 /opt/samba/var/locks/sysvol/* root@dcslave:/opt/samba/var/locks/sysvol Aplicando o arquivo BD que enviamos do dcmaster (execute estes comandos NO DCSLAVE): mv /root/idmap.ldb.bak /root/idmap.ldb cp -rfv /root/idmap.ldb /opt/samba/private/ samba-tool ntacl sysvolreset Agora precisamos pensar que tendo dois DCs na rede, SE cair o prim\u00e1rio o secund\u00e1rio assume o controle, e vice versa. Logicamente devemos apontar um pro outro como resolvedor de nomes prim\u00e1rio, ou seja, o dcmaster vai resolver primeiro no dcslave e o dcslave vai resolver primeiro no dcmaster: Edite o /etc/resolv.conf NO DCMASTER e aponte pro dcslave: vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.200 #(dcslave) nameserver 127.0.0.1 Bloqueando a edi\u00e7\u00e3o do arquivo resolv.conf: chattr +i /etc/resolv.conf E no reverso, edite o /etc/resolv.conf NO DCSLAVE apontando pro dcmaster: Desbloqueando a edi\u00e7\u00e3o do arquivo resolv.conf: chattr -i /etc/resolv.conf vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.250 #(dcmaster) nameserver 127.0.0.1 Bloqueando a edi\u00e7\u00e3o do arquivo resolv.conf: chattr +i /etc/resolv.conf Validando a replica\u00e7\u00e3o ( execute em todos os DCs): samba-tool drs showrepl Criando um usu\u00e1rio no dcmaster (execute NO DCMASTER): samba-tool user create userteste samba-tool user list Validando no dcslave, se consta o usu\u00e1rio criado no dcmaster (execute NO DCSLAVE): samba-tool user list Validando o compartilhamento padr\u00e3o: smbclient -L localhost -U% smbclient //localhost/netlogon -UAdministrator -c 'ls' Validando o DNS local: host -t A officinas.edu localhost Validando a troca de tickets do kerberos: kinit Administrator klist Validando configura\u00e7\u00e3o de kerberos e ldap: host -t srv _kerberos._tcp.officinas.edu host -t srv _ldap._tcp.officinas.edu dig officinas.edu host -t A <m\u00e1quina do dom\u00ednio> Validando informa\u00e7\u00f5es de servidor qual controla o PDC Emulator: samba-tool fsmo show | grep -i pdc samba-tool fsmo show Validando a localiza\u00e7\u00e3o do diret\u00f3rio 'sysvol' do dcmaster: uname -ra find /opt/samba -iname sysvol /opt/samba/var/locks/sysvol Validando espa\u00e7o dispon\u00edvel: df -h Validando a UUID do seu disco: blkid /dev/sda2 #(Sete A SUA parti\u00e7\u00e3o de disco) Validando suporte ativo no Kernel \u00e1s flags de acl e seguran\u00e7a: cat /boot/config-6.1.0-17-amd64 | grep _ACL cat /boot/config-6.1.0-17-amd64 | grep FS_SECURITY Gerando e enviando as chaves do ssh para sincroniza\u00e7\u00e3o entre o dcmaster e o dcslave (crie as chaves NO DCMASTER e envie a chave p\u00fablica para o dcslave): (Pode deixar a senha em branco SE preferir) ssh-keygen -t rsa -b 1024 ssh-copy-id -p22200 -i ~/.ssh/id_rsa.pub root@dcslave #(O MEU dcslave usa a porta ssh 22200) Testando a conex\u00e3o por ssh sem pedir senha (SE vc deixou em branco): ssh -p22200 dcslave exit Agora inverta a ordem e crie as chaves NO DCSLAVE e envie para o dcmaster (Rode estes comandos NO DCSLAVE): ssh-keygen -t rsa -b 1024 ssh-copy-id -p22250 -i ~/.ssh/id_rsa.pub root@dcmaster #(enviando para o dcmaster, que usa porta ssh 22250) Testando a conex\u00e3o por ssh sem pedir senha (SE vc deixou em branco): ssh -p22250 dcmaster exit Criando script de sincroniza\u00e7\u00e3o com rsync do diret\u00f3rio 'sysvol' DO DCMASTER para envio ao dcslave (rode estes comando NO DCMASTER): cd /opt vim rsync-sysvol.sh #!/bin/bash # Sincronizando Diretorios do Sysvol do dcmaster para envio ao dcslave: #rsync -Cravz /opt/samba/var/locks/sysvol/* root@192.168.70.200:/opt/samba/var/locks/sysvol/ # no MEU CASO onde a porta do ssh n\u00e3o \u00e1 a default. MEU dcslave usa 22200: rsync -Cravz -e \"ssh -p 22200\" /opt/samba/var/locks/sysvol/* root@192.168.70.200:/opt/samba/var/locks/sysvol/ chmod +x rsync-sysvol ./rsync-sysvol Agendando a sincroniza\u00e7\u00e3o no cron do dcmaster: crontab -e */5 * * * * root bash /opt/rsync-sysvol.sh --silent REPITA o processo de replica\u00e7\u00e3o do sysvol, agora NO DCSLAVE, INVERTENDO os apontamentos de ip, obviamente! Criando script de sincroniza\u00e7\u00e3o do diret\u00f3rio 'sysvol' DO DCSLAVE para envio ao dcmaster (rode os comando agora NO DCSLAVE): cd /opt vim rsync-sysvol.sh #!/bin/bash # Sincronizando Diretorios do Sysvol do dcmaster para envio ao dcslave: #rsync -Cravz /opt/samba/var/locks/sysvol/* root@192.168.70.250:/opt/samba/var/locks/sysvol/ # no MEU CASO onde a porta do ssh n\u00e3o \u00e1 a default. MEU dcmaster usa 22250: rsync -Cravz -e \"ssh -p 22250\" /opt/samba/var/locks/sysvol/* root@192.168.70.250:/opt/samba/var/locks/sysvol/ chmod +x rsync-sysvol ./rsync-sysvol Agendando a sincroniza\u00e7\u00e3o no cron do dcslave: crontab -e */5 * * * * root bash /opt/rsync-sysvol.sh --silent As Esta\u00e7\u00f5es de trabalho, usar\u00e3o, como DNS prim\u00e1rio o PDC Emulator do Dom\u00ednio, e como DNS secund\u00e1rio o PDC Secund\u00e1rio da rede. OSYNC Configurando a sincroniza\u00e7\u00e3o da pasta sysvol com osync, que vai espelhar os DCs (rode esses comandos NO DCMASTER, primeiro): cd /opt git clone https://github.com/deajan/osync.git cd osync sh ./install.sh Vai criar o diret\u00f3rio /etc/osync: Dentro dele vai ter o arquivo de configura\u00e7\u00e3o sync.conf.example. Crie um arquivo sync.conf e cole o conte\u00fado abaixo: vim /etc/osync/sync.conf #!/usr/bin/env bash INSTANCE_ID=\"sysvol_sync\" INITIATOR_SYNC_DIR=\"/opt/samba/var/locks/sysvol\" TARGET_SYNC_DIR=\"ssh://root@192.168.70.200:22200//opt/samba/var/locks/sysvol\" SSH_RSA_PRIVATE_KEY=\"/root/.ssh/id_rsa\" REMOTE_3RD_PARTY_HOSTS=\"\" PRESERVE_ACL=yes PRESERVE_XATTR=yes SOFT_DELETE=yes DESTINATION_MAILS=\"roor@localhost\" #REMOTE_RUN_AFTER_CMD=\"/opt/samba/bin/samba-tool ntacl sysvolreset\" rodando o script de atualiza\u00e7\u00e3o, que est\u00e1 dentro do /opt/osync, apontando pro arquivo /etc/osync/sync.conf: ./upgrade-v1.0x-v1.2x.sh /etc/osync/sync.conf Vai ficar semelhante ao modelo abaixo: #!/usr/bin/env bash INSTANCE_ID=\"sysvol_sync\" INITIATOR_SYNC_DIR=\"/opt/samba/var/locks/sysvol\" TARGET_SYNC_DIR=\"ssh://root@192.168.70.200:22200//opt/samba/var/locks/sysvol\" SSH_RSA_PRIVATE_KEY=\"/root/.ssh/id_rsa\" SSH_PASSWORD_FILE=\"\" _REMOTE_TOKEN=\"SomeAlphaNumericToken9\" CREATE_DIRS=false LOGFILE=\"\" MINIMUM_SPACE=\"10240\" BANDWIDTH=\"0\" SUDO_EXEC=false RSYNC_EXECUTABLE=\"rsync\" RSYNC_REMOTE_PATH=\"\" RSYNC_PATTERN_FIRST=\"include\" RSYNC_INCLUDE_PATTERN=\"\" RSYNC_EXCLUDE_PATTERN=\"\" RSYNC_INCLUDE_FROM=\"\" RSYNC_EXCLUDE_FROM=\"\" PATH_SEPARATOR_CHAR=\";\" SSH_COMPRESSION=true SSH_IGNORE_KNOWN_HOSTS=false SSH_CONTROLMASTER=false REMOTE_HOST_PING=false Testando o sincronizmo (ignore o erro de email): /usr/local/bin/osync.sh /etc/osync/sync.conf --dry --verbose Rodar o sincronizmo de fato: /usr/local/bin/osync.sh /etc/osync/sync.conf --verbose Agendar no cron: crontab -e */5 * * * * root bash /usr/local/bin/osync.sh /etc/osync/sync.conf --silent Validando os logs em tempo real, rode o /usr/local/bin/osync.sh, mantendo outro terminal aberto com o comando: tail -f /var/log/osync.sysvol_sync.log INVERTENDO a sincroniza\u00e7\u00e3o com o Osync, vamos refazer tudo, inclu\u00edndo o ip e porta ssh, agora NO DCSLAVE: cd /opt git clone https://github.com/deajan/osync.git cd osync sh ./install.sh Vai criar o diret\u00f3rio /etc/osync: Dentro dele vai ter o arquivo de configura\u00e7\u00e3o sync.conf.example. Crie um arquivo sync.conf e cole o conte\u00fado abaixo: #!/usr/bin/env bash INSTANCE_ID=\"sysvol_sync\" INITIATOR_SYNC_DIR=\"/opt/samba/var/locks/sysvol\" TARGET_SYNC_DIR=\"ssh://root@192.168.70.250:22250//opt/samba/var/locks/sysvol\" SSH_RSA_PRIVATE_KEY=\"/root/.ssh/id_rsa\" REMOTE_3RD_PARTY_HOSTS=\"\" PRESERVE_ACL=yes PRESERVE_XATTR=yes SOFT_DELETE=yes DESTINATION_MAILS=\"roor@localhost\" #REMOTE_RUN_AFTER_CMD=\"/opt/samba/bin/samba-tool ntacl sysvolreset\" Vai precisa configurar seu ip e o path pra rodar o script de atualiza\u00e7\u00e3o, apontando pro arquivo sync.conf: ./upgrade-v1.0x-v1.2x.sh /etc/osync/sync.conf Vai ficar semelhante ao modelo abaixo: #!/usr/bin/env bash INSTANCE_ID=\"sysvol_sync\" INITIATOR_SYNC_DIR=\"/opt/samba/var/locks/sysvol\" TARGET_SYNC_DIR=\"ssh://root@192.168.70.250:22250//opt/samba/var/locks/sysvol\" SSH_RSA_PRIVATE_KEY=\"/root/.ssh/id_rsa\" SSH_PASSWORD_FILE=\"\" _REMOTE_TOKEN=\"SomeAlphaNumericToken9\" CREATE_DIRS=false LOGFILE=\"\" MINIMUM_SPACE=\"10240\" BANDWIDTH=\"0\" SUDO_EXEC=false RSYNC_EXECUTABLE=\"rsync\" RSYNC_REMOTE_PATH=\"\" RSYNC_PATTERN_FIRST=\"include\" RSYNC_INCLUDE_PATTERN=\"\" RSYNC_EXCLUDE_PATTERN=\"\" RSYNC_INCLUDE_FROM=\"\" RSYNC_EXCLUDE_FROM=\"\" PATH_SEPARATOR_CHAR=\";\" SSH_COMPRESSION=true SSH_IGNORE_KNOWN_HOSTS=false SSH_CONTROLMASTER=false REMOTE_HOST_PING=false Testar o sincronizmo (ignore o erro de email): /usr/local/bin/osync.sh /etc/osync/sync.conf --dry --verbose Rodar o sincronizmo de fato: /usr/local/bin/osync.sh /etc/osync/sync.conf --verbose Agendar no cron: crontab -e */5 * * * * root bash /usr/local/bin/osync.sh /etc/osync/sync.conf --silent Validando os logs em tempo real, rode o /usr/local/bin/osync.sh, mantendo outro terminal aberto com o comando: tail -f /var/log/osync.sysvol_sync.log THAT\u2019S ALL FOLKS!! FileServer com Samba4 no Debian 12 Layout de rede usado no laborat\u00f3rio: firewall 192.168.70.254 (enp1s0) - 192.168.122.254 (enp7s0) (ssh 2277) dcmaster 192.168.70.250 (ssh 22250) mkdocs 192.168.70.222 (ssh 22222) dcslave 192.168.70.200 (ssh 22200) fileserver 192.168.70.150 (ssh 22100) ; firewall Roteamento por Iptables ; dcmaster Controlador de Dom\u00ednio prim\u00e1rio ; mkdocs Servidor de Documentos ; dcslave Controlador de Dom\u00ednio secund\u00e1rio ; fileserver Servidor de Arquivos Instalando as depend\u00eancias para compila\u00e7\u00e3o do c\u00f3digo fonte do Samba4: export DEBIAN_FRONTEND=noninteractive;apt-get update; apt-get install vim ntp net-tools rsync acl apt-utils attr autoconf bind9-utils binutils bison build-essential ntp rsync ccache chrpath curl debhelper bind9-dnsutils docbook-xml docbook-xsl flex gcc gdb git glusterfs-common gzip heimdal-multidev hostname htop krb5-config krb5-user lcov libacl1-dev libarchive-dev libattr1-dev libavahi-common-dev libblkid-dev libbsd-dev libcap-dev libcephfs-dev libcups2-dev libdbus-1-dev libglib2.0-dev libgnutls28-dev libgpgme-dev libicu-dev libjansson-dev libjs-jquery libjson-perl libkrb5-dev libldap2-dev liblmdb-dev libncurses-dev libpam0g-dev libparse-yapp-perl libpcap-dev libpopt-dev libreadline-dev libsystemd-dev libtasn1-bin libtasn1--5-dev libunwind-dev lmdb-utils locales lsb-release make mawk mingw-w64 patch perl perl-modules-5.40 pkg-config procps psmisc python3 python3-cryptography python3-dbg python3-dev python3-dnspython python3-gpg python3-iso8601 python3-markdown python3-matplotlib python3-pexpect python3-pyasn1 rsync sed tar tree uuid-dev wget xfslibs-dev xsltproc zlib1g-dev -y Setando e validando o hostname do dcslave: vim /etc/hostname fileserver hostname -f fileserver.officinas.edu Configurando o arquivo de hosts: vim /etc/hosts .0.0.1 localhost 127.0.1.1 fileserver.officinas.edu fileserver 192.168.70.150 fileserver.officinas.edu fileserver 192.168.70.200 dcslave.officinas.edu dcslave 192.168.70.222 mkdocs.officinas.edu mkdocs 192.168.70.250 dcmaster.officinas.edu dcmaster 192.168.70.254 firewall.officinas.edu firewall Setando ip fixo no servidor dcslave: vim /etc/network/interfaces allow-hotplug enp1s0 iface enp1s0 inet static address 192.168.70.150 netmask 255.255.255.0 gateway 192.168.70.254 Apontando o endere\u00e7o do resolvedor de nomes principal da rede pro Controlador de dom\u00ednio prim\u00e1rio, dcmaster (tempor\u00e1rio): vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.250 #(dcmaster) nameserver 192.168.70.200 #(dcslave) Bloqueando altera\u00e7\u00e3o do resolv.conf: chattr +i /etc/resolv.conf Validando a resolu\u00e7\u00e3o de nomes pelo dcmaster: nslookup officinas.edu Server: 192.168.70.250 Address: 192.168.70.250#53 Name: officinas.edu Address: 192.168.70.250 Name: officinas.edu Address: 192.168.70.200 Relendo as configura\u00e7\u00f5es de rede: systemctl restart networking Validando o ip da placa: ip -c addr ip -br link Baixando e compilando o c\u00f3digo fonte do Samba4: wget https://download.samba.org/pub/samba/samba-4.19.4.tar.gz tar -xvzf samba-4.19.4.tar.gz cd samba-4.19.4 ./configure --prefix=/opt/samba make && make install Adicionando /opt/Samba ao path padr\u00e3o do Linux, colando a linha completa ao final do .bashrc: PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\" vim ~/.bashrc PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\" Relendo o arquivo de profile: source ~/.bashrc Criando o daemon de inicializa\u00e7\u00e3o do Samba4 com o sistema: vim /etc/systemd/system/samba-ad-dc.service [Unit] Description=Samba4 Active Directory Slave Domain Controller After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/samba -D PIDFile=/opt/samba/var/run/samba.pid [Install] WantedBy=multi-user.target chmod +x /etc/systemd/system/samba-ad-dc.service Configurando o servi\u00e7o de sincroniza\u00e7\u00e3o de hor\u00e1rio, apontando pro Controlador de dom\u00ednio prim\u00e1rio, dcmaster: mv /etc/ntpsec/ntp.conf{,.orig} vim /etc/ntpsec/ntp.conf driftfile /var/lib/ntpsec/ntp.drift leapfile /usr/share/zoneinfo/leap-seconds.list tos minclock 4 minsane 3 pool 192.168.70.250 iburst #(dcmaster) restrict default kod nomodify nopeer noquery limited restrict 127.0.0.1 restrict ::1 tinker panic 0 #(Usado SOMENTE em VMs) systemctl restart ntp ntpq -p date ATEN\u00c7\u00c3O!! N\u00c3O PROVISIONE O SAMBA DO FILESERVER!! ATEN\u00c7\u00c3O!! N\u00c3O PROVISIONE O SAMBA DO FILESERVER!! Configurando o /etc/krb5.conf: # vim /etc/krb5.conf [libdefaults] #(sem espa\u00e7o no canto dessa linha) dns_lookup_realm = false dns_lookup_kdc = true default_realm = OFFICINAS.EDU Configurando o time server: apt-get install ntp ntpdate -y nano /etc/ntpsec/ntp.conf # Rel\u00f3gio Local ( Nota: Este n\u00e3o \u00e9 o endere\u00e7o localhost! ) server 127.127.1.0 fudge 127.127.1.0 stratum 10 server 192.168.70.250 iburst prefer #(dcmaster) driftfile /var/lib/ntp/ntp.drift logfile /var/log/ntp restrict default ignore restrict 127.0.0.1 restrict 192.168.70.250 mask 255.255.255.255 nomodify notrap nopeer noquery systemctl restart ntp ntpq -p date Validando mapeamentos: getent hosts fileserver Configurando o smb.conf: # vim /opt/samba/etc/smb.conf # Define as informa\u00e7\u00f5es do dom\u00ednio. [global] workgroup = OFFICINAS realm = officinas.edu # Define que esse servidor n\u00e3o aceita acesso sem autentica\u00e7\u00e3o. security = ADS # Defique qual usu\u00e1rio no dom\u00ednio se equivale ao root. username map = /opt/samba/etc/user.map # Par\u00e2metros para que as permiss\u00f5es se comportem como o Windows. # Herdando permiss\u00f5es e guardando credenciais de logins bem-sucedidos. map acl inherit = yes store dos attributes = yes # Os VFS objects que ser\u00e3o usados. vfs objects = acl_xattr acl_tdb # Arquivo de configura\u00e7\u00e3o do kerberos e qual m\u00e9todo ser\u00e1 usado. dedicated keytab file = /etc/krb5.keytab kerberos method = secrets and keytab # Configura\u00e7\u00f5es do backend para mapeamento de IDs para compatibilidade com Windows. idmap config * : backend = tdb idmap config * : range = 3000-7999 idmap config OFFICINAS: backend = rid idmap config OFFICINAS: range = 10000-999999 # Define que o usu\u00e1rio root n\u00e3o precisa ser mapeado. min domain uid = 0 # Shell padr\u00e3o e diret\u00f3rio home padr\u00e3o. template shell = /bin/bash template homedir = /home/%U # Define o comportamento do Winbind. winbind refresh tickets = yes winbind use default domain = yes winbind enum users = yes winbind enum groups = yes winbind cache time = 7200 winbind nss info = rfc2307 # Cada escrita de dados ser\u00e1 seguida por um fsync() para garantir que os dados sejam gravados no disco. Usei em ext4 e xfs mas n\u00e3o testei no btrfs. sync always = yes strict sync = yes # Onde ser\u00e3o gravados os logs e o nivel de detalhes. log file = /var/log/samba/%m.log log level = 3 [FILESERVER] path = /home/fileserver comment = Compartilhamentos da Rede read only = No browseable = yes vfs objects = acl_xattr acl_tdb full_audit full_audit:success = renameat rewinddir unlinkat full_audit:prefix = %U|%I|%S full_audit:failure = none full_audit:facility = local4 full_audit:priority = alert # PAR\u00c2METROS USADOS NA AUDITORIA: # Adiciona todos os vfs objects. acl_xattr acl_tdb full_audit # arquivos renomeados, diret\u00f3rios renomeados, arquivos deletados. renameat rewinddir unlinkat # usu\u00e1rio, ip, a\u00e7\u00e3o. %U|%I|%S restart.samba o Samba instalado em /opt/samba/ pode n\u00e3o ter permiss\u00e3o para gravar diretamente em /var/log/samba mkdir -p /var/log/samba chown root:root /var/log/samba chmod 755 /var/log/samba Ou aponte para um diret\u00f3rio interno, como: log file = /opt/samba/var/logs/%m.log Auditando arquivos deletados: cat /var/log/syslog | grep unlinkat tail -f /var/log/syslog | grep unlinkat #(Teste em tempo real). Criando o diret\u00f3rio da rede: mkdir /home/fileserver chmod -R 0770 /home/fileserver chown -R root:\"domain admins\" /home/fileserver getfacl /home/fileserver EXTRA! SE optar por uso de perfil m\u00f3vel: mkdir /opt/samba/var/lib/samba/profiles chmod -R 0770 /opt/samba/var/lib/samba/profiles chown -R root:\"domain admins\" /opt/samba/var/lib/samba/profiles Adicionando o path do /opt/samba/etc/smb.conf: Linkando as bibliotecas para mapeamento de usu\u00e1rios de sistema local e Samba4: /opt/samba/sbin/smbd -b | grep LIBDIR ln -s /opt/samba/lib/libnss_winbind.so.2 /lib/x86-64-linux-gnu ln -s /lib/x86_64-linux-gnu/libnss_winbind.so.2 /lib/x86_64-linux-gnu/libnss_winbind.so ldconfig vim /etc/nsswitch.conf passwd: files winbind group: files winbind shadow: files Dando poderes de root ao Administrator: nano /opt/samba/etc/user.map !root=officinas.edu\\Administrator Criando o diret\u00f3rio de logs: mkdir /var/log/samba Validando a troca de tickets do Kerberos: kinit Administrator klist Ingressando o Fileserver ao dom\u00ednio: net ads join -U Administrator Subindo os servi\u00e7os ao boot do Sistema: /opt/samba/sbin/smbd && /opt/samba/sbin/nmbd && /opt/samba/sbin/winbindd Adicionando o smbd ao boot do Linux: cd /etc/systemd/system vim smbd.service [Unit] Description=Samba SMBD FileServer After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/smbd PIDFile=/opt/samba/var/run/smbd.pid [Install] WantedBy=multi-user.target Adicionando o nmbd ao boot do Linux: cd /etc/systemd/system vim nmbd.service [Unit] Description=Samba NMBD FileServer After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/nmbd PIDFile=/opt/samba/var/run/nmbd.pid [Install] WantedBy=multi-user.target Adicionando o nmbd ao boot do Linux: cd /etc/systemd/system vim winbindd.service [Unit] Description=Samba WINBIND FileServer After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/winbindd PIDFile=/opt/samba/var/run/winbindd.pid [Install] WantedBy=multi-user.target systemctl enable smbd.service nmbd.service winbindd.service pkill smb && pkill nmb && pkill winbind systemctl start smbd.service nmbd.service winbindd.service echo \"systemctl start smbd.service nmbd.service winbindd.service\" > /sbin/start.samba echo \"systemctl stop smbd.service nmbd.service winbindd.service\" > /sbin/stop.samba echo \"systemctl restart smbd.service nmbd.service winbindd.service\" > /sbin/restart.samba chmod +x /sbin/*.samba Facilitando o boot dos servi\u00e7os: echo \"systemctl start smbd.service nmbd.service winbindd.service\" > /sbin/start.samba echo \"systemctl stop smbd.service nmbd.service winbindd.service\" > /sbin/stop.samba echo \"systemctl restart smbd.service nmbd.service winbindd.service\" > /sbin/restart.samba chmod +x /sbin/*.samba Responde agora com: start.samba, restart.samba e stop.samba Validando wbinfo e getent: wbinfo --ping-dc wbinfo -u wbinfo -g getent passwd Administrator getent group \"domain admins\" Criando o script de backup do /home/fileserver: mkdir /media/HDEXTERNO vim /opt/samba/bkpdiario.sh #!/bin/bash INICIO=`date +%d/%m/%Y-%H:%M:%S` LOG=/var/log/samba/bkpfileserver_`date +%Y-%m-%d`.txt echo \" \" >> $LOG echo \" \" >> $LOG echo \"|-----------------------------------------------\" >> $LOG echo \" Sincronizacao iniciada em $INICIO\" >> $LOG umount /media/HDEXTERNO mount /dev/sdb1 /media/HDEXTERNO rsync --delete -P -r -z -v /home/fileserver /media/HDEXTERNO/ >> $LOG FINAL=`date +%d/%m/%Y-%H:%M:%S` umount /media/HDEXTERNO echo \" Sincronizacao Finalizada em $FINAL\" >> $LOG echo \"|-----------------------------------------------\" >> $LOG echo \" \" >> $LOG echo \" \" >> $LOG Adicionando o script ao crontab: vim /etc/crontab # Rotinas de backup di\u00e1rio do SAMBA4. # Minuto/Hora/Dia/M\u00eas/Dia_semana/Usu\u00e1rio/Comando 45 23 * * 1-5 root /opt/samba/bkpdiario.sh > /dev/null 2>&1 VAI MONTAR O HD EXTERNO, FAZER O BACKUP E DESMONTAR O HD EXTERNO! THAT\u2019S ALL FOLKS!!","title":"\ud83d\udcc1 DC1 instala\u00e7\u00e3o por pacotes compilados"},{"location":"DC1_pacotes_compilados/#dc1-instalacao-por-pacotes-compilados","text":"","title":"\ud83d\udcc1 DC1 instala\u00e7\u00e3o por pacotes compilados"},{"location":"DC1_pacotes_compilados/#controlador-de-dominio-primario-secundario-e-fileserver-no-debian-linux-12","text":"","title":"Controlador de Dom\u00ednio Prim\u00e1rio, Secund\u00e1rio e Fileserver no Debian Linux 12"},{"location":"DC1_pacotes_compilados/#layout-de-rede-usado-no-laboratorio","text":"firewall 192.168.70.254 (enp1s0) - 192.168.122.254 (enp7s0) (ssh 2277) dcmaster 192.168.70.250 (ssh 22250) mkdocs 192.168.70.222 (ssh 22222) dcslave 192.168.70.200 (ssh 22200) fileserver 192.168.70.150 (ssh 22100) ; firewall Roteamento por Iptables ; dcmaster Controlador de Dom\u00ednio prim\u00e1rio ; mkdocs Servidor de Documentos ; dcslave Controlador de Dom\u00ednio secund\u00e1rio ; fileserver Servidor de Arquivos","title":"Layout de rede usado no laborat\u00f3rio:"},{"location":"DC1_pacotes_compilados/#instalando-as-dependencias-para-compilacao-do-codigo-fonte-do-samba4","text":"export DEBIAN_FRONTEND=noninteractive;apt-get update; apt-get install vim net-tools rsync acl apt-utils attr autoconf bind9-utils binutils bison build-essential ccache chrpath curl debhelper bind9-dnsutils docbook-xml docbook-xsl flex gcc gdb git glusterfs-common gzip heimdal-multidev hostname htop krb5-config krb5-user lcov libacl1-dev libarchive-dev libattr1-dev libavahi-common-dev libblkid-dev libbsd-dev libcap-dev libcephfs-dev libcups2-dev libdbus-1-dev libglib2.0-dev libgnutls28-dev libgpgme-dev libicu-dev libjansson-dev libjs-jquery libjson-perl libkrb5-dev libldap2-dev liblmdb-dev libncurses-dev libpam0g-dev libparse-yapp-perl libpcap-dev libpopt-dev libreadline-dev libsystemd-dev libtasn1-bin libtasn1-6-dev libunwind-dev lmdb-utils locales lsb-release make mawk mingw-w64 patch perl perl-modules-5.40 pkg-config procps psmisc python3 python3-cryptography python3-dbg python3-dev python3-dnspython python3-gpg python3-iso8601 python3-markdown python3-matplotlib python3-pexpect python3-pyasn1 rsync sed tar tree uuid-dev wget xfslibs-dev xsltproc zlib1g-dev -y","title":"Instalando as depend\u00eancias para compila\u00e7\u00e3o do c\u00f3digo fonte do Samba4:"},{"location":"DC1_pacotes_compilados/#setando-e-validando-o-hostname-do-dcmaster","text":"hostnamectl set-hostname dcmaster","title":"Setando e validando o hostname do dcmaster:"},{"location":"DC1_pacotes_compilados/#configurando-o-arquivo-de-hosts","text":"vim /etc/hosts .0.0.1 localhost 127.0.1.1 dcmaster.officinas.edu dcmaster 192.168.70.254 dcmaster.officinas.edu dcmaster hostname -f","title":"Configurando o arquivo de hosts:"},{"location":"DC1_pacotes_compilados/#setando-ip-fixo-no-servidor-dcmaster","text":"vim /etc/network/interfaces iface enp1s0 inet static address 192.168.70.250 netmask 255.255.255.0 gateway 192.168.70.254 dns-nameserver 192.168.70.254 #(firewall) dns-search officinas.edu","title":"Setando ip fixo no servidor dcmaster:"},{"location":"DC1_pacotes_compilados/#setando-endereco-do-firewall-como-resolvedor-externo-temporario-ate-provisionar-o-dominio","text":"vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.254 #(firewall)","title":"Setando endere\u00e7o do firewall como resolvedor externo (tempor\u00e1rio at\u00e9 provisionar o dom\u00ednio):"},{"location":"DC1_pacotes_compilados/#validando-o-ip-da-placa","text":"ip -c addr ip -br link","title":"Validando o ip da placa:"},{"location":"DC1_pacotes_compilados/#baixando-e-compilando-o-codigo-fonte-do-samba4","text":"wget https://download.samba.org/pub/samba/samba-4.22.1.tar.gz tar -xvzf samba-4.22.1.tar.gz cd samba-4.22.1 ./configure --prefix=/opt/samba make make install","title":"Baixando e compilando o c\u00f3digo fonte do Samba4:"},{"location":"DC1_pacotes_compilados/#adicionando-optsamba-ao-path-padrao-do-linux-colando-a-linha-completa-ao-final-do-bashrc","text":"","title":"Adicionando /opt/Samba ao path padr\u00e3o do Linux, colando a linha completa ao final do .bashrc:"},{"location":"DC1_pacotes_compilados/#pathusrlocalsbinusrlocalbinusrsbinusrbinsbinbinoptsambabinoptsambasbin","text":"vim ~/.bashrc PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\"","title":"PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\""},{"location":"DC1_pacotes_compilados/#relendo-o-arquivo-de-profile","text":"source ~/.bashrc","title":"Relendo o arquivo de profile:"},{"location":"DC1_pacotes_compilados/#criando-o-daemon-de-inicializacao-do-samba4-com-o-sistema","text":"vim /etc/systemd/system/samba-ad-dc.service [Unit] Description=Samba4 Active Directory Master Domain Controller After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/samba -D PIDFile=/opt/samba/var/run/samba.pid [Install] WantedBy=multi-user.target chmod +x /etc/systemd/system/samba-ad-dc.service","title":"Criando o daemon de inicializa\u00e7\u00e3o do Samba4 com o sistema:"},{"location":"DC1_pacotes_compilados/#instalando-e-editando-o-servico-de-sincronizacao-de-horario","text":"cp /etc/ntpsec/ntp.conf{,.orig} vim /etc/ntpsec/ntp.conf driftfile /var/lib/ntpsec/ntp.drift leapfile /usr/share/zoneinfo/leap-seconds.list pool a.ntp.org iburst pool b.ntp.org iburst pool 2.debian.pool.ntp.org iburst pool 3.debian.pool.ntp.org iburst restrict 127.0.0.1 restrict ::1 tinker panic 0 #(Flag usada SOMENTE em VMs) systemctl restart ntpd ntpq -p","title":"Instalando e editando o servi\u00e7o de sincroniza\u00e7\u00e3o de hor\u00e1rio:"},{"location":"DC1_pacotes_compilados/#provisionando-o-novo-dominio-suportado-pelo-dcmaster","text":"samba-tool domain provision --use-rfc2307 --interactive --option=\u201dinterfaces=lo enp1s0\u201d --option=\u201dbind interfaces only=yes\u201d","title":"Provisionando o novo dom\u00ednio suportado pelo dcmaster:"},{"location":"DC1_pacotes_compilados/#habilitando-o-daemon-pra-subir-no-boot-do-sistema","text":"systemctl daemon-reload systemctl enable samba-ad-dc.service systemctl start samba-ad-dc.service systemctl status samba-ad-dc.service","title":"Habilitando o daemon pra subir no boot do sistema:"},{"location":"DC1_pacotes_compilados/#linkando-o-arquivo-krb5conf-do-samba4-ao-etc-do-sistema","text":"mv /etc/krb5.conf{,.orig} ln -sf /opt/samba/private/krb5.conf /etc/krb5.conf","title":"Linkando o arquivo krb5.conf do Samba4 ao /etc do sistema:"},{"location":"DC1_pacotes_compilados/#apos-o-provisionamento-da-samba4-precisamos-reconfigurar-o-etcresolvconf-e-setar-o-dns-apontando-a-resolucao-de-nomes-para-o-proprio-dcmaster","text":"vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 127.0.0.1 #(localhost)","title":"AP\u00d3S o provisionamento da Samba4, precisamos reconfigurar o /etc/resolv.conf e setar o DNS apontando a resolu\u00e7\u00e3o de nomes para o pr\u00f3prio dcmaster:"},{"location":"DC1_pacotes_compilados/#bloqueando-alteracao-do-resolvconf","text":"chattr +i /etc/resolv.conf","title":"Bloqueando altera\u00e7\u00e3o do resolv.conf:"},{"location":"DC1_pacotes_compilados/#validando-resolvedor-de-nomes-pelo-dcmaster","text":"nslookup dcmaster.officinas.edu","title":"Validando resolvedor de nomes pelo dcmaster:"},{"location":"DC1_pacotes_compilados/#vai-validar-na-tela","text":"Server: 127.0.0.1 Address: 127.0.0.1#53 Name: dcmaster.officinas.edu Address: 192.168.70.250","title":"Vai validar na tela:"},{"location":"DC1_pacotes_compilados/#reboot-do-servidor-dcmaster","text":"reboot","title":"Reboot do servidor dcmaster:"},{"location":"DC1_pacotes_compilados/#validando-os-servicos-do-samba4-no-boot-do-sistema","text":"ps aux | grep samba ps aux | egrep \"samba|smbd|nmbd|winbind\" find / -name samba.pid pgrep samba","title":"Validando os servi\u00e7os do Samba4 no boot do sistema:"},{"location":"DC1_pacotes_compilados/#dando-poderes-de-root-ao-administrator","text":"vim /opt/samba/etc/user.map !root=officinas.edu\\Administrator","title":"Dando poderes de root ao Administrator:"},{"location":"DC1_pacotes_compilados/#linkando-bibliotecas-do-samba4-para-mapeamento-de-usuarios-no-sistema-linux-rode-esses-comandos-manualmente-sem-copiar-e-colar","text":"/opt/samba/sbin/smbd -b | grep LIBDIR ln -s /opt/samba/lib/libnss_winbind.so.2 /lib/x86-64-linux-gnu ln -s /lib/x86_64-linux-gnu/libnss_winbind.so.2 /lib/x86_64-linux-gnu/libnss_winbind.so ldconfig","title":"Linkando bibliotecas do Samba4 para mapeamento de usu\u00e1rios no sistema Linux (rode esses comandos manualmente sem copiar e colar):"},{"location":"DC1_pacotes_compilados/#validando-a-autenticacao-de-usuarios-de-rede-no-sistema-linux-mas-tbem-no-winbind","text":"vim /etc/nsswitch.conf passwd: files systemd winbind group: files systemd winbind shadow: files","title":"Validando a autentica\u00e7\u00e3o de usu\u00e1rios de rede no sistema Linux mas tb\u00e9m no winbind:"},{"location":"DC1_pacotes_compilados/#editando-o-arquivo-smbconf-e-adicionando-no-dns-forwarder-quem-resolve-nomes-para-consultas-externas-o-firewall-e-o-google","text":"cp /opt/samba/etc/smb.conf{,.orig} vim /opt/samba/etc/smb.conf [global] bind interfaces only = Yes dns forwarder = 192.168.70.254 8.8.8.8 #(firewall + google) interfaces = lo enp1s0 netbios name = DCMASTER realm = OFFICINAS.EDU server role = active directory domain controller workgroup = OFFICINAS idmap_ldb:use rfc2307 = yes [sysvol] path = /opt/samba/var/locks/sysvol read only = No [netlogon] path = /opt/samba/var/locks/sysvol/officinas.edu/scripts read only = No","title":"Editando o arquivo smb.conf e adicionando no dns forwarder, quem resolve nomes para consultas externas (o firewall e o google):"},{"location":"DC1_pacotes_compilados/#relendo-a-configuracao-do-samba4","text":"smbcontrol all reload-config","title":"Relendo a configura\u00e7\u00e3o do Samba4:"},{"location":"DC1_pacotes_compilados/#validando-usuarios-da-base-do-ldap-local","text":"cat /etc/passwd | grep root","title":"Validando usu\u00e1rios da base do ldap local:"},{"location":"DC1_pacotes_compilados/#validando-usuarios-de-rede-do-samba4-intermediados-pelo-winbind","text":"samba-tool user show administrator getent passwd administrator wbinfo -u wbinfo -g wbinfo --ping-dc getent group \"Domain Admins\"","title":"Validando usu\u00e1rios de rede do Samba4 (Intermediados pelo winbind):"},{"location":"DC1_pacotes_compilados/#validando-daemons-ativos","text":"ps aux | egrep \"samba|smbd|nmbd|winbind\" ps axf","title":"Validando daemons ativos:"},{"location":"DC1_pacotes_compilados/#consultando-servicos-do-samba4","text":"smbclient --version smbclient -L dc01 -U Administrator smbclient //localhost/netlogon -UAdministrator -c \"ls\" testparm samba-tool domain level show","title":"Consultando servi\u00e7os do SAMBA4:"},{"location":"DC1_pacotes_compilados/#desabilitando-complexidade-de-senhas-inseguro","text":"samba-tool domain passwordsettings show samba-tool domain passwordsettings set --complexity=off samba-tool domain passwordsettings set --history-length=0 samba-tool domain passwordsettings set --min-pwd-length=0 samba-tool domain passwordsettings set --min-pwd-age=0 samba-tool user setexpiry Administrator --noexpiry","title":"Desabilitando complexidade de senhas (inseguro):"},{"location":"DC1_pacotes_compilados/#relendo-as-configuracoes-do-samba4","text":"smbcontrol all reload-config","title":"Relendo as configura\u00e7\u00f5es do SAMBA4:"},{"location":"DC1_pacotes_compilados/#validando-a-troca-de-tickets-do-kerberos","text":"kinit Administrator@OFFICINAS.EDU klist","title":"Validando a troca de tickets do Kerberos:"},{"location":"DC1_pacotes_compilados/#consultando-as-bases-do-kerberos-ldap-e-dns","text":"host -t srv _kerberos._tcp.officinas.edu host -t srv _ldap._tcp.officinas.edu host -t A dcmaster.officinas.edu. dig officinas.edu THAT\u2019S ALL FOLKS!!","title":"Consultando as bases do kerberos, ldap e dns:"},{"location":"DC1_pacotes_compilados/#controlador-de-dominio-secundario-com-samba4-no-debian-12","text":"","title":"Controlador de Dom\u00ednio secund\u00e1rio com Samba4 no Debian 12"},{"location":"DC1_pacotes_compilados/#layout-de-rede-usado-no-laboratorio_1","text":"firewall 192.168.70.254 (enp1s0) - 192.168.122.254 (enp7s0) (ssh 2277) dcmaster 192.168.70.250 (ssh 22250) mkdocs 192.168.70.222 (ssh 22222) dcslave 192.168.70.200 (ssh 22200) fileserver 192.168.70.150 (ssh 22100) ; firewall Roteamento por Iptables ; dcmaster Controlador de Dom\u00ednio prim\u00e1rio ; mkdocs Servidor de Documentos ; dcslave Controlador de Dom\u00ednio secund\u00e1rio ; fileserver Servidor de Arquivos","title":"Layout de rede usado no laborat\u00f3rio:"},{"location":"DC1_pacotes_compilados/#instalando-as-dependencias-para-compilacao-do-codigo-fonte-do-samba4_1","text":"export DEBIAN_FRONTEND=noninteractive;apt-get update; apt-get install vim net-tools rsync acl apt-utils attr autoconf bind9-utils binutils bison build-essential ntp rsync ccache chrpath curl debhelper bind9-dnsutils docbook-xml docbook-xsl flex gcc gdb git glusterfs-common gzip heimdal-multidev hostname htop krb5-config krb5-user lcov libacl1-dev libarchive-dev libattr1-dev libavahi-common-dev libblkid-dev libbsd-dev libcap-dev libcephfs-dev libcups2-dev libdbus-1-dev libglib2.0-dev libgnutls28-dev libgpgme-dev libicu-dev libjansson-dev libjs-jquery libjson-perl libkrb5-dev libldap2-dev liblmdb-dev libncurses-dev libpam0g-dev libparse-yapp-perl libpcap-dev libpopt-dev libreadline-dev libsystemd-dev libtasn1-bin libtasn1--5-dev libunwind-dev lmdb-utils locales lsb-release make mawk mingw-w64 patch perl perl-modules-5.40 pkg-config procps psmisc python3 python3-cryptography python3-dbg python3-dev python3-dnspython python3-gpg python3-iso8601 python3-markdown python3-matplotlib python3-pexpect python3-pyasn1 rsync sed tar tree uuid-dev wget xfslibs-dev xsltproc zlib1g-dev -y","title":"Instalando as depend\u00eancias para compila\u00e7\u00e3o do c\u00f3digo fonte do Samba4:"},{"location":"DC1_pacotes_compilados/#setando-e-validando-o-hostname-do-dcslave","text":"vim /etc/hostname dcslave hostname -f dcslave.officinas.edu","title":"Setando e validando o hostname do dcslave:"},{"location":"DC1_pacotes_compilados/#configurando-o-arquivo-de-hosts_1","text":"vim /etc/hosts .0.0.1 localhost 127.0.1.1 dcslave.officinas.edu dcslave 192.168.70.150 fileserver.officinas.edu fileserver 192.168.70.200 dcslave.officinas.edu dcslave 192.168.70.222 mkdocs.officinas.edu mkdocs 192.168.70.250 dcmaster.officinas.edu dcmaster 192.168.70.254 firewall.officinas.edu firewall","title":"Configurando o arquivo de hosts:"},{"location":"DC1_pacotes_compilados/#setando-ip-fixo-no-servidor-dcslave","text":"vim /etc/network/interfaces allow-hotplug enp1s0 iface enp1s0 inet static address 192.168.70.200 netmask 255.255.255.0 gateway 192.168.70.254","title":"Setando ip fixo no servidor dcslave:"},{"location":"DC1_pacotes_compilados/#apontando-o-endereco-do-resolvedor-de-nomes-principal-da-rede-pro-controlador-de-dominio-primario-dcmaster-temporario-ate-provisionar","text":"vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.250 #(dcmaster) nameserver 127.0.0.1","title":"Apontando o endere\u00e7o do resolvedor de nomes principal da rede pro Controlador de dom\u00ednio prim\u00e1rio, dcmaster (tempor\u00e1rio, at\u00e9 provisionar):"},{"location":"DC1_pacotes_compilados/#validando-a-resolucao-de-nomes-pelo-dcmaster","text":"nslookup officinas.edu Server: 192.168.70.250 Address: 192.168.70.250#53 Name: officinas.edu Address: 192.168.70.250 Name: officinas.edu Address: 192.168.70.200","title":"Validando a resolu\u00e7\u00e3o de nomes pelo dcmaster:"},{"location":"DC1_pacotes_compilados/#relendo-as-configuracoes-de-rede","text":"systemctl restart networking","title":"Relendo as configura\u00e7\u00f5es de rede:"},{"location":"DC1_pacotes_compilados/#validando-o-ip-da-placa_1","text":"ip -c addr ip -br link","title":"Validando o ip da placa:"},{"location":"DC1_pacotes_compilados/#baixando-e-compilando-o-codigo-fonte-do-samba4_1","text":"wget https://download.samba.org/pub/samba/samba-4.19.4.tar.gz tar -xvzf samba-4.19.4.tar.gz cd samba-4.19.4 ./configure --prefix=/opt/samba make && make install","title":"Baixando e compilando o c\u00f3digo fonte do Samba4:"},{"location":"DC1_pacotes_compilados/#adicionando-optsamba-ao-path-padrao-do-linux-colando-a-linha-completa-ao-final-do-bashrc_1","text":"","title":"Adicionando /opt/Samba ao path padr\u00e3o do Linux, colando a linha completa ao final do .bashrc:"},{"location":"DC1_pacotes_compilados/#pathusrlocalsbinusrlocalbinusrsbinusrbinsbinbinoptsambabinoptsambasbin_1","text":"vim ~/.bashrc PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\"","title":"PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\""},{"location":"DC1_pacotes_compilados/#relendo-o-arquivo-de-profile_1","text":"source ~/.bashrc","title":"Relendo o arquivo de profile:"},{"location":"DC1_pacotes_compilados/#criando-o-daemon-de-inicializacao-do-samba4-com-o-sistema_1","text":"vim /etc/systemd/system/samba-ad-dc.service [Unit] Description=Samba4 Active Directory Slave Domain Controller After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/samba -D PIDFile=/opt/samba/var/run/samba.pid [Install] WantedBy=multi-user.target chmod +x /etc/systemd/system/samba-ad-dc.service","title":"Criando o daemon de inicializa\u00e7\u00e3o do Samba4 com o sistema:"},{"location":"DC1_pacotes_compilados/#configurando-o-servico-de-sincronizacao-de-horario-apontando-pro-controlador-de-dominio-primario-dcmaster","text":"mv /etc/ntpsec/ntp.conf{,.orig} vim /etc/ntpsec/ntp.conf driftfile /var/lib/ntpsec/ntp.drift leapfile /usr/share/zoneinfo/leap-seconds.list tos minclock 4 minsane 3 pool 192.168.70.250 iburst #(dcmaster) restrict default kod nomodify nopeer noquery limited restrict 127.0.0.1 restrict ::1 tinker panic 0 #(Flag usada SOMENTE em VMs) systemctl restart ntp ntpq -p date As m\u00e1quinas Windows/Linux, membros do dom\u00ednio, usar\u00e3o o DC1 que ret\u00e9m a fun\u00e7\u00e3o FSMO emulador PDC como fonte de tempo padr\u00e3o!","title":"Configurando o servi\u00e7o de sincroniza\u00e7\u00e3o de hor\u00e1rio, apontando pro Controlador de dom\u00ednio prim\u00e1rio, dcmaster:"},{"location":"DC1_pacotes_compilados/#provisionando-o-servidor-dcslave","text":"samba-tool domain join OFFICINAS.EDU DC -U Administrator --realm=OFFICINAS.EDU --dns-backend=SAMBA_INTERNAL --option=\"interfaces=lo enp1s0\" --option=\"bind interfaces only=yes\" --option=\"idmap_ldb:use-rfc2307=yes\"","title":"Provisionando o servidor DCSLAVE:"},{"location":"DC1_pacotes_compilados/#habilitando-o-daemon-pra-subir-no-boot-do-sistema_1","text":"systemctl daemon reload systemctl enable samba-ad-dc.service systemctl start samba-ad-dc.service systemctl status samba-ad-dc.service","title":"Habilitando o daemon pra subir no boot do sistema:"},{"location":"DC1_pacotes_compilados/#editando-o-arquivo-do-kerberos","text":"mv /etc/krb5.conf{,.orig} vim /etc/krb5.conf [libdefaults] #(sem espa\u00e7o no canto dessa linha) dns_lookup_realm = false dns_lookup_kdc = true default_realm = OFFICINAS.EDU","title":"Editando o arquivo do kerberos:"},{"location":"DC1_pacotes_compilados/#visualizando-o-arquivo-smbconf","text":"cat /opt/samba/etc/smb.conf # Global parameters [global] bind interfaces only = Yes interfaces = lo enp1s0 netbios name = DCSLAVE realm = OFFICINAS.EDU server role = active directory domain controller workgroup = OFFICINAS idmap_ldb:use-rfc2307 = yes [sysvol] path = /opt/samba/var/locks/sysvol read only = No [netlogon] path = /opt/samba/var/locks/sysvol/officinas.edu/scripts read only = No","title":"Visualizando o arquivo smb.conf:"},{"location":"DC1_pacotes_compilados/#validando-as-entradas-dns-usadas","text":"apt install ldb-tools host -t A officinas.edu.","title":"Validando as entradas DNS usadas:"},{"location":"DC1_pacotes_compilados/#se-necessario-se-necessario-adicione-as-entradas-do-dcslave-manualmente-ao-dns-do-samba4-no-dcmaster","text":"samba-tool dns add dcmaster OFFICINAS.EDU dcslave A 192.168.70.200 -U administrator ldbsearch -H /opt/samba/private/sam.ldb '(invocationId=*)' --cross-ncs objectguid host -t CNAME df4bdd8c-abc7-4779-b01e-4dd4553ca3e9._msdcs.officinas.edu.","title":"(SE NECESS\u00c1RIO), SE Necess\u00e1rio, adicione as entradas do dcslave, manualmente AO DNS do Samba4, no dcmaster:"},{"location":"DC1_pacotes_compilados/#se-nao-rodar-execute-a-replicacao-para-todos-os-dcs","text":"samba-tool dns add dcmaster _msdcs.officinas.edu df4bdd8c-abc7-4779-b01e-4dd4553ca3e9 CNAME dcslave.officinas.edu -Uadministrator","title":"SE n\u00e3o rodar, execute a replica\u00e7\u00e3o para todos os DCs:"},{"location":"DC1_pacotes_compilados/#pasta-sysvol","text":"","title":"PASTA SYSVOL"},{"location":"DC1_pacotes_compilados/#replicando-a-pasta-sysvol-mapeando-ids-de-grupos-e-usuarios-para-o-dcslave-execute-estes-comando-no-dcmaster","text":"tdbbackup -s .bak /opt/samba/private/idmap.ldb scp -rv -p22200 /opt/samba/private/idmap.ldb.bak root@dcslave:/root scp -rv -p22200 /opt/samba/var/locks/sysvol/* root@dcslave:/opt/samba/var/locks/sysvol","title":"Replicando a pasta sysvol. Mapeando IDs de grupos e usu\u00e1rios para o dcslave (execute estes comando NO DCMASTER):"},{"location":"DC1_pacotes_compilados/#aplicando-o-arquivo-bd-que-enviamos-do-dcmaster-execute-estes-comandos-no-dcslave","text":"mv /root/idmap.ldb.bak /root/idmap.ldb cp -rfv /root/idmap.ldb /opt/samba/private/ samba-tool ntacl sysvolreset","title":"Aplicando o arquivo BD que enviamos do dcmaster (execute estes comandos NO DCSLAVE):"},{"location":"DC1_pacotes_compilados/#agora-precisamos-pensar-que-tendo-dois-dcs-na-rede-se-cair-o-primario-o-secundario-assume-o-controle-e-vice-versa-logicamente-devemos-apontar-um-pro-outro-como-resolvedor-de-nomes-primario-ou-seja-o-dcmaster-vai-resolver-primeiro-no-dcslave-e-o-dcslave-vai-resolver-primeiro-no-dcmaster","text":"","title":"Agora precisamos pensar que tendo dois DCs na rede, SE cair o prim\u00e1rio o secund\u00e1rio assume o controle, e vice versa. Logicamente devemos apontar um pro outro como resolvedor de nomes prim\u00e1rio, ou seja, o dcmaster vai resolver primeiro no dcslave e o dcslave vai resolver primeiro no dcmaster:"},{"location":"DC1_pacotes_compilados/#edite-o-etcresolvconf-no-dcmaster-e-aponte-pro-dcslave","text":"vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.200 #(dcslave) nameserver 127.0.0.1","title":"Edite o /etc/resolv.conf NO DCMASTER e aponte pro dcslave:"},{"location":"DC1_pacotes_compilados/#bloqueando-a-edicao-do-arquivo-resolvconf","text":"chattr +i /etc/resolv.conf","title":"Bloqueando a edi\u00e7\u00e3o do arquivo resolv.conf:"},{"location":"DC1_pacotes_compilados/#e-no-reverso-edite-o-etcresolvconf-no-dcslave-apontando-pro-dcmaster","text":"","title":"E no reverso, edite o /etc/resolv.conf NO DCSLAVE apontando pro dcmaster:"},{"location":"DC1_pacotes_compilados/#desbloqueando-a-edicao-do-arquivo-resolvconf","text":"chattr -i /etc/resolv.conf vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.250 #(dcmaster) nameserver 127.0.0.1","title":"Desbloqueando a edi\u00e7\u00e3o do arquivo resolv.conf:"},{"location":"DC1_pacotes_compilados/#bloqueando-a-edicao-do-arquivo-resolvconf_1","text":"chattr +i /etc/resolv.conf","title":"Bloqueando a edi\u00e7\u00e3o do arquivo resolv.conf:"},{"location":"DC1_pacotes_compilados/#validando-a-replicacao-execute-em-todos-os-dcs","text":"samba-tool drs showrepl","title":"Validando a replica\u00e7\u00e3o ( execute em todos os DCs):"},{"location":"DC1_pacotes_compilados/#criando-um-usuario-no-dcmaster-execute-no-dcmaster","text":"samba-tool user create userteste samba-tool user list","title":"Criando um usu\u00e1rio no dcmaster (execute NO DCMASTER):"},{"location":"DC1_pacotes_compilados/#validando-no-dcslave-se-consta-o-usuario-criado-no-dcmaster-execute-no-dcslave","text":"samba-tool user list","title":"Validando no dcslave, se consta o usu\u00e1rio criado no dcmaster (execute NO DCSLAVE):"},{"location":"DC1_pacotes_compilados/#validando-o-compartilhamento-padrao","text":"smbclient -L localhost -U% smbclient //localhost/netlogon -UAdministrator -c 'ls'","title":"Validando o compartilhamento padr\u00e3o:"},{"location":"DC1_pacotes_compilados/#validando-o-dns-local","text":"host -t A officinas.edu localhost","title":"Validando o DNS local:"},{"location":"DC1_pacotes_compilados/#validando-a-troca-de-tickets-do-kerberos_1","text":"kinit Administrator klist","title":"Validando a troca de tickets do kerberos:"},{"location":"DC1_pacotes_compilados/#validando-configuracao-de-kerberos-e-ldap","text":"host -t srv _kerberos._tcp.officinas.edu host -t srv _ldap._tcp.officinas.edu dig officinas.edu host -t A <m\u00e1quina do dom\u00ednio>","title":"Validando configura\u00e7\u00e3o de kerberos e ldap:"},{"location":"DC1_pacotes_compilados/#validando-informacoes-de-servidor-qual-controla-o-pdc-emulator","text":"samba-tool fsmo show | grep -i pdc samba-tool fsmo show","title":"Validando informa\u00e7\u00f5es de servidor qual controla o PDC Emulator:"},{"location":"DC1_pacotes_compilados/#validando-a-localizacao-do-diretorio-sysvol-do-dcmaster","text":"uname -ra find /opt/samba -iname sysvol /opt/samba/var/locks/sysvol","title":"Validando a localiza\u00e7\u00e3o do diret\u00f3rio 'sysvol' do dcmaster:"},{"location":"DC1_pacotes_compilados/#validando-espaco-disponivel","text":"df -h","title":"Validando espa\u00e7o dispon\u00edvel:"},{"location":"DC1_pacotes_compilados/#validando-a-uuid-do-seu-disco","text":"blkid /dev/sda2 #(Sete A SUA parti\u00e7\u00e3o de disco)","title":"Validando a UUID do seu disco:"},{"location":"DC1_pacotes_compilados/#validando-suporte-ativo-no-kernel-as-flags-de-acl-e-seguranca","text":"cat /boot/config-6.1.0-17-amd64 | grep _ACL cat /boot/config-6.1.0-17-amd64 | grep FS_SECURITY","title":"Validando suporte ativo no Kernel \u00e1s flags de acl e seguran\u00e7a:"},{"location":"DC1_pacotes_compilados/#gerando-e-enviando-as-chaves-do-ssh-para-sincronizacao-entre-o-dcmaster-e-o-dcslave-crie-as-chaves-no-dcmaster-e-envie-a-chave-publica-para-o-dcslave","text":"","title":"Gerando e enviando as chaves do ssh para sincroniza\u00e7\u00e3o entre o dcmaster e o dcslave (crie as chaves NO DCMASTER e envie a chave p\u00fablica para o dcslave):"},{"location":"DC1_pacotes_compilados/#pode-deixar-a-senha-em-branco-se-preferir","text":"ssh-keygen -t rsa -b 1024 ssh-copy-id -p22200 -i ~/.ssh/id_rsa.pub root@dcslave #(O MEU dcslave usa a porta ssh 22200)","title":"(Pode deixar a senha em branco SE preferir)"},{"location":"DC1_pacotes_compilados/#testando-a-conexao-por-ssh-sem-pedir-senha-se-vc-deixou-em-branco","text":"ssh -p22200 dcslave exit","title":"Testando a conex\u00e3o por ssh sem pedir senha (SE vc deixou em branco):"},{"location":"DC1_pacotes_compilados/#agora-inverta-a-ordem-e-crie-as-chaves-no-dcslave-e-envie-para-o-dcmaster-rode-estes-comandos-no-dcslave","text":"ssh-keygen -t rsa -b 1024 ssh-copy-id -p22250 -i ~/.ssh/id_rsa.pub root@dcmaster #(enviando para o dcmaster, que usa porta ssh 22250)","title":"Agora inverta a ordem e crie as chaves NO DCSLAVE e envie para o dcmaster (Rode estes comandos NO DCSLAVE):"},{"location":"DC1_pacotes_compilados/#testando-a-conexao-por-ssh-sem-pedir-senha-se-vc-deixou-em-branco_1","text":"ssh -p22250 dcmaster exit","title":"Testando a conex\u00e3o por ssh sem pedir senha (SE vc deixou em branco):"},{"location":"DC1_pacotes_compilados/#criando-script-de-sincronizacao-com-rsync-do-diretorio-sysvol-do-dcmaster-para-envio-ao-dcslave-rode-estes-comando-no-dcmaster","text":"cd /opt vim rsync-sysvol.sh #!/bin/bash # Sincronizando Diretorios do Sysvol do dcmaster para envio ao dcslave: #rsync -Cravz /opt/samba/var/locks/sysvol/* root@192.168.70.200:/opt/samba/var/locks/sysvol/ # no MEU CASO onde a porta do ssh n\u00e3o \u00e1 a default. MEU dcslave usa 22200: rsync -Cravz -e \"ssh -p 22200\" /opt/samba/var/locks/sysvol/* root@192.168.70.200:/opt/samba/var/locks/sysvol/ chmod +x rsync-sysvol ./rsync-sysvol","title":"Criando script de sincroniza\u00e7\u00e3o com rsync do diret\u00f3rio 'sysvol' DO DCMASTER para envio ao dcslave (rode estes comando NO DCMASTER):"},{"location":"DC1_pacotes_compilados/#agendando-a-sincronizacao-no-cron-do-dcmaster","text":"crontab -e */5 * * * * root bash /opt/rsync-sysvol.sh --silent","title":"Agendando a sincroniza\u00e7\u00e3o no cron do dcmaster:"},{"location":"DC1_pacotes_compilados/#repita-o-processo-de-replicacao-do-sysvol-agora-no-dcslave-invertendo-os-apontamentos-de-ip-obviamente","text":"","title":"REPITA o processo de replica\u00e7\u00e3o do sysvol, agora NO DCSLAVE, INVERTENDO os apontamentos de ip, obviamente!"},{"location":"DC1_pacotes_compilados/#criando-script-de-sincronizacao-do-diretorio-sysvol-do-dcslave-para-envio-ao-dcmaster-rode-os-comando-agora-no-dcslave","text":"cd /opt vim rsync-sysvol.sh #!/bin/bash # Sincronizando Diretorios do Sysvol do dcmaster para envio ao dcslave: #rsync -Cravz /opt/samba/var/locks/sysvol/* root@192.168.70.250:/opt/samba/var/locks/sysvol/ # no MEU CASO onde a porta do ssh n\u00e3o \u00e1 a default. MEU dcmaster usa 22250: rsync -Cravz -e \"ssh -p 22250\" /opt/samba/var/locks/sysvol/* root@192.168.70.250:/opt/samba/var/locks/sysvol/ chmod +x rsync-sysvol ./rsync-sysvol","title":"Criando script de sincroniza\u00e7\u00e3o do diret\u00f3rio 'sysvol' DO DCSLAVE para envio ao dcmaster (rode os comando agora NO DCSLAVE):"},{"location":"DC1_pacotes_compilados/#agendando-a-sincronizacao-no-cron-do-dcslave","text":"crontab -e */5 * * * * root bash /opt/rsync-sysvol.sh --silent","title":"Agendando a sincroniza\u00e7\u00e3o no cron do dcslave:"},{"location":"DC1_pacotes_compilados/#as-estacoes-de-trabalho-usarao-como-dns-primario-o-pdc-emulator-do-dominio-e-como-dns-secundario-o-pdc-secundario-da-rede","text":"","title":"As Esta\u00e7\u00f5es de trabalho, usar\u00e3o, como DNS prim\u00e1rio o PDC Emulator do Dom\u00ednio, e como DNS secund\u00e1rio o PDC Secund\u00e1rio da rede."},{"location":"DC1_pacotes_compilados/#osync","text":"","title":"OSYNC"},{"location":"DC1_pacotes_compilados/#configurando-a-sincronizacao-da-pasta-sysvol-com-osync-que-vai-espelhar-os-dcs-rode-esses-comandos-no-dcmaster-primeiro","text":"cd /opt git clone https://github.com/deajan/osync.git cd osync sh ./install.sh","title":"Configurando a sincroniza\u00e7\u00e3o da pasta sysvol com osync, que vai espelhar os DCs (rode esses comandos NO DCMASTER, primeiro):"},{"location":"DC1_pacotes_compilados/#vai-criar-o-diretorio-etcosync","text":"","title":"Vai criar o diret\u00f3rio /etc/osync:"},{"location":"DC1_pacotes_compilados/#dentro-dele-vai-ter-o-arquivo-de-configuracao-syncconfexample-crie-um-arquivo-syncconf-e-cole-o-conteudo-abaixo","text":"vim /etc/osync/sync.conf #!/usr/bin/env bash INSTANCE_ID=\"sysvol_sync\" INITIATOR_SYNC_DIR=\"/opt/samba/var/locks/sysvol\" TARGET_SYNC_DIR=\"ssh://root@192.168.70.200:22200//opt/samba/var/locks/sysvol\" SSH_RSA_PRIVATE_KEY=\"/root/.ssh/id_rsa\" REMOTE_3RD_PARTY_HOSTS=\"\" PRESERVE_ACL=yes PRESERVE_XATTR=yes SOFT_DELETE=yes DESTINATION_MAILS=\"roor@localhost\" #REMOTE_RUN_AFTER_CMD=\"/opt/samba/bin/samba-tool ntacl sysvolreset\"","title":"Dentro dele vai ter o arquivo de configura\u00e7\u00e3o sync.conf.example. Crie um arquivo sync.conf e cole o conte\u00fado abaixo:"},{"location":"DC1_pacotes_compilados/#rodando-o-script-de-atualizacao-que-esta-dentro-do-optosync-apontando-pro-arquivo-etcosyncsyncconf","text":"./upgrade-v1.0x-v1.2x.sh /etc/osync/sync.conf","title":"rodando o script de atualiza\u00e7\u00e3o, que est\u00e1 dentro do /opt/osync, apontando pro arquivo /etc/osync/sync.conf:"},{"location":"DC1_pacotes_compilados/#vai-ficar-semelhante-ao-modelo-abaixo","text":"#!/usr/bin/env bash INSTANCE_ID=\"sysvol_sync\" INITIATOR_SYNC_DIR=\"/opt/samba/var/locks/sysvol\" TARGET_SYNC_DIR=\"ssh://root@192.168.70.200:22200//opt/samba/var/locks/sysvol\" SSH_RSA_PRIVATE_KEY=\"/root/.ssh/id_rsa\" SSH_PASSWORD_FILE=\"\" _REMOTE_TOKEN=\"SomeAlphaNumericToken9\" CREATE_DIRS=false LOGFILE=\"\" MINIMUM_SPACE=\"10240\" BANDWIDTH=\"0\" SUDO_EXEC=false RSYNC_EXECUTABLE=\"rsync\" RSYNC_REMOTE_PATH=\"\" RSYNC_PATTERN_FIRST=\"include\" RSYNC_INCLUDE_PATTERN=\"\" RSYNC_EXCLUDE_PATTERN=\"\" RSYNC_INCLUDE_FROM=\"\" RSYNC_EXCLUDE_FROM=\"\" PATH_SEPARATOR_CHAR=\";\" SSH_COMPRESSION=true SSH_IGNORE_KNOWN_HOSTS=false SSH_CONTROLMASTER=false REMOTE_HOST_PING=false","title":"Vai ficar semelhante ao modelo abaixo:"},{"location":"DC1_pacotes_compilados/#testando-o-sincronizmo-ignore-o-erro-de-email","text":"/usr/local/bin/osync.sh /etc/osync/sync.conf --dry --verbose","title":"Testando o sincronizmo (ignore o erro de email):"},{"location":"DC1_pacotes_compilados/#rodar-o-sincronizmo-de-fato","text":"/usr/local/bin/osync.sh /etc/osync/sync.conf --verbose","title":"Rodar o sincronizmo de fato:"},{"location":"DC1_pacotes_compilados/#agendar-no-cron","text":"crontab -e */5 * * * * root bash /usr/local/bin/osync.sh /etc/osync/sync.conf --silent","title":"Agendar no cron:"},{"location":"DC1_pacotes_compilados/#validando-os-logs-em-tempo-real-rode-o-usrlocalbinosyncsh-mantendo-outro-terminal-aberto-com-o-comando","text":"tail -f /var/log/osync.sysvol_sync.log","title":"Validando os logs em tempo real, rode o /usr/local/bin/osync.sh, mantendo outro terminal aberto com o comando:"},{"location":"DC1_pacotes_compilados/#invertendo-a-sincronizacao-com-o-osync-vamos-refazer-tudo-incluindo-o-ip-e-porta-ssh-agora-no-dcslave","text":"cd /opt git clone https://github.com/deajan/osync.git cd osync sh ./install.sh","title":"INVERTENDO a sincroniza\u00e7\u00e3o com o Osync, vamos refazer tudo, inclu\u00edndo o ip e porta ssh, agora NO DCSLAVE:"},{"location":"DC1_pacotes_compilados/#vai-criar-o-diretorio-etcosync_1","text":"","title":"Vai criar o diret\u00f3rio /etc/osync:"},{"location":"DC1_pacotes_compilados/#dentro-dele-vai-ter-o-arquivo-de-configuracao-syncconfexample-crie-um-arquivo-syncconf-e-cole-o-conteudo-abaixo_1","text":"#!/usr/bin/env bash INSTANCE_ID=\"sysvol_sync\" INITIATOR_SYNC_DIR=\"/opt/samba/var/locks/sysvol\" TARGET_SYNC_DIR=\"ssh://root@192.168.70.250:22250//opt/samba/var/locks/sysvol\" SSH_RSA_PRIVATE_KEY=\"/root/.ssh/id_rsa\" REMOTE_3RD_PARTY_HOSTS=\"\" PRESERVE_ACL=yes PRESERVE_XATTR=yes SOFT_DELETE=yes DESTINATION_MAILS=\"roor@localhost\" #REMOTE_RUN_AFTER_CMD=\"/opt/samba/bin/samba-tool ntacl sysvolreset\"","title":"Dentro dele vai ter o arquivo de configura\u00e7\u00e3o sync.conf.example. Crie um arquivo sync.conf e cole o conte\u00fado abaixo:"},{"location":"DC1_pacotes_compilados/#vai-precisa-configurar-seu-ip-e-o-path-pra-rodar-o-script-de-atualizacao-apontando-pro-arquivo-syncconf","text":"./upgrade-v1.0x-v1.2x.sh /etc/osync/sync.conf","title":"Vai precisa configurar seu ip e o path pra rodar o script de atualiza\u00e7\u00e3o, apontando pro arquivo sync.conf:"},{"location":"DC1_pacotes_compilados/#vai-ficar-semelhante-ao-modelo-abaixo_1","text":"#!/usr/bin/env bash INSTANCE_ID=\"sysvol_sync\" INITIATOR_SYNC_DIR=\"/opt/samba/var/locks/sysvol\" TARGET_SYNC_DIR=\"ssh://root@192.168.70.250:22250//opt/samba/var/locks/sysvol\" SSH_RSA_PRIVATE_KEY=\"/root/.ssh/id_rsa\" SSH_PASSWORD_FILE=\"\" _REMOTE_TOKEN=\"SomeAlphaNumericToken9\" CREATE_DIRS=false LOGFILE=\"\" MINIMUM_SPACE=\"10240\" BANDWIDTH=\"0\" SUDO_EXEC=false RSYNC_EXECUTABLE=\"rsync\" RSYNC_REMOTE_PATH=\"\" RSYNC_PATTERN_FIRST=\"include\" RSYNC_INCLUDE_PATTERN=\"\" RSYNC_EXCLUDE_PATTERN=\"\" RSYNC_INCLUDE_FROM=\"\" RSYNC_EXCLUDE_FROM=\"\" PATH_SEPARATOR_CHAR=\";\" SSH_COMPRESSION=true SSH_IGNORE_KNOWN_HOSTS=false SSH_CONTROLMASTER=false REMOTE_HOST_PING=false","title":"Vai ficar semelhante ao modelo abaixo:"},{"location":"DC1_pacotes_compilados/#testar-o-sincronizmo-ignore-o-erro-de-email","text":"/usr/local/bin/osync.sh /etc/osync/sync.conf --dry --verbose","title":"Testar o sincronizmo (ignore o erro de email):"},{"location":"DC1_pacotes_compilados/#rodar-o-sincronizmo-de-fato_1","text":"/usr/local/bin/osync.sh /etc/osync/sync.conf --verbose","title":"Rodar o sincronizmo de fato:"},{"location":"DC1_pacotes_compilados/#agendar-no-cron_1","text":"crontab -e */5 * * * * root bash /usr/local/bin/osync.sh /etc/osync/sync.conf --silent","title":"Agendar no cron:"},{"location":"DC1_pacotes_compilados/#validando-os-logs-em-tempo-real-rode-o-usrlocalbinosyncsh-mantendo-outro-terminal-aberto-com-o-comando_1","text":"tail -f /var/log/osync.sysvol_sync.log THAT\u2019S ALL FOLKS!!","title":"Validando os logs em tempo real, rode o /usr/local/bin/osync.sh, mantendo outro terminal aberto com o comando:"},{"location":"DC1_pacotes_compilados/#fileserver-com-samba4-no-debian-12","text":"","title":"FileServer com Samba4 no Debian 12"},{"location":"DC1_pacotes_compilados/#layout-de-rede-usado-no-laboratorio_2","text":"firewall 192.168.70.254 (enp1s0) - 192.168.122.254 (enp7s0) (ssh 2277) dcmaster 192.168.70.250 (ssh 22250) mkdocs 192.168.70.222 (ssh 22222) dcslave 192.168.70.200 (ssh 22200) fileserver 192.168.70.150 (ssh 22100) ; firewall Roteamento por Iptables ; dcmaster Controlador de Dom\u00ednio prim\u00e1rio ; mkdocs Servidor de Documentos ; dcslave Controlador de Dom\u00ednio secund\u00e1rio ; fileserver Servidor de Arquivos","title":"Layout de rede usado no laborat\u00f3rio:"},{"location":"DC1_pacotes_compilados/#instalando-as-dependencias-para-compilacao-do-codigo-fonte-do-samba4_2","text":"export DEBIAN_FRONTEND=noninteractive;apt-get update; apt-get install vim ntp net-tools rsync acl apt-utils attr autoconf bind9-utils binutils bison build-essential ntp rsync ccache chrpath curl debhelper bind9-dnsutils docbook-xml docbook-xsl flex gcc gdb git glusterfs-common gzip heimdal-multidev hostname htop krb5-config krb5-user lcov libacl1-dev libarchive-dev libattr1-dev libavahi-common-dev libblkid-dev libbsd-dev libcap-dev libcephfs-dev libcups2-dev libdbus-1-dev libglib2.0-dev libgnutls28-dev libgpgme-dev libicu-dev libjansson-dev libjs-jquery libjson-perl libkrb5-dev libldap2-dev liblmdb-dev libncurses-dev libpam0g-dev libparse-yapp-perl libpcap-dev libpopt-dev libreadline-dev libsystemd-dev libtasn1-bin libtasn1--5-dev libunwind-dev lmdb-utils locales lsb-release make mawk mingw-w64 patch perl perl-modules-5.40 pkg-config procps psmisc python3 python3-cryptography python3-dbg python3-dev python3-dnspython python3-gpg python3-iso8601 python3-markdown python3-matplotlib python3-pexpect python3-pyasn1 rsync sed tar tree uuid-dev wget xfslibs-dev xsltproc zlib1g-dev -y","title":"Instalando as depend\u00eancias para compila\u00e7\u00e3o do c\u00f3digo fonte do Samba4:"},{"location":"DC1_pacotes_compilados/#setando-e-validando-o-hostname-do-dcslave_1","text":"vim /etc/hostname fileserver hostname -f fileserver.officinas.edu","title":"Setando e validando o hostname do dcslave:"},{"location":"DC1_pacotes_compilados/#configurando-o-arquivo-de-hosts_2","text":"vim /etc/hosts .0.0.1 localhost 127.0.1.1 fileserver.officinas.edu fileserver 192.168.70.150 fileserver.officinas.edu fileserver 192.168.70.200 dcslave.officinas.edu dcslave 192.168.70.222 mkdocs.officinas.edu mkdocs 192.168.70.250 dcmaster.officinas.edu dcmaster 192.168.70.254 firewall.officinas.edu firewall","title":"Configurando o arquivo de hosts:"},{"location":"DC1_pacotes_compilados/#setando-ip-fixo-no-servidor-dcslave_1","text":"vim /etc/network/interfaces allow-hotplug enp1s0 iface enp1s0 inet static address 192.168.70.150 netmask 255.255.255.0 gateway 192.168.70.254","title":"Setando ip fixo no servidor dcslave:"},{"location":"DC1_pacotes_compilados/#apontando-o-endereco-do-resolvedor-de-nomes-principal-da-rede-pro-controlador-de-dominio-primario-dcmaster-temporario","text":"vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.250 #(dcmaster) nameserver 192.168.70.200 #(dcslave)","title":"Apontando o endere\u00e7o do resolvedor de nomes principal da rede pro Controlador de dom\u00ednio prim\u00e1rio, dcmaster (tempor\u00e1rio):"},{"location":"DC1_pacotes_compilados/#bloqueando-alteracao-do-resolvconf_1","text":"chattr +i /etc/resolv.conf","title":"Bloqueando altera\u00e7\u00e3o do resolv.conf:"},{"location":"DC1_pacotes_compilados/#validando-a-resolucao-de-nomes-pelo-dcmaster_1","text":"nslookup officinas.edu Server: 192.168.70.250 Address: 192.168.70.250#53 Name: officinas.edu Address: 192.168.70.250 Name: officinas.edu Address: 192.168.70.200","title":"Validando a resolu\u00e7\u00e3o de nomes pelo dcmaster:"},{"location":"DC1_pacotes_compilados/#relendo-as-configuracoes-de-rede_1","text":"systemctl restart networking","title":"Relendo as configura\u00e7\u00f5es de rede:"},{"location":"DC1_pacotes_compilados/#validando-o-ip-da-placa_2","text":"ip -c addr ip -br link","title":"Validando o ip da placa:"},{"location":"DC1_pacotes_compilados/#baixando-e-compilando-o-codigo-fonte-do-samba4_2","text":"wget https://download.samba.org/pub/samba/samba-4.19.4.tar.gz tar -xvzf samba-4.19.4.tar.gz cd samba-4.19.4 ./configure --prefix=/opt/samba make && make install","title":"Baixando e compilando o c\u00f3digo fonte do Samba4:"},{"location":"DC1_pacotes_compilados/#adicionando-optsamba-ao-path-padrao-do-linux-colando-a-linha-completa-ao-final-do-bashrc_2","text":"","title":"Adicionando /opt/Samba ao path padr\u00e3o do Linux, colando a linha completa ao final do .bashrc:"},{"location":"DC1_pacotes_compilados/#pathusrlocalsbinusrlocalbinusrsbinusrbinsbinbinoptsambabinoptsambasbin_2","text":"vim ~/.bashrc PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\"","title":"PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/samba/bin:/opt/samba/sbin\""},{"location":"DC1_pacotes_compilados/#relendo-o-arquivo-de-profile_2","text":"source ~/.bashrc","title":"Relendo o arquivo de profile:"},{"location":"DC1_pacotes_compilados/#criando-o-daemon-de-inicializacao-do-samba4-com-o-sistema_2","text":"vim /etc/systemd/system/samba-ad-dc.service [Unit] Description=Samba4 Active Directory Slave Domain Controller After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/samba -D PIDFile=/opt/samba/var/run/samba.pid [Install] WantedBy=multi-user.target chmod +x /etc/systemd/system/samba-ad-dc.service","title":"Criando o daemon de inicializa\u00e7\u00e3o do Samba4 com o sistema:"},{"location":"DC1_pacotes_compilados/#configurando-o-servico-de-sincronizacao-de-horario-apontando-pro-controlador-de-dominio-primario-dcmaster_1","text":"mv /etc/ntpsec/ntp.conf{,.orig} vim /etc/ntpsec/ntp.conf driftfile /var/lib/ntpsec/ntp.drift leapfile /usr/share/zoneinfo/leap-seconds.list tos minclock 4 minsane 3 pool 192.168.70.250 iburst #(dcmaster) restrict default kod nomodify nopeer noquery limited restrict 127.0.0.1 restrict ::1 tinker panic 0 #(Usado SOMENTE em VMs) systemctl restart ntp ntpq -p date","title":"Configurando o servi\u00e7o de sincroniza\u00e7\u00e3o de hor\u00e1rio, apontando pro Controlador de dom\u00ednio prim\u00e1rio, dcmaster:"},{"location":"DC1_pacotes_compilados/#atencao-nao-provisione-o-samba-do-fileserver","text":"","title":"ATEN\u00c7\u00c3O!! N\u00c3O PROVISIONE O SAMBA DO FILESERVER!!"},{"location":"DC1_pacotes_compilados/#atencao-nao-provisione-o-samba-do-fileserver_1","text":"","title":"ATEN\u00c7\u00c3O!! N\u00c3O PROVISIONE O SAMBA DO FILESERVER!!"},{"location":"DC1_pacotes_compilados/#_1","text":"","title":""},{"location":"DC1_pacotes_compilados/#configurando-o-etckrb5conf","text":"# vim /etc/krb5.conf [libdefaults] #(sem espa\u00e7o no canto dessa linha) dns_lookup_realm = false dns_lookup_kdc = true default_realm = OFFICINAS.EDU","title":"Configurando o /etc/krb5.conf:"},{"location":"DC1_pacotes_compilados/#configurando-o-time-server","text":"apt-get install ntp ntpdate -y nano /etc/ntpsec/ntp.conf # Rel\u00f3gio Local ( Nota: Este n\u00e3o \u00e9 o endere\u00e7o localhost! ) server 127.127.1.0 fudge 127.127.1.0 stratum 10 server 192.168.70.250 iburst prefer #(dcmaster) driftfile /var/lib/ntp/ntp.drift logfile /var/log/ntp restrict default ignore restrict 127.0.0.1 restrict 192.168.70.250 mask 255.255.255.255 nomodify notrap nopeer noquery systemctl restart ntp ntpq -p date","title":"Configurando o time server:"},{"location":"DC1_pacotes_compilados/#validando-mapeamentos","text":"getent hosts fileserver","title":"Validando mapeamentos:"},{"location":"DC1_pacotes_compilados/#configurando-o-smbconf","text":"# vim /opt/samba/etc/smb.conf # Define as informa\u00e7\u00f5es do dom\u00ednio. [global] workgroup = OFFICINAS realm = officinas.edu # Define que esse servidor n\u00e3o aceita acesso sem autentica\u00e7\u00e3o. security = ADS # Defique qual usu\u00e1rio no dom\u00ednio se equivale ao root. username map = /opt/samba/etc/user.map # Par\u00e2metros para que as permiss\u00f5es se comportem como o Windows. # Herdando permiss\u00f5es e guardando credenciais de logins bem-sucedidos. map acl inherit = yes store dos attributes = yes # Os VFS objects que ser\u00e3o usados. vfs objects = acl_xattr acl_tdb # Arquivo de configura\u00e7\u00e3o do kerberos e qual m\u00e9todo ser\u00e1 usado. dedicated keytab file = /etc/krb5.keytab kerberos method = secrets and keytab # Configura\u00e7\u00f5es do backend para mapeamento de IDs para compatibilidade com Windows. idmap config * : backend = tdb idmap config * : range = 3000-7999 idmap config OFFICINAS: backend = rid idmap config OFFICINAS: range = 10000-999999 # Define que o usu\u00e1rio root n\u00e3o precisa ser mapeado. min domain uid = 0 # Shell padr\u00e3o e diret\u00f3rio home padr\u00e3o. template shell = /bin/bash template homedir = /home/%U # Define o comportamento do Winbind. winbind refresh tickets = yes winbind use default domain = yes winbind enum users = yes winbind enum groups = yes winbind cache time = 7200 winbind nss info = rfc2307 # Cada escrita de dados ser\u00e1 seguida por um fsync() para garantir que os dados sejam gravados no disco. Usei em ext4 e xfs mas n\u00e3o testei no btrfs. sync always = yes strict sync = yes # Onde ser\u00e3o gravados os logs e o nivel de detalhes. log file = /var/log/samba/%m.log log level = 3 [FILESERVER] path = /home/fileserver comment = Compartilhamentos da Rede read only = No browseable = yes vfs objects = acl_xattr acl_tdb full_audit full_audit:success = renameat rewinddir unlinkat full_audit:prefix = %U|%I|%S full_audit:failure = none full_audit:facility = local4 full_audit:priority = alert # PAR\u00c2METROS USADOS NA AUDITORIA: # Adiciona todos os vfs objects. acl_xattr acl_tdb full_audit # arquivos renomeados, diret\u00f3rios renomeados, arquivos deletados. renameat rewinddir unlinkat # usu\u00e1rio, ip, a\u00e7\u00e3o. %U|%I|%S restart.samba o Samba instalado em /opt/samba/ pode n\u00e3o ter permiss\u00e3o para gravar diretamente em /var/log/samba mkdir -p /var/log/samba chown root:root /var/log/samba chmod 755 /var/log/samba Ou aponte para um diret\u00f3rio interno, como: log file = /opt/samba/var/logs/%m.log","title":"Configurando o smb.conf:"},{"location":"DC1_pacotes_compilados/#auditando-arquivos-deletados","text":"cat /var/log/syslog | grep unlinkat tail -f /var/log/syslog | grep unlinkat #(Teste em tempo real).","title":"Auditando arquivos deletados:"},{"location":"DC1_pacotes_compilados/#criando-o-diretorio-da-rede","text":"mkdir /home/fileserver chmod -R 0770 /home/fileserver chown -R root:\"domain admins\" /home/fileserver getfacl /home/fileserver","title":"Criando o diret\u00f3rio da rede:"},{"location":"DC1_pacotes_compilados/#extra-se-optar-por-uso-de-perfil-movel","text":"mkdir /opt/samba/var/lib/samba/profiles chmod -R 0770 /opt/samba/var/lib/samba/profiles chown -R root:\"domain admins\" /opt/samba/var/lib/samba/profiles","title":"EXTRA! SE optar por uso de perfil m\u00f3vel:"},{"location":"DC1_pacotes_compilados/#adicionando-o-path-do-optsambaetcsmbconf","text":"","title":"Adicionando o path do /opt/samba/etc/smb.conf:"},{"location":"DC1_pacotes_compilados/#linkando-as-bibliotecas-para-mapeamento-de-usuarios-de-sistema-local-e-samba4","text":"/opt/samba/sbin/smbd -b | grep LIBDIR ln -s /opt/samba/lib/libnss_winbind.so.2 /lib/x86-64-linux-gnu ln -s /lib/x86_64-linux-gnu/libnss_winbind.so.2 /lib/x86_64-linux-gnu/libnss_winbind.so ldconfig vim /etc/nsswitch.conf passwd: files winbind group: files winbind shadow: files","title":"Linkando as bibliotecas para mapeamento de usu\u00e1rios de sistema local e Samba4:"},{"location":"DC1_pacotes_compilados/#dando-poderes-de-root-ao-administrator_1","text":"nano /opt/samba/etc/user.map !root=officinas.edu\\Administrator","title":"Dando poderes de root ao Administrator:"},{"location":"DC1_pacotes_compilados/#criando-o-diretorio-de-logs","text":"mkdir /var/log/samba","title":"Criando o diret\u00f3rio de logs:"},{"location":"DC1_pacotes_compilados/#validando-a-troca-de-tickets-do-kerberos_2","text":"kinit Administrator klist","title":"Validando a troca de tickets do Kerberos:"},{"location":"DC1_pacotes_compilados/#ingressando-o-fileserver-ao-dominio","text":"net ads join -U Administrator","title":"Ingressando o Fileserver ao dom\u00ednio:"},{"location":"DC1_pacotes_compilados/#subindo-os-servicos-ao-boot-do-sistema","text":"/opt/samba/sbin/smbd && /opt/samba/sbin/nmbd && /opt/samba/sbin/winbindd","title":"Subindo os servi\u00e7os ao boot do Sistema:"},{"location":"DC1_pacotes_compilados/#adicionando-o-smbd-ao-boot-do-linux","text":"cd /etc/systemd/system vim smbd.service [Unit] Description=Samba SMBD FileServer After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/smbd PIDFile=/opt/samba/var/run/smbd.pid [Install] WantedBy=multi-user.target","title":"Adicionando o smbd ao boot do Linux:"},{"location":"DC1_pacotes_compilados/#adicionando-o-nmbd-ao-boot-do-linux","text":"cd /etc/systemd/system vim nmbd.service [Unit] Description=Samba NMBD FileServer After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/nmbd PIDFile=/opt/samba/var/run/nmbd.pid [Install] WantedBy=multi-user.target","title":"Adicionando o nmbd ao boot do Linux:"},{"location":"DC1_pacotes_compilados/#adicionando-o-nmbd-ao-boot-do-linux_1","text":"cd /etc/systemd/system vim winbindd.service [Unit] Description=Samba WINBIND FileServer After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/opt/samba/sbin/winbindd PIDFile=/opt/samba/var/run/winbindd.pid [Install] WantedBy=multi-user.target systemctl enable smbd.service nmbd.service winbindd.service pkill smb && pkill nmb && pkill winbind systemctl start smbd.service nmbd.service winbindd.service echo \"systemctl start smbd.service nmbd.service winbindd.service\" > /sbin/start.samba echo \"systemctl stop smbd.service nmbd.service winbindd.service\" > /sbin/stop.samba echo \"systemctl restart smbd.service nmbd.service winbindd.service\" > /sbin/restart.samba chmod +x /sbin/*.samba","title":"Adicionando o nmbd ao boot do Linux:"},{"location":"DC1_pacotes_compilados/#facilitando-o-boot-dos-servicos","text":"echo \"systemctl start smbd.service nmbd.service winbindd.service\" > /sbin/start.samba echo \"systemctl stop smbd.service nmbd.service winbindd.service\" > /sbin/stop.samba echo \"systemctl restart smbd.service nmbd.service winbindd.service\" > /sbin/restart.samba chmod +x /sbin/*.samba","title":"Facilitando o boot dos servi\u00e7os:"},{"location":"DC1_pacotes_compilados/#responde-agora-com","text":"start.samba, restart.samba e stop.samba","title":"Responde agora com:"},{"location":"DC1_pacotes_compilados/#validando-wbinfo-e-getent","text":"wbinfo --ping-dc wbinfo -u wbinfo -g getent passwd Administrator getent group \"domain admins\"","title":"Validando wbinfo e getent:"},{"location":"DC1_pacotes_compilados/#criando-o-script-de-backup-do-homefileserver","text":"mkdir /media/HDEXTERNO vim /opt/samba/bkpdiario.sh #!/bin/bash INICIO=`date +%d/%m/%Y-%H:%M:%S` LOG=/var/log/samba/bkpfileserver_`date +%Y-%m-%d`.txt echo \" \" >> $LOG echo \" \" >> $LOG echo \"|-----------------------------------------------\" >> $LOG echo \" Sincronizacao iniciada em $INICIO\" >> $LOG umount /media/HDEXTERNO mount /dev/sdb1 /media/HDEXTERNO rsync --delete -P -r -z -v /home/fileserver /media/HDEXTERNO/ >> $LOG FINAL=`date +%d/%m/%Y-%H:%M:%S` umount /media/HDEXTERNO echo \" Sincronizacao Finalizada em $FINAL\" >> $LOG echo \"|-----------------------------------------------\" >> $LOG echo \" \" >> $LOG echo \" \" >> $LOG","title":"Criando o script de backup do /home/fileserver:"},{"location":"DC1_pacotes_compilados/#adicionando-o-script-ao-crontab","text":"vim /etc/crontab # Rotinas de backup di\u00e1rio do SAMBA4. # Minuto/Hora/Dia/M\u00eas/Dia_semana/Usu\u00e1rio/Comando 45 23 * * 1-5 root /opt/samba/bkpdiario.sh > /dev/null 2>&1","title":"Adicionando o script ao crontab:"},{"location":"DC1_pacotes_compilados/#vai-montar-o-hd-externo-fazer-o-backup-e-desmontar-o-hd-externo","text":"THAT\u2019S ALL FOLKS!!","title":"VAI MONTAR O HD EXTERNO, FAZER O BACKUP E DESMONTAR O HD EXTERNO!"},{"location":"DC2_Rocky/","text":"\ud83d\udcc1 DC2 Rocky Controlador de Dom\u00ednio Secund\u00e1rio no Rocky Linux 9 Update do sistema: yum update -y && yum upgrade -y Instalar o editor de texto nano : dnf install nano Adicionar um usu\u00e1rio para que o mesmo seja utilizado como replicador do sysvol (backup do ad-dc DC1) useradd userdc2 Adicionar senha para o usu\u00e1rio criado: passwd userdc2 Insira uma senha para o usu\u00e1rio criado. Guarde a senha Verificar sua configura\u00e7\u00e3o de rede e DNS , bem como nome de dom\u00ednio . Uma das formas: Abra um terminal e chamar o nmtui : nmtui Selecione Editar uma conex\u00e3o . Ent\u00e3o a op\u00e7\u00e3o Editar . Verificar ou alterar seu endere\u00e7o ip e m\u00e1scara de sub-rede e seu Gateway . Na op\u00e7\u00e3o Servidor DNS : inserir PREFERENCIALMENTE o ip de seu Controlador de Dom\u00ednio Principal (seu DC1 ). N\u00e3o esquecer de inserir em Dom\u00ednios de pesquisa: seu.dom\u00ednio . V\u00e1 at\u00e9 o fim e selecione OK para salvar. Selecione Voltar e ent\u00e3o no menu, selecionar a op\u00e7\u00e3o: Definir nome de m\u00e1quina do sistema : dc2.seu.dominio. Agora selecione a op\u00e7\u00e3o: OK para salvar. Novamente selecione OK . Deve retornar para o terminal. Editar o arquivo /etc /host : nano /etc/hosts Inserir os dados referentes ao seu servidor de Controlador de Dom\u00ednio 2: 127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6 # inserir os dados de seu server 10.1.1.38 dc2 dc2.seu.dominio Salvar o arquivo Veririficar se existe algum processo do samba rodando: ps ax | egrep \"samba|smbd|nmbd|winbindd\" Remover qualquer configura\u00e7\u00e3o smb.conf que houver, checando com o comando: # smbd -b | grep \"CONFIGFILE\" CONFIGFILE: /usr/local/samba/etc/samba/smb.conf Remover todos arquivos de data base que houver. como .tdb * e .ldb *, listando com o comando: # smbd -b | egrep \"LOCKDIR|STATEDIR|CACHEDIR|PRIVATE_DIR\" LOCKDIR: /usr/local/samba/var/lock/ STATEDIR: /usr/local/samba/var/locks/ CACHEDIR: /usr/local/samba/var/cache/ PRIVATE_DIR: /usr/local/samba/private/ Remover o arquivo /etc/krb5.conf se houver, com o comando: rm /etc/krb5.conf Instalar plugins e habilitar reposit\u00f3rio PowerTools com os comandos abaixo: dnf install dnf-plugins-core dnf install epel-release dnf config-manager --set-enabled powertools dnf update Checar os reposit\u00f3rios adicionados com o comando: dnf repolist O resultado deve ser algo como: id do repo nome do repo appstream Rocky Linux 8 - AppStream baseos Rocky Linux 8 - BaseOS devel Rocky Linux 8 - Devel WARNING! FOR BUILDROOT AND KOJI USE - epel Extra Packages for Enterprise Linux 8 - x86_64 - extras Rocky Linux 8 - Extras - powertools Rocky Linux 8 - PowerTools Setar a hora local: Listando as op\u00e7\u00f5es de hora local. timedatectl list-timezones Para setar o timezone desejado, usar o comando: timedatectl set-timezone America/Sao_Paulo Verificando o timezone setado: timedatectl Local time: qua 2023-04-12 09:04:22 -03 Universal time: qua 2023-04-12 12:04:22 UTC RTC time: qua 2023-04-12 12:00:16 Time zone: America/Sao_Paulo (-03, -0300) System clock synchronized: yes NTP service: active RTC in local TZ: no Instalar as depend\u00eancias dos pacotes para instalar e compilar o samba AD-DC . No terminal fazer um arquivo do tipo script execut\u00e1vel e inserir os comandos: nano depende.sh Inserir os comandos: set -xueo pipefail yum update -y yum install -y dnf-plugins-core yum install -y epel-release yum -v repolist all yum config-manager --set-enabled PowerTools -y || \\ yum config-manager --set-enabled powertools -y yum config-manager --set-enabled Devel -y || \\ yum config-manager --set-enabled devel -y yum update -y yum install -y \\ --setopt=install_weak_deps=False \\ \"@Development Tools\" \\ acl \\ attr \\ autoconf \\ avahi-devel \\ bind-utils \\ binutils \\ bison \\ ccache \\ chrpath \\ cups-devel \\ curl \\ dbus-devel \\ docbook-dtds \\ docbook-style-xsl \\ flex \\ gawk \\ gcc \\ gdb \\ git \\ glib2-devel \\ glibc-common \\ glibc-langpack-en \\ glusterfs-api-devel \\ glusterfs-devel \\ gnutls-devel \\ gpgme-devel \\ gzip \\ hostname \\ htop \\ jansson-devel \\ keyutils-libs-devel \\ krb5-devel \\ krb5-server \\ libacl-devel \\ libarchive-devel \\ libattr-devel \\ libblkid-devel \\ libbsd-devel \\ libcap-devel \\ libcephfs-devel \\ libicu-devel \\ libnsl2-devel \\ libpcap-devel \\ libtasn1-devel \\ libtasn1-tools \\ libtirpc-devel \\ libunwind-devel \\ libuuid-devel \\ libxslt \\ lmdb \\ lmdb-devel \\ make \\ mingw64-gcc \\ ncurses-devel \\ openldap-devel \\ pam-devel \\ patch \\ perl \\ perl-Archive-Tar \\ perl-ExtUtils-MakeMaker \\ perl-JSON \\ perl-Parse-Yapp \\ perl-Test-Simple \\ perl-generators \\ perl-interpreter \\ pkgconfig \\ popt-devel \\ procps-ng \\ psmisc \\ python3 \\ python3-cryptography \\ python3-devel \\ python3-dns \\ python3-gpg \\ python3-iso8601 \\ python3-libsemanage \\ python3-markdown \\ python3-policycoreutils \\ python3-pyasn1 \\ python3-setproctitle \\ quota-devel \\ readline-devel \\ redhat-lsb \\ rng-tools \\ rpcgen \\ rpcsvc-proto-devel \\ rsync \\ sed \\ sudo \\ systemd-devel \\ tar \\ tree \\ wget \\ which \\ xfsprogs-devel \\ yum-utils \\ zlib-devel \\ nano \\ krb5-workstation \\ yum clean all Salvar o arquivo Transformar o arquivo em um execut\u00e1vel: chmod +x depende.sh Executar o aquivo com o comando: ./depende.sh Fazer download da \u00faltima vers\u00e3o do samba com o comando: wget https://download.samba.org/pub/samba/stable/samba-4.18.0.tar.gz Descompcatar o arquivo baixado com o comando: tar -zxvf samba-nome-arquivo Mudar para o diret\u00f3rio onde foi descompactado: cd samba-nome-arquivo/ Compilar o samba para que o arquivo de configua\u00e7\u00e3o smb.conf ficar em: /etc/samba/smb.conf : ./configure --sysconfdir=/etc/samba/ Aguarde o procedimento terminar. Executar make e make install: make && make install Fazer com que o comando samba-tool possa ser chamado na ra\u00edz do sistema. No diret\u00f3rio /root editar o arquivo .bash_profile: nano .bash_profile E inserir a linha: # User specific environment and startup programs PATH=$PATH:$HOME/bin #ESTA LINHA: PATH=/usr/local/samba/bin/:/usr/local/samba/sbin/:$PATH export PATH Salvar o arquivo Criar um arquivo de servi\u00e7o systemd. Executar os comandos: # systemctl mask smbd nmbd winbind # systemctl disable smbd nmbd winbind Criar o arquivo em /etc/systemd/system/samba-ad-dc.service nano /etc/systemd/system/samba-ad-dc.service Com as seguintes linhas: [Unit] Description=Samba Active Directory Domain Controller After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/usr/local/samba/sbin/samba -D PIDFile=/usr/local/samba/var/run/samba.pid ExecReload=/bin/kill -HUP $MAINPID [Install] WantedBy=multi-user.target Salvar o arquivo Recarrregar o systemd com o comando: systemctl daemon-reload Habilitar o samba-ad-dc para iniciar no boot do sistema: systemctl enable samba-ad-dc Reestart o servi\u00e7o do samba-ad-dc com o comando: systemctl restart samba-ad-dc Para parar servi\u00e7o fazer o comando: systemctl stop samba-ad-dc Se necessitar desabilitar o servi\u00e7o, utilizar o comando: systemctl disable samba-ad-dc Configurar o Firewall Adicionar servi\u00e7os: firewall-cmd --add-service={dns,ldap,ldaps,kerberos} Adicionar portas: firewall-cmd --add-port={389/udp,135/tcp,135/udp,138/udp,138/tcp,137/tcp,137/udp,139/udp,139/tcp,445/tcp,445/udp,3268/udp,3268/tcp,3269/tcp,3269/udp,49152/tcp} Recarregar o Firewall: firewall-cmd --reload Copiar o arquivo krb5.conf para o diret\u00f3rio /etc : cp /usr/local/samba/private/krb5.conf /etc/krb5.conf Executar o comando testparm para verifica\u00e7\u00e3o de erros de sintaxe: testparm A sa\u00edda do comando pode ser parecido com essa: Load smb config files from /etc/samba/smb.conf Loaded services file OK. Weak crypto is allowed Server role: ROLE_DOMAIN_MEMBER Press enter to see a dump of your service definitions Reinciar o samba ad-dc smbcontrol all reload-config Juntando-se ao Active Directory (DC1) a partir do ( DC2 ) = controlador de dominio 2. Substitua seu.dom\u00ednio para seus dados: samba-tool domain join seu.dominio DC -Uadministrator --realm=seu.dominio Com o comando acima o DC2 deve juntar-se ao DC1. THAT\u2019S ALL FOLKS!!","title":"\ud83d\udcc1 DC2 Rocky"},{"location":"DC2_Rocky/#dc2-rocky","text":"","title":"\ud83d\udcc1 DC2 Rocky"},{"location":"DC2_Rocky/#controlador-de-dominio-secundario-no-rocky-linux-9","text":"Update do sistema: yum update -y && yum upgrade -y Instalar o editor de texto nano : dnf install nano Adicionar um usu\u00e1rio para que o mesmo seja utilizado como replicador do sysvol (backup do ad-dc DC1) useradd userdc2 Adicionar senha para o usu\u00e1rio criado: passwd userdc2 Insira uma senha para o usu\u00e1rio criado. Guarde a senha Verificar sua configura\u00e7\u00e3o de rede e DNS , bem como nome de dom\u00ednio . Uma das formas: Abra um terminal e chamar o nmtui : nmtui Selecione Editar uma conex\u00e3o . Ent\u00e3o a op\u00e7\u00e3o Editar . Verificar ou alterar seu endere\u00e7o ip e m\u00e1scara de sub-rede e seu Gateway . Na op\u00e7\u00e3o Servidor DNS : inserir PREFERENCIALMENTE o ip de seu Controlador de Dom\u00ednio Principal (seu DC1 ). N\u00e3o esquecer de inserir em Dom\u00ednios de pesquisa: seu.dom\u00ednio . V\u00e1 at\u00e9 o fim e selecione OK para salvar. Selecione Voltar e ent\u00e3o no menu, selecionar a op\u00e7\u00e3o: Definir nome de m\u00e1quina do sistema : dc2.seu.dominio. Agora selecione a op\u00e7\u00e3o: OK para salvar. Novamente selecione OK . Deve retornar para o terminal. Editar o arquivo /etc /host : nano /etc/hosts Inserir os dados referentes ao seu servidor de Controlador de Dom\u00ednio 2: 127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6 # inserir os dados de seu server 10.1.1.38 dc2 dc2.seu.dominio Salvar o arquivo Veririficar se existe algum processo do samba rodando: ps ax | egrep \"samba|smbd|nmbd|winbindd\" Remover qualquer configura\u00e7\u00e3o smb.conf que houver, checando com o comando: # smbd -b | grep \"CONFIGFILE\" CONFIGFILE: /usr/local/samba/etc/samba/smb.conf Remover todos arquivos de data base que houver. como .tdb * e .ldb *, listando com o comando: # smbd -b | egrep \"LOCKDIR|STATEDIR|CACHEDIR|PRIVATE_DIR\" LOCKDIR: /usr/local/samba/var/lock/ STATEDIR: /usr/local/samba/var/locks/ CACHEDIR: /usr/local/samba/var/cache/ PRIVATE_DIR: /usr/local/samba/private/ Remover o arquivo /etc/krb5.conf se houver, com o comando: rm /etc/krb5.conf Instalar plugins e habilitar reposit\u00f3rio PowerTools com os comandos abaixo: dnf install dnf-plugins-core dnf install epel-release dnf config-manager --set-enabled powertools dnf update Checar os reposit\u00f3rios adicionados com o comando: dnf repolist O resultado deve ser algo como: id do repo nome do repo appstream Rocky Linux 8 - AppStream baseos Rocky Linux 8 - BaseOS devel Rocky Linux 8 - Devel WARNING! FOR BUILDROOT AND KOJI USE - epel Extra Packages for Enterprise Linux 8 - x86_64 - extras Rocky Linux 8 - Extras - powertools Rocky Linux 8 - PowerTools","title":"Controlador de Dom\u00ednio Secund\u00e1rio no Rocky Linux 9"},{"location":"DC2_Rocky/#setar-a-hora-local","text":"Listando as op\u00e7\u00f5es de hora local. timedatectl list-timezones Para setar o timezone desejado, usar o comando: timedatectl set-timezone America/Sao_Paulo Verificando o timezone setado: timedatectl Local time: qua 2023-04-12 09:04:22 -03 Universal time: qua 2023-04-12 12:04:22 UTC RTC time: qua 2023-04-12 12:00:16 Time zone: America/Sao_Paulo (-03, -0300) System clock synchronized: yes NTP service: active RTC in local TZ: no Instalar as depend\u00eancias dos pacotes para instalar e compilar o samba AD-DC . No terminal fazer um arquivo do tipo script execut\u00e1vel e inserir os comandos: nano depende.sh Inserir os comandos: set -xueo pipefail yum update -y yum install -y dnf-plugins-core yum install -y epel-release yum -v repolist all yum config-manager --set-enabled PowerTools -y || \\ yum config-manager --set-enabled powertools -y yum config-manager --set-enabled Devel -y || \\ yum config-manager --set-enabled devel -y yum update -y yum install -y \\ --setopt=install_weak_deps=False \\ \"@Development Tools\" \\ acl \\ attr \\ autoconf \\ avahi-devel \\ bind-utils \\ binutils \\ bison \\ ccache \\ chrpath \\ cups-devel \\ curl \\ dbus-devel \\ docbook-dtds \\ docbook-style-xsl \\ flex \\ gawk \\ gcc \\ gdb \\ git \\ glib2-devel \\ glibc-common \\ glibc-langpack-en \\ glusterfs-api-devel \\ glusterfs-devel \\ gnutls-devel \\ gpgme-devel \\ gzip \\ hostname \\ htop \\ jansson-devel \\ keyutils-libs-devel \\ krb5-devel \\ krb5-server \\ libacl-devel \\ libarchive-devel \\ libattr-devel \\ libblkid-devel \\ libbsd-devel \\ libcap-devel \\ libcephfs-devel \\ libicu-devel \\ libnsl2-devel \\ libpcap-devel \\ libtasn1-devel \\ libtasn1-tools \\ libtirpc-devel \\ libunwind-devel \\ libuuid-devel \\ libxslt \\ lmdb \\ lmdb-devel \\ make \\ mingw64-gcc \\ ncurses-devel \\ openldap-devel \\ pam-devel \\ patch \\ perl \\ perl-Archive-Tar \\ perl-ExtUtils-MakeMaker \\ perl-JSON \\ perl-Parse-Yapp \\ perl-Test-Simple \\ perl-generators \\ perl-interpreter \\ pkgconfig \\ popt-devel \\ procps-ng \\ psmisc \\ python3 \\ python3-cryptography \\ python3-devel \\ python3-dns \\ python3-gpg \\ python3-iso8601 \\ python3-libsemanage \\ python3-markdown \\ python3-policycoreutils \\ python3-pyasn1 \\ python3-setproctitle \\ quota-devel \\ readline-devel \\ redhat-lsb \\ rng-tools \\ rpcgen \\ rpcsvc-proto-devel \\ rsync \\ sed \\ sudo \\ systemd-devel \\ tar \\ tree \\ wget \\ which \\ xfsprogs-devel \\ yum-utils \\ zlib-devel \\ nano \\ krb5-workstation \\ yum clean all Salvar o arquivo Transformar o arquivo em um execut\u00e1vel: chmod +x depende.sh Executar o aquivo com o comando: ./depende.sh Fazer download da \u00faltima vers\u00e3o do samba com o comando: wget https://download.samba.org/pub/samba/stable/samba-4.18.0.tar.gz Descompcatar o arquivo baixado com o comando: tar -zxvf samba-nome-arquivo Mudar para o diret\u00f3rio onde foi descompactado: cd samba-nome-arquivo/ Compilar o samba para que o arquivo de configua\u00e7\u00e3o smb.conf ficar em: /etc/samba/smb.conf : ./configure --sysconfdir=/etc/samba/ Aguarde o procedimento terminar. Executar make e make install: make && make install Fazer com que o comando samba-tool possa ser chamado na ra\u00edz do sistema. No diret\u00f3rio /root editar o arquivo .bash_profile: nano .bash_profile E inserir a linha: # User specific environment and startup programs PATH=$PATH:$HOME/bin #ESTA LINHA: PATH=/usr/local/samba/bin/:/usr/local/samba/sbin/:$PATH export PATH Salvar o arquivo","title":"Setar a hora local:"},{"location":"DC2_Rocky/#criar-um-arquivo-de-servico-systemd","text":"Executar os comandos: # systemctl mask smbd nmbd winbind # systemctl disable smbd nmbd winbind Criar o arquivo em /etc/systemd/system/samba-ad-dc.service nano /etc/systemd/system/samba-ad-dc.service Com as seguintes linhas: [Unit] Description=Samba Active Directory Domain Controller After=network.target remote-fs.target nss-lookup.target [Service] Type=forking ExecStart=/usr/local/samba/sbin/samba -D PIDFile=/usr/local/samba/var/run/samba.pid ExecReload=/bin/kill -HUP $MAINPID [Install] WantedBy=multi-user.target Salvar o arquivo Recarrregar o systemd com o comando: systemctl daemon-reload Habilitar o samba-ad-dc para iniciar no boot do sistema: systemctl enable samba-ad-dc Reestart o servi\u00e7o do samba-ad-dc com o comando: systemctl restart samba-ad-dc Para parar servi\u00e7o fazer o comando: systemctl stop samba-ad-dc Se necessitar desabilitar o servi\u00e7o, utilizar o comando: systemctl disable samba-ad-dc","title":"Criar um arquivo de servi\u00e7o systemd."},{"location":"DC2_Rocky/#configurar-o-firewall","text":"Adicionar servi\u00e7os: firewall-cmd --add-service={dns,ldap,ldaps,kerberos} Adicionar portas: firewall-cmd --add-port={389/udp,135/tcp,135/udp,138/udp,138/tcp,137/tcp,137/udp,139/udp,139/tcp,445/tcp,445/udp,3268/udp,3268/tcp,3269/tcp,3269/udp,49152/tcp} Recarregar o Firewall: firewall-cmd --reload Copiar o arquivo krb5.conf para o diret\u00f3rio /etc : cp /usr/local/samba/private/krb5.conf /etc/krb5.conf Executar o comando testparm para verifica\u00e7\u00e3o de erros de sintaxe: testparm A sa\u00edda do comando pode ser parecido com essa: Load smb config files from /etc/samba/smb.conf Loaded services file OK. Weak crypto is allowed Server role: ROLE_DOMAIN_MEMBER Press enter to see a dump of your service definitions Reinciar o samba ad-dc smbcontrol all reload-config Juntando-se ao Active Directory (DC1) a partir do ( DC2 ) = controlador de dominio 2. Substitua seu.dom\u00ednio para seus dados: samba-tool domain join seu.dominio DC -Uadministrator --realm=seu.dominio Com o comando acima o DC2 deve juntar-se ao DC1. THAT\u2019S ALL FOLKS!!","title":"Configurar o Firewall"},{"location":"DHCP_Server/","text":"\ud83d\udcc1 DHCP Server Criando um Servidor de DHCP A INSTALA\u00c7\u00c3O A SEGUIR SE DAR\u00c1 NA M\u00c1QUINA DO PR\u00d3PRIO FIREWALL! Vamos a instala\u00e7\u00e3o do pacote do DHCP Server: apt-get install isc-dhcp-server Agora vamos definir a interface que vai escutar o servidor de DHCP (enp7s0): vim /etc/default/isc-dhcp-server INTERFACESv4=\u201denp7s0\u2033 Backup do arquivo original: mv /etc/dhcp/dhcpd.conf{,.orig} vim /etc/dhcp/dhcpd.conf # NOME DE DOM\u00cdNIO: option domain-name \"officinas.edu.\"; # IP DO SERVIDOR DE DNS DA REDE (Separar por v\u00edrgula SEM espa\u00e7o): option domain-name-servers 192.168.70.254,1.1.1.1; # GATEWAY PADR\u00c3O: option routers 192.168.70.254; # DEFINI\u00c7\u00c3O DE HOR\u00c1RIO DA REDE (18000=BR): option time-offset -18000; # TEMPO DE RENOVA\u00c7\u00c3O DOS ENDERE\u00c7OS IPS POR INATIVIDADE (600=10MIN): default-lease-time 600; # TEMPO M\u00c1XIMO DE USO DE UM IP EM UMA M\u00c1QUINA DA REDE: max-lease-time 7200; # DEFINE SE O DHCPD INSERE DIN\u00c2MICAMENTE UM NOVO REGISTRO DE M\u00c1QUINA NO DNS SERVER AO FORNECER UM IP: ddns-update-style none; # INDICA QUE O SERVIDOR DE DHCP SER\u00c1 AUTORITATIVO SEMPRE: authoritative; # GERENCIAMENTO DE LOGS: log-facility local7; # RANGE DE GERENCIAMENTO DE IPS: subnet 192.168.70.0 netmask 255.255.255.0 { range 192.168.70.10 192.168.70.20; option routers 192.168.70.254; } # IPS FIXOS POR MAC ADDRESS: host vmwin10 { hardware ethernet 52:54:00:C7:85:A9; fixed-address 192.168.70.171; } host PC_Gerente { hardware ethernet 52:54:00:bf:17:be; fixed-address 192.168.70.111; } Agora vamos reiniciar o servi\u00e7o: systemctl restart isc-dhcp-server EXTRA: Para trabalhar com m\u00faltiplas redes, adicionar ao /etc/default/isc-dhcp-server: shared-network rede-almoxarifado { subnet 172.16.254.0 netmask 255.255.255.0 { range 172.16.254.20 172.16.254.100; option routers 172.16.254.1; option domain-name-servers 8.8.8.8, 8.8.4.4; option broadcast-address 172.16.254.255; } # Sub-Rede adicional qual entrego apenas ips para os mac x e y: subnet 10.0.0.240 netmask 255.255.255.240 { option routers 10.0.0.241; option domain-name-servers 8.8.8.8, 8.8.4.4; option broadcast-address 10.0.0.255; host pc1 { hardware ethernet 70:71:BC:F1:9F:9E; fixed-address 10.0.0.242; } host pc2 { hardware ethernet 70:71:BC:F1:9F:1D; fixed-address 10.0.0.243; } host cel1 { hardware ethernet 08:00:27:18:DC:AA; fixed-address 10.0.0.244; } } } Instale o pacote ieee-data para buscar o fabricante dos dispositivos (manufacturer) com base no MAC: apt install ieee-data Crie os aliases dos arquivos para os diret\u00f3rios espec\u00edfios: ln -s /usr/share/ieee-data/oui.txt /usr/share/misc/oui.txt ln -s /usr/share/ieee-data/oui.txt /usr/local/etc/oui.txt Imprime as concess\u00f5es DHCP ativas: dhcp-lease-list MAC IP hostname valid until manufacturer 00:06:14:74:2a:5d 10.0.0.100 -NA- 2020-09-16 13:44:02 Furukawa Para uma sa\u00edda leg\u00edvel por m\u00e1quina com datas completas: dhcp-lease-list --parsable imprime o \u00faltimo MAC: dhcp-lease-list --last imprime todas as entradas, ou seja, mais de um por MAC: dhcp-lease-list --all Validar as loca\u00e7\u00f5es dhcpd: cat /var/lib/dhcp/dhcpd.leases lease 10.0.0.100 { starts 3 2020/09/16 14:06:33; ends 3 2020/09/16 14:11:33; cltt 3 2020/09/16 14:06:33; binding state active; next binding state free; rewind binding state free; hardware ethernet 00:06:14:74:2a:5d; } that's all folks!","title":"\ud83d\udcc1 DHCP Server"},{"location":"DHCP_Server/#dhcp-server","text":"","title":"\ud83d\udcc1 DHCP Server"},{"location":"DHCP_Server/#criando-um-servidor-de-dhcp","text":"A INSTALA\u00c7\u00c3O A SEGUIR SE DAR\u00c1 NA M\u00c1QUINA DO PR\u00d3PRIO FIREWALL!","title":"Criando um Servidor de DHCP"},{"location":"DHCP_Server/#vamos-a-instalacao-do-pacote-do-dhcp-server","text":"apt-get install isc-dhcp-server","title":"Vamos a instala\u00e7\u00e3o do pacote do DHCP Server:"},{"location":"DHCP_Server/#agora-vamos-definir-a-interface-que-vai-escutar-o-servidor-de-dhcp-enp7s0","text":"vim /etc/default/isc-dhcp-server INTERFACESv4=\u201denp7s0\u2033","title":"Agora vamos definir a interface que vai escutar o servidor de DHCP (enp7s0):"},{"location":"DHCP_Server/#backup-do-arquivo-original","text":"mv /etc/dhcp/dhcpd.conf{,.orig} vim /etc/dhcp/dhcpd.conf # NOME DE DOM\u00cdNIO: option domain-name \"officinas.edu.\"; # IP DO SERVIDOR DE DNS DA REDE (Separar por v\u00edrgula SEM espa\u00e7o): option domain-name-servers 192.168.70.254,1.1.1.1; # GATEWAY PADR\u00c3O: option routers 192.168.70.254; # DEFINI\u00c7\u00c3O DE HOR\u00c1RIO DA REDE (18000=BR): option time-offset -18000; # TEMPO DE RENOVA\u00c7\u00c3O DOS ENDERE\u00c7OS IPS POR INATIVIDADE (600=10MIN): default-lease-time 600; # TEMPO M\u00c1XIMO DE USO DE UM IP EM UMA M\u00c1QUINA DA REDE: max-lease-time 7200; # DEFINE SE O DHCPD INSERE DIN\u00c2MICAMENTE UM NOVO REGISTRO DE M\u00c1QUINA NO DNS SERVER AO FORNECER UM IP: ddns-update-style none; # INDICA QUE O SERVIDOR DE DHCP SER\u00c1 AUTORITATIVO SEMPRE: authoritative; # GERENCIAMENTO DE LOGS: log-facility local7; # RANGE DE GERENCIAMENTO DE IPS: subnet 192.168.70.0 netmask 255.255.255.0 { range 192.168.70.10 192.168.70.20; option routers 192.168.70.254; } # IPS FIXOS POR MAC ADDRESS: host vmwin10 { hardware ethernet 52:54:00:C7:85:A9; fixed-address 192.168.70.171; } host PC_Gerente { hardware ethernet 52:54:00:bf:17:be; fixed-address 192.168.70.111; }","title":"Backup do arquivo original:"},{"location":"DHCP_Server/#agora-vamos-reiniciar-o-servico","text":"systemctl restart isc-dhcp-server","title":"Agora vamos reiniciar o servi\u00e7o:"},{"location":"DHCP_Server/#extra-para-trabalhar-com-multiplas-redes-adicionar-ao-etcdefaultisc-dhcp-server","text":"shared-network rede-almoxarifado { subnet 172.16.254.0 netmask 255.255.255.0 { range 172.16.254.20 172.16.254.100; option routers 172.16.254.1; option domain-name-servers 8.8.8.8, 8.8.4.4; option broadcast-address 172.16.254.255; } # Sub-Rede adicional qual entrego apenas ips para os mac x e y: subnet 10.0.0.240 netmask 255.255.255.240 { option routers 10.0.0.241; option domain-name-servers 8.8.8.8, 8.8.4.4; option broadcast-address 10.0.0.255; host pc1 { hardware ethernet 70:71:BC:F1:9F:9E; fixed-address 10.0.0.242; } host pc2 { hardware ethernet 70:71:BC:F1:9F:1D; fixed-address 10.0.0.243; } host cel1 { hardware ethernet 08:00:27:18:DC:AA; fixed-address 10.0.0.244; } } }","title":"EXTRA: Para trabalhar com m\u00faltiplas redes, adicionar ao /etc/default/isc-dhcp-server:"},{"location":"DHCP_Server/#instale-o-pacote-ieee-data-para-buscar-o-fabricante-dos-dispositivos-manufacturer-com-base-no-mac","text":"apt install ieee-data","title":"Instale o pacote ieee-data para buscar o fabricante dos dispositivos (manufacturer) com base no MAC:"},{"location":"DHCP_Server/#crie-os-aliases-dos-arquivos-para-os-diretorios-especifios","text":"ln -s /usr/share/ieee-data/oui.txt /usr/share/misc/oui.txt ln -s /usr/share/ieee-data/oui.txt /usr/local/etc/oui.txt","title":"Crie os aliases dos arquivos para os diret\u00f3rios espec\u00edfios:"},{"location":"DHCP_Server/#imprime-as-concessoes-dhcp-ativas","text":"dhcp-lease-list MAC IP hostname valid until manufacturer 00:06:14:74:2a:5d 10.0.0.100 -NA- 2020-09-16 13:44:02 Furukawa","title":"Imprime as concess\u00f5es DHCP ativas:"},{"location":"DHCP_Server/#para-uma-saida-legivel-por-maquina-com-datas-completas","text":"dhcp-lease-list --parsable","title":"Para uma sa\u00edda leg\u00edvel por m\u00e1quina com datas completas:"},{"location":"DHCP_Server/#imprime-o-ultimo-mac","text":"dhcp-lease-list --last","title":"imprime o \u00faltimo MAC:"},{"location":"DHCP_Server/#imprime-todas-as-entradas-ou-seja-mais-de-um-por-mac","text":"dhcp-lease-list --all","title":"imprime todas as entradas, ou seja, mais de um por MAC:"},{"location":"DHCP_Server/#validar-as-locacoes-dhcpd","text":"cat /var/lib/dhcp/dhcpd.leases lease 10.0.0.100 { starts 3 2020/09/16 14:06:33; ends 3 2020/09/16 14:11:33; cltt 3 2020/09/16 14:06:33; binding state active; next binding state free; rewind binding state free; hardware ethernet 00:06:14:74:2a:5d; } that's all folks!","title":"Validar as loca\u00e7\u00f5es dhcpd:"},{"location":"DNS_Server/","text":"\ud83d\udcc1 DNS Server Criando um Servidor de DNS A INSTALA\u00c7\u00c3O A SEGUIR SE DAR\u00c1 NA M\u00c1QUINA DO PR\u00d3PRIO FIREWALL! Instalar os pacotes necess\u00e1rios: apt-get install bind9 openssh-server dnsutils Editar o arquivo /etc/default/named e deixa-lo como no exemplo: # run resolvconf? RESOLVCONF=no # startup options for the server OPTIONS=\"-u bind -4\" O arquivo /etc/bind/named.conf fica sem altera\u00e7\u00e3o: // This is the primary configuration file for the BIND DNS server named. // // Please read /usr/share/doc/bind9/README.Debian.gz for information on the // structure of BIND configuration files in Debian, *BEFORE* you customize // this configuration file. // // If you are just adding zones, please do that in /etc/bind/named.conf.local include \"/etc/bind/named.conf.options\"; include \"/etc/bind/named.conf.local\"; include \"/etc/bind/named.conf.default-zones\"; O arquivo /etc/bind/named.conf.local tb\u00e9m fica sem altera\u00e7\u00e3o: // // Do any local configuration here // // Consider adding the 1918 zones here, if they are not used in your // organization //include \"/etc/bind/zones.rfc1918\"; Entrar em /etc/bind: cd /etc/bind Fazer um backup do arquivo original: cp named.conf.default-zones{,.orig} Editar named.conf.default-zones e deixa-lo como no exemplo: vim named.conf.default-zones // prime the server with knowledge of the root servers zone \".\" { type hint; file \"/usr/share/dns/root.hints\"; }; // be authoritative for the localhost forward and reverse zones, and for // broadcast zones as per RFC 1912 zone \"localhost\" { type master; file \"/etc/bind/db.local\"; }; zone \"127.in-addr.arpa\" { type master; file \"/etc/bind/db.127\"; }; zone \"0.in-addr.arpa\" { type master; file \"/etc/bind/db.0\"; }; zone \"255.in-addr.arpa\" { type master; file \"/etc/bind/db.255\"; }; zone \"officinas.edu\" { type master; file \"/etc/bind/zones/db.officinas.edu\"; }; zone \"70.168.192.in-addr.arpa\" { type master; file \"/etc/bind/zones/db.70.168.192\"; }; Criar/ editar o Arquivo named.conf.options: vim named.conf.options // CRIANDO REGRAS DE LIBERA\u00c7\u00c3O: acl interna { 127.0.0.0/8; 192.168.70.0/24; }; options { directory \"/var/cache/bind\"; // CRIANDO RECURSIVIDADE DA MINHA ACL NA \u00c1RVORE HIER\u00c1RQUICA: recursion yes; allow-query { interna; }; allow-recursion { interna; }; listen-on port 53 { interna; }; allow-transfer { none; }; listen-on-v6 { none; }; version none; // CRIANDO OS FORWARDERS: forwarders { // Cloudflare Public DNS IPV4 1.1.1.1; 1.0.0.1; // Google Public DNS IPV4 8.8.8.8; 8.8.4.4; }; dnssec-validation auto; }; Criar a pasta zones em /etc/bind: mkdir -p /etc/bind/zones Entrar na pasta zones: cd /etc/bind/zones Criar/ editar o Arquivo de zona \"db.officinas.edu\": vim db.officinas.edu ; ; BIND zone file for officinas.edu ; $TTL 86400 @ IN SOA firewall.officinas.edu. root.officinas.edu. ( 29032023 ; Serial 10800 ; Refresh ( 3 hr ) 1800 ; Retry ( 30 min ) 3600000 ; Expire ( 41 dias ) 86400 ) ; Negative Cache TTL (1 dia) ; @ IN NS firewall.officinas.edu. firewall.officinas.edu. IN A 192.168.70.254 dcmaster.officinas.edu. IN A 192.168.70.200 webserver.officinas.edu. IN A 192.168.70.100 arquivos IN CNAME dcmaster.officinas.edu. www IN CNAME webserver.officinas.edu. ATEN\u00c7\u00c3O - Explica\u00e7\u00e3o dos Campos zona e zona reversa: IN = Internet SOA = Start of Autority @ = Origem do Dominio e/ou Inicio da Configuracao TTL = Tempo de vida NS = Name Server MX = Mail Exchanger (10/20 numero de prioridade quanto maior o numero menor e a prioridade) hostmaster = email do administrador note que e separado por \".\" e NAO \"@\" A = Apontamento para IPv4 (Address Mapping) AAAA = Apontamento para IPv6 (Address Mapping) CNAME = Apontamento para Nome Canonico/alias PTR = PoinTeR (aponta dominio reverso a partir de um endere\u00e7o IP) TXT = TeXT, permite incluir um texto curto em um hostname. Tecnica usada para implementar o SPF. SPF = SenderPolicyFramework.Permite ao administrador de um dominio definir os enderecos das maquinas autorizadas a enviar mensagens neste dominio. SRV = SeRVice, permite definir localizacao de servicos disponiveis em um dominio, inclusive seus protocolos e portas. Fazer uma copia do arquivo db.127 em /etc/bind para /etc/bind/zones/db.70.168.192: cp /etc/bind/db.127 /etc/bind/zones/db.70.168.192 Criar/ editar o Arquivo de zona reversa: vim /etc/bind/zones/db.200.168.192 ; ; BIND reverse data file for 70.168.192 ; $TTL 86400 @ IN SOA firewall.officinas.edu. root.officinas.edu. ( 29032023 ; Serial 10800 ; Refresh ( 3 hr ) 1800 ; Retry ( 30 min ) 3600000 ; Expire ( 41 dias ) 86400 ) ; Negative Cache TTL (1 dia) ; @ IN NS firewall.officinas.edu. firewall IN A 192.168.70.254 254 IN PTR firewall.officinas.edu. 200 IN PTR dcmaster.officinas.edu. 100 IN PTR webserver.officinas.edu. Restart/ reload no bind9 analisando os logs: /etc/init.d/bind9 restart ; tail -f /var/log/syslog Agora, vamos entregar a resolu\u00e7\u00e3o ao DNS Server local editando o /etc/resolv.conf: vim /etc/resolv.conf 127.0.0.1 Checar se as confs foram aplicadas: named-checkzone officinas.edu /etc/bind/zones/db.officinas.edu named-checkzone 70.168.192 /etc/bind/zones/db.70.168.192 Testar o DNS utilizando o comando nslookup: nslookup www.terra.com.br nslookup www.proot.com.br Testar o DNS utilizando o dig: dig -t any www.terra.com.br dig -t any www.proot.com.br Bloqueia a edi\u00e7\u00e3o do arquivo /etc/resolv.conf: chattr +i /etc/resolv.conf that's all folks!","title":"\ud83d\udcc1 DNS Server"},{"location":"DNS_Server/#dns-server","text":"","title":"\ud83d\udcc1 DNS Server"},{"location":"DNS_Server/#criando-um-servidor-de-dns","text":"A INSTALA\u00c7\u00c3O A SEGUIR SE DAR\u00c1 NA M\u00c1QUINA DO PR\u00d3PRIO FIREWALL!","title":"Criando um Servidor de DNS"},{"location":"DNS_Server/#instalar-os-pacotes-necessarios","text":"apt-get install bind9 openssh-server dnsutils","title":"Instalar os pacotes necess\u00e1rios:"},{"location":"DNS_Server/#editar-o-arquivo-etcdefaultnamed-e-deixa-lo-como-no-exemplo","text":"# run resolvconf? RESOLVCONF=no # startup options for the server OPTIONS=\"-u bind -4\"","title":"Editar o arquivo /etc/default/named e deixa-lo como no exemplo:"},{"location":"DNS_Server/#o-arquivo-etcbindnamedconf-fica-sem-alteracao","text":"// This is the primary configuration file for the BIND DNS server named. // // Please read /usr/share/doc/bind9/README.Debian.gz for information on the // structure of BIND configuration files in Debian, *BEFORE* you customize // this configuration file. // // If you are just adding zones, please do that in /etc/bind/named.conf.local include \"/etc/bind/named.conf.options\"; include \"/etc/bind/named.conf.local\"; include \"/etc/bind/named.conf.default-zones\";","title":"O arquivo /etc/bind/named.conf fica sem altera\u00e7\u00e3o:"},{"location":"DNS_Server/#o-arquivo-etcbindnamedconflocal-tbem-fica-sem-alteracao","text":"// // Do any local configuration here // // Consider adding the 1918 zones here, if they are not used in your // organization //include \"/etc/bind/zones.rfc1918\";","title":"O arquivo /etc/bind/named.conf.local tb\u00e9m fica sem altera\u00e7\u00e3o:"},{"location":"DNS_Server/#entrar-em-etcbind","text":"cd /etc/bind","title":"Entrar em /etc/bind:"},{"location":"DNS_Server/#fazer-um-backup-do-arquivo-original","text":"cp named.conf.default-zones{,.orig}","title":"Fazer um backup do arquivo original:"},{"location":"DNS_Server/#editar-namedconfdefault-zones-e-deixa-lo-como-no-exemplo","text":"vim named.conf.default-zones // prime the server with knowledge of the root servers zone \".\" { type hint; file \"/usr/share/dns/root.hints\"; }; // be authoritative for the localhost forward and reverse zones, and for // broadcast zones as per RFC 1912 zone \"localhost\" { type master; file \"/etc/bind/db.local\"; }; zone \"127.in-addr.arpa\" { type master; file \"/etc/bind/db.127\"; }; zone \"0.in-addr.arpa\" { type master; file \"/etc/bind/db.0\"; }; zone \"255.in-addr.arpa\" { type master; file \"/etc/bind/db.255\"; }; zone \"officinas.edu\" { type master; file \"/etc/bind/zones/db.officinas.edu\"; }; zone \"70.168.192.in-addr.arpa\" { type master; file \"/etc/bind/zones/db.70.168.192\"; };","title":"Editar named.conf.default-zones e deixa-lo como no exemplo:"},{"location":"DNS_Server/#criar-editar-o-arquivo-namedconfoptions","text":"vim named.conf.options // CRIANDO REGRAS DE LIBERA\u00c7\u00c3O: acl interna { 127.0.0.0/8; 192.168.70.0/24; }; options { directory \"/var/cache/bind\"; // CRIANDO RECURSIVIDADE DA MINHA ACL NA \u00c1RVORE HIER\u00c1RQUICA: recursion yes; allow-query { interna; }; allow-recursion { interna; }; listen-on port 53 { interna; }; allow-transfer { none; }; listen-on-v6 { none; }; version none; // CRIANDO OS FORWARDERS: forwarders { // Cloudflare Public DNS IPV4 1.1.1.1; 1.0.0.1; // Google Public DNS IPV4 8.8.8.8; 8.8.4.4; }; dnssec-validation auto; };","title":"Criar/ editar o Arquivo named.conf.options:"},{"location":"DNS_Server/#criar-a-pasta-zones-em-etcbind","text":"mkdir -p /etc/bind/zones","title":"Criar a pasta zones em /etc/bind:"},{"location":"DNS_Server/#entrar-na-pasta-zones","text":"cd /etc/bind/zones","title":"Entrar na pasta zones:"},{"location":"DNS_Server/#criar-editar-o-arquivo-de-zona-dbofficinasedu","text":"vim db.officinas.edu ; ; BIND zone file for officinas.edu ; $TTL 86400 @ IN SOA firewall.officinas.edu. root.officinas.edu. ( 29032023 ; Serial 10800 ; Refresh ( 3 hr ) 1800 ; Retry ( 30 min ) 3600000 ; Expire ( 41 dias ) 86400 ) ; Negative Cache TTL (1 dia) ; @ IN NS firewall.officinas.edu. firewall.officinas.edu. IN A 192.168.70.254 dcmaster.officinas.edu. IN A 192.168.70.200 webserver.officinas.edu. IN A 192.168.70.100 arquivos IN CNAME dcmaster.officinas.edu. www IN CNAME webserver.officinas.edu.","title":"Criar/ editar o Arquivo de zona \"db.officinas.edu\":"},{"location":"DNS_Server/#atencao-explicacao-dos-campos-zona-e-zona-reversa","text":"IN = Internet SOA = Start of Autority @ = Origem do Dominio e/ou Inicio da Configuracao TTL = Tempo de vida NS = Name Server MX = Mail Exchanger (10/20 numero de prioridade quanto maior o numero menor e a prioridade) hostmaster = email do administrador note que e separado por \".\" e NAO \"@\" A = Apontamento para IPv4 (Address Mapping) AAAA = Apontamento para IPv6 (Address Mapping) CNAME = Apontamento para Nome Canonico/alias PTR = PoinTeR (aponta dominio reverso a partir de um endere\u00e7o IP) TXT = TeXT, permite incluir um texto curto em um hostname. Tecnica usada para implementar o SPF. SPF = SenderPolicyFramework.Permite ao administrador de um dominio definir os enderecos das maquinas autorizadas a enviar mensagens neste dominio. SRV = SeRVice, permite definir localizacao de servicos disponiveis em um dominio, inclusive seus protocolos e portas.","title":"ATEN\u00c7\u00c3O - Explica\u00e7\u00e3o dos Campos zona e zona reversa:"},{"location":"DNS_Server/#fazer-uma-copia-do-arquivo-db127-em-etcbind-para-etcbindzonesdb70168192","text":"cp /etc/bind/db.127 /etc/bind/zones/db.70.168.192","title":"Fazer uma copia do arquivo db.127 em /etc/bind para /etc/bind/zones/db.70.168.192:"},{"location":"DNS_Server/#criar-editar-o-arquivo-de-zona-reversa","text":"vim /etc/bind/zones/db.200.168.192 ; ; BIND reverse data file for 70.168.192 ; $TTL 86400 @ IN SOA firewall.officinas.edu. root.officinas.edu. ( 29032023 ; Serial 10800 ; Refresh ( 3 hr ) 1800 ; Retry ( 30 min ) 3600000 ; Expire ( 41 dias ) 86400 ) ; Negative Cache TTL (1 dia) ; @ IN NS firewall.officinas.edu. firewall IN A 192.168.70.254 254 IN PTR firewall.officinas.edu. 200 IN PTR dcmaster.officinas.edu. 100 IN PTR webserver.officinas.edu.","title":"Criar/ editar o Arquivo de zona reversa:"},{"location":"DNS_Server/#restart-reload-no-bind9-analisando-os-logs","text":"/etc/init.d/bind9 restart ; tail -f /var/log/syslog","title":"Restart/ reload no bind9 analisando os logs:"},{"location":"DNS_Server/#agora-vamos-entregar-a-resolucao-ao-dns-server-local-editando-o-etcresolvconf","text":"vim /etc/resolv.conf 127.0.0.1","title":"Agora, vamos entregar a resolu\u00e7\u00e3o ao DNS Server local editando o /etc/resolv.conf:"},{"location":"DNS_Server/#checar-se-as-confs-foram-aplicadas","text":"named-checkzone officinas.edu /etc/bind/zones/db.officinas.edu named-checkzone 70.168.192 /etc/bind/zones/db.70.168.192","title":"Checar se as confs foram aplicadas:"},{"location":"DNS_Server/#testar-o-dns-utilizando-o-comando-nslookup","text":"nslookup www.terra.com.br nslookup www.proot.com.br","title":"Testar o DNS utilizando o comando nslookup:"},{"location":"DNS_Server/#testar-o-dns-utilizando-o-dig","text":"dig -t any www.terra.com.br dig -t any www.proot.com.br","title":"Testar o DNS utilizando o dig:"},{"location":"DNS_Server/#bloqueia-a-edicao-do-arquivo-etcresolvconf","text":"chattr +i /etc/resolv.conf that's all folks!","title":"Bloqueia a edi\u00e7\u00e3o do arquivo /etc/resolv.conf:"},{"location":"FHS/","text":"\ud83d\udcc1 FHS Filesystem Hierarchy Standard A estrutura Hier\u00e1rquica de Diret\u00f3rios no Linux O sistema operacional Linux utiliza uma estrutura de diret\u00f3rios hier\u00e1rquica e organizada para gerenciar todos os arquivos e recursos do sistema. Compreender essa estrutura \u00e9 fundamental para usu\u00e1rios e administradores, pois fornece uma vis\u00e3o clara da organiza\u00e7\u00e3o do sistema de arquivos e onde encontrar ou armazenar diferentes tipos de dados. A hierarquia de diret\u00f3rios no Linux \u00e9 padronizada pelo Filesystem Hierarchy Standard (FHS), que define a fun\u00e7\u00e3o de cada diret\u00f3rio e estabelece conven\u00e7\u00f5es para a organiza\u00e7\u00e3o dos arquivos. Ao entender a finalidade de cada diret\u00f3rio, os usu\u00e1rios podem navegar no sistema com mais facilidade, armazenar dados nos locais apropriados e os administradores podem gerenciar o sistema de forma eficiente. Neste documento, exploraremos detalhadamente os principais diret\u00f3rios do sistema, desde o diret\u00f3rio raiz at\u00e9 os locais destinados a programas, configura\u00e7\u00f5es, arquivos tempor\u00e1rios e muito mais. Vamos examinar a fun\u00e7\u00e3o de cada diret\u00f3rio, os tipos de dados armazenados neles e como eles contribuem para o funcionamento adequado do sistema Linux. Vamos mergulhar na estrutura de diret\u00f3rios do Linux para entender melhor como o sistema organiza seus arquivos e recursos, proporcionando uma base s\u00f3lida para a utiliza\u00e7\u00e3o e administra\u00e7\u00e3o do sistema operacional: / O diret\u00f3rio raiz \u00e9 o ponto inicial do sistema de arquivos. Todos os outros diret\u00f3rios e arquivos s\u00e3o acess\u00edveis a partir daqui. /bin \u00c9 um link simb\u00f3lico apontando para /usr/bin , contendo os bin\u00e1rios essenciais do sistema. Estes incluem comandos b\u00e1sicos do sistema utilizados tanto por usu\u00e1rios regulares quanto por administradores. /boot Armazena os arquivos necess\u00e1rios para inicializa\u00e7\u00e3o do sistema, como o kernel, arquivos de configura\u00e7\u00e3o do bootloader e informa\u00e7\u00f5es relacionadas \u00e0 inicializa\u00e7\u00e3o. /dev Cont\u00e9m arquivos de dispositivo, que representam dispositivos f\u00edsicos ou virtuais no sistema. Cada hardware \u00e9 representado como um arquivo neste diret\u00f3rio. /etc \u00c9 o diret\u00f3rio onde os arquivos de configura\u00e7\u00e3o do sistema e dos aplicativos s\u00e3o armazenados. Isso inclui configura\u00e7\u00f5es de rede, informa\u00e7\u00f5es de usu\u00e1rios, configura\u00e7\u00f5es de servi\u00e7os e muito mais. /home Cont\u00e9m os diret\u00f3rios pessoais dos usu\u00e1rios. Cada usu\u00e1rio normalmente possui um diret\u00f3rio correspondente aqui, onde podem armazenar seus arquivos pessoais. /lib e /lib64 S\u00e3o links simb\u00f3licos apontando para /usr/lib e /usr/lib64 , onde se armazenam as bibliotecas compartilhadas e m\u00f3dulos do kernel, necess\u00e1rias para os bin\u00e1rios localizados em /usr/bin e /usr/sbin . Enquanto o /lib \u00e9 usado para sistemas de 32 bits, o /lib64 d\u00e1 suporte para sistemas de 64 bits. /media e /mnt S\u00e3o diret\u00f3rios para montagem tempor\u00e1ria de dispositivos de armazenamento remov\u00edveis. O diret\u00f3rio /media \u00e9 geralmente utilizado para montagem autom\u00e1tica, enquanto /mnt \u00e9 comumente utilizado para montagens manuais. /opt \u00c9 utilizado para a instala\u00e7\u00e3o de pacotes de software adicionais que n\u00e3o s\u00e3o parte da distribui\u00e7\u00e3o principal. Os aplicativos instalados aqui t\u00eam suas pr\u00f3prias subpastas separadas. /proc e /sys S\u00e3o sistemas de arquivos virtuais que fornecem informa\u00e7\u00f5es sobre processos, hardware e interfaces do kernel. O diret\u00f3rio /proc cont\u00e9m informa\u00e7\u00f5es em tempo real sobre o sistema, enquanto /sys \u00e9 usado para interagir com o kernel. /sbin \u00c9 um link simb\u00f3lico apontando para /usr/sbin , armazenando bin\u00e1rios do sistema utilizados principalmente pelo superusu\u00e1rio (root) para realizar tarefas administrativas. Esses comandos geralmente n\u00e3o est\u00e3o dispon\u00edveis para usu\u00e1rios regulares. /tmp \u00c9 um diret\u00f3rio destinado a arquivos tempor\u00e1rios. O conte\u00fado aqui \u00e9 frequentemente exclu\u00eddo entre as reinicializa\u00e7\u00f5es do sistema. /usr Uma hierarquia secund\u00e1ria, contendo a maioria dos programas, bibliotecas e documenta\u00e7\u00f5es do sistema. \u00c9 subdividido em /usr/bin , /usr/sbin , /usr/lib , entre outros, que cont\u00eam execut\u00e1veis, bin\u00e1rios de sistema, bibliotecas e outros recursos. /var Armazena arquivos que podem variar de tamanho dinamicamente durante a opera\u00e7\u00e3o do sistema. Isso inclui logs, spools de impress\u00e3o, arquivos de cache e bancos de dados. Esta \u00e9 uma vis\u00e3o mais detalhada da estrutura de diret\u00f3rios no Linux, destacando a fun\u00e7\u00e3o e o prop\u00f3sito de cada diret\u00f3rio. Cada um desempenha um papel vital no funcionamento adequado do sistema operacional. that's all folks!","title":"\ud83d\udcc1 FHS Filesystem Hierarchy Standard"},{"location":"FHS/#fhs-filesystem-hierarchy-standard","text":"","title":"\ud83d\udcc1 FHS Filesystem Hierarchy Standard"},{"location":"FHS/#a-estrutura-hierarquica-de-diretorios-no-linux","text":"O sistema operacional Linux utiliza uma estrutura de diret\u00f3rios hier\u00e1rquica e organizada para gerenciar todos os arquivos e recursos do sistema. Compreender essa estrutura \u00e9 fundamental para usu\u00e1rios e administradores, pois fornece uma vis\u00e3o clara da organiza\u00e7\u00e3o do sistema de arquivos e onde encontrar ou armazenar diferentes tipos de dados. A hierarquia de diret\u00f3rios no Linux \u00e9 padronizada pelo Filesystem Hierarchy Standard (FHS), que define a fun\u00e7\u00e3o de cada diret\u00f3rio e estabelece conven\u00e7\u00f5es para a organiza\u00e7\u00e3o dos arquivos. Ao entender a finalidade de cada diret\u00f3rio, os usu\u00e1rios podem navegar no sistema com mais facilidade, armazenar dados nos locais apropriados e os administradores podem gerenciar o sistema de forma eficiente. Neste documento, exploraremos detalhadamente os principais diret\u00f3rios do sistema, desde o diret\u00f3rio raiz at\u00e9 os locais destinados a programas, configura\u00e7\u00f5es, arquivos tempor\u00e1rios e muito mais. Vamos examinar a fun\u00e7\u00e3o de cada diret\u00f3rio, os tipos de dados armazenados neles e como eles contribuem para o funcionamento adequado do sistema Linux. Vamos mergulhar na estrutura de diret\u00f3rios do Linux para entender melhor como o sistema organiza seus arquivos e recursos, proporcionando uma base s\u00f3lida para a utiliza\u00e7\u00e3o e administra\u00e7\u00e3o do sistema operacional:","title":"A estrutura Hier\u00e1rquica de Diret\u00f3rios no Linux"},{"location":"FHS/#_1","text":"O diret\u00f3rio raiz \u00e9 o ponto inicial do sistema de arquivos. Todos os outros diret\u00f3rios e arquivos s\u00e3o acess\u00edveis a partir daqui.","title":"/"},{"location":"FHS/#bin","text":"\u00c9 um link simb\u00f3lico apontando para /usr/bin , contendo os bin\u00e1rios essenciais do sistema. Estes incluem comandos b\u00e1sicos do sistema utilizados tanto por usu\u00e1rios regulares quanto por administradores.","title":"/bin"},{"location":"FHS/#boot","text":"Armazena os arquivos necess\u00e1rios para inicializa\u00e7\u00e3o do sistema, como o kernel, arquivos de configura\u00e7\u00e3o do bootloader e informa\u00e7\u00f5es relacionadas \u00e0 inicializa\u00e7\u00e3o.","title":"/boot"},{"location":"FHS/#dev","text":"Cont\u00e9m arquivos de dispositivo, que representam dispositivos f\u00edsicos ou virtuais no sistema. Cada hardware \u00e9 representado como um arquivo neste diret\u00f3rio.","title":"/dev"},{"location":"FHS/#etc","text":"\u00c9 o diret\u00f3rio onde os arquivos de configura\u00e7\u00e3o do sistema e dos aplicativos s\u00e3o armazenados. Isso inclui configura\u00e7\u00f5es de rede, informa\u00e7\u00f5es de usu\u00e1rios, configura\u00e7\u00f5es de servi\u00e7os e muito mais.","title":"/etc"},{"location":"FHS/#home","text":"Cont\u00e9m os diret\u00f3rios pessoais dos usu\u00e1rios. Cada usu\u00e1rio normalmente possui um diret\u00f3rio correspondente aqui, onde podem armazenar seus arquivos pessoais.","title":"/home"},{"location":"FHS/#lib-e-lib64","text":"S\u00e3o links simb\u00f3licos apontando para /usr/lib e /usr/lib64 , onde se armazenam as bibliotecas compartilhadas e m\u00f3dulos do kernel, necess\u00e1rias para os bin\u00e1rios localizados em /usr/bin e /usr/sbin . Enquanto o /lib \u00e9 usado para sistemas de 32 bits, o /lib64 d\u00e1 suporte para sistemas de 64 bits.","title":"/lib e /lib64"},{"location":"FHS/#media-e-mnt","text":"S\u00e3o diret\u00f3rios para montagem tempor\u00e1ria de dispositivos de armazenamento remov\u00edveis. O diret\u00f3rio /media \u00e9 geralmente utilizado para montagem autom\u00e1tica, enquanto /mnt \u00e9 comumente utilizado para montagens manuais.","title":"/media e /mnt"},{"location":"FHS/#opt","text":"\u00c9 utilizado para a instala\u00e7\u00e3o de pacotes de software adicionais que n\u00e3o s\u00e3o parte da distribui\u00e7\u00e3o principal. Os aplicativos instalados aqui t\u00eam suas pr\u00f3prias subpastas separadas.","title":"/opt"},{"location":"FHS/#proc-e-sys","text":"S\u00e3o sistemas de arquivos virtuais que fornecem informa\u00e7\u00f5es sobre processos, hardware e interfaces do kernel. O diret\u00f3rio /proc cont\u00e9m informa\u00e7\u00f5es em tempo real sobre o sistema, enquanto /sys \u00e9 usado para interagir com o kernel.","title":"/proc e /sys"},{"location":"FHS/#sbin","text":"\u00c9 um link simb\u00f3lico apontando para /usr/sbin , armazenando bin\u00e1rios do sistema utilizados principalmente pelo superusu\u00e1rio (root) para realizar tarefas administrativas. Esses comandos geralmente n\u00e3o est\u00e3o dispon\u00edveis para usu\u00e1rios regulares.","title":"/sbin"},{"location":"FHS/#tmp","text":"\u00c9 um diret\u00f3rio destinado a arquivos tempor\u00e1rios. O conte\u00fado aqui \u00e9 frequentemente exclu\u00eddo entre as reinicializa\u00e7\u00f5es do sistema.","title":"/tmp"},{"location":"FHS/#usr","text":"Uma hierarquia secund\u00e1ria, contendo a maioria dos programas, bibliotecas e documenta\u00e7\u00f5es do sistema. \u00c9 subdividido em /usr/bin , /usr/sbin , /usr/lib , entre outros, que cont\u00eam execut\u00e1veis, bin\u00e1rios de sistema, bibliotecas e outros recursos.","title":"/usr"},{"location":"FHS/#var","text":"Armazena arquivos que podem variar de tamanho dinamicamente durante a opera\u00e7\u00e3o do sistema. Isso inclui logs, spools de impress\u00e3o, arquivos de cache e bancos de dados. Esta \u00e9 uma vis\u00e3o mais detalhada da estrutura de diret\u00f3rios no Linux, destacando a fun\u00e7\u00e3o e o prop\u00f3sito de cada diret\u00f3rio. Cada um desempenha um papel vital no funcionamento adequado do sistema operacional. that's all folks!","title":"/var"},{"location":"Fileserver_Debian/","text":"\ud83d\udcc1 FileServer no Debian com bin\u00e1rios Tutorial de Configura\u00e7\u00e3o do Samba4 como FileServer no Debian 13 Este guia mostra como instalar e configurar o Samba4 em um servidor Debian 13, criando compartilhamentos de rede com permiss\u00f5es de usu\u00e1rios. 0 - Atualizar o Sistema sudo apt update sudo apt full-upgrade 1 - Instalar o Samba sudo apt update sudo apt install samba -y 2 - Criar usu\u00e1rios do sistema Adicione os usu\u00e1rios que ter\u00e3o acesso: sudo adduser oliveira sudo adduser giovanna 3 - Definir senhas Samba para os usu\u00e1rios Adicione os usu\u00e1rios ao banco de senhas do Samba: sudo smbpasswd -a oliveira sudo smbpasswd -a giovanna 4 - Criar diret\u00f3rios para os compartilhamentos Crie as pastas que ser\u00e3o compartilhadas: sudo mkdir -p /arquivos/estoque sudo mkdir -p /arquivos/gestao sudo mkdir -p /arquivos/publico 5 - Definir permiss\u00f5es das pastas Ajuste as permiss\u00f5es: sudo chmod 777 -R /arquivos/estoque sudo chmod 777 -R /arquivos/gestao sudo chmod 777 -R /arquivos/publico 6 - Fazer backup do arquivo de configura\u00e7\u00e3o Antes de editar, fa\u00e7a backup do arquivo principal: sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bkp 7 - Configurar o Samba Edite o arquivo de configura\u00e7\u00e3o: sudo nano /etc/samba/smb.conf Insira o seguinte conte\u00fado: [global] workgroup = ESCRITORIO netbios name = debianserver server string = Servidor Samba Debian 13 security = user map to guest = bad user [Estoque] comment = Arquivos de usu\u00e1rios path = /arquivos/estoque public = no writable = yes guest ok = no read list = oliveira create mask = 0775 directory mask = 0775 [Gestao] comment = Arquivos de usu\u00e1rios path = /arquivos/gestao browseable = no public = no writable = no guest ok = no write list = oliveira,giovanna create mask = 0775 directory mask = 0775 [Publico] comment = Pasta Publico path = /arquivos/publico browseable = yes writable = yes guest ok = no public = yes create mode = 0777 directory mode = 0777 8 - Ativar e reiniciar os servi\u00e7os do Samba No Debian 13, os servi\u00e7os s\u00e3o os mesmos: sudo systemctl enable smbd nmbd sudo systemctl restart smbd nmbd 9 - Testar configura\u00e7\u00e3o Verifique se n\u00e3o h\u00e1 erros: testparm 10 - Acessar os compartilhamentos Agora, de outra m\u00e1quina na mesma rede, voc\u00ea pode acessar: \\\\IP_DO_SERVIDOR\\Estoque \\\\IP_DO_SERVIDOR\\Gestao \\\\IP_DO_SERVIDOR\\Publico 11 - Estrutura de Pastas e Permiss\u00f5es \u2013 Samba4 no Debian 13 /arquivos \u251c\u2500\u2500 estoque/ (rw para oliveira, somente leitura para outros) \u2502 \u2514\u2500\u2500 Permiss\u00f5es: \u2502 - oliveira: leitura e escrita \u2502 - demais: leitura \u2502 \u251c\u2500\u2500 gestao/ (rw para oliveira e giovanna, bloqueado para outros) \u2502 \u2514\u2500\u2500 Permiss\u00f5es: \u2502 - oliveira: leitura e escrita \u2502 - giovanna: leitura e escrita \u2502 - demais: sem acesso \u2502 \u2514\u2500\u2500 publico/ (rw para todos usu\u00e1rios Samba) \u2514\u2500\u2500 Permiss\u00f5es: - Todos os usu\u00e1rios cadastrados: leitura e escrita 12 - Fluxo de Configura\u00e7\u00e3o (resumido) Usu\u00e1rios criados no sistema \u2502 \u251c\u2500\u2500> oliveira \u2514\u2500\u2500> giovanna \u2193 Usu\u00e1rios adicionados ao Samba smbpasswd -a oliveira smbpasswd -a giovanna \u2193 Pastas configuradas em /arquivos estoque | gestao | publico \u2193 Configura\u00e7\u00e3o no smb.conf [Estoque] [Gestao] [Publico] \u2193 Servi\u00e7os smbd + nmbd ativos THAT'S ALL FOLKS","title":"\ud83d\udcc1 FileServer no Debian com bin\u00e1rios"},{"location":"Fileserver_Debian/#fileserver-no-debian-com-binarios","text":"","title":"\ud83d\udcc1 FileServer no Debian com bin\u00e1rios"},{"location":"Fileserver_Debian/#tutorial-de-configuracao-do-samba4-como-fileserver-no-debian-13","text":"","title":"Tutorial de Configura\u00e7\u00e3o do Samba4 como FileServer no Debian 13"},{"location":"Fileserver_Debian/#este-guia-mostra-como-instalar-e-configurar-o-samba4-em-um-servidor-debian-13-criando-compartilhamentos-de-rede-com-permissoes-de-usuarios","text":"0 - Atualizar o Sistema sudo apt update sudo apt full-upgrade 1 - Instalar o Samba sudo apt update sudo apt install samba -y 2 - Criar usu\u00e1rios do sistema Adicione os usu\u00e1rios que ter\u00e3o acesso: sudo adduser oliveira sudo adduser giovanna 3 - Definir senhas Samba para os usu\u00e1rios Adicione os usu\u00e1rios ao banco de senhas do Samba: sudo smbpasswd -a oliveira sudo smbpasswd -a giovanna 4 - Criar diret\u00f3rios para os compartilhamentos Crie as pastas que ser\u00e3o compartilhadas: sudo mkdir -p /arquivos/estoque sudo mkdir -p /arquivos/gestao sudo mkdir -p /arquivos/publico 5 - Definir permiss\u00f5es das pastas Ajuste as permiss\u00f5es: sudo chmod 777 -R /arquivos/estoque sudo chmod 777 -R /arquivos/gestao sudo chmod 777 -R /arquivos/publico 6 - Fazer backup do arquivo de configura\u00e7\u00e3o Antes de editar, fa\u00e7a backup do arquivo principal: sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bkp 7 - Configurar o Samba Edite o arquivo de configura\u00e7\u00e3o: sudo nano /etc/samba/smb.conf Insira o seguinte conte\u00fado: [global] workgroup = ESCRITORIO netbios name = debianserver server string = Servidor Samba Debian 13 security = user map to guest = bad user [Estoque] comment = Arquivos de usu\u00e1rios path = /arquivos/estoque public = no writable = yes guest ok = no read list = oliveira create mask = 0775 directory mask = 0775 [Gestao] comment = Arquivos de usu\u00e1rios path = /arquivos/gestao browseable = no public = no writable = no guest ok = no write list = oliveira,giovanna create mask = 0775 directory mask = 0775 [Publico] comment = Pasta Publico path = /arquivos/publico browseable = yes writable = yes guest ok = no public = yes create mode = 0777 directory mode = 0777 8 - Ativar e reiniciar os servi\u00e7os do Samba No Debian 13, os servi\u00e7os s\u00e3o os mesmos: sudo systemctl enable smbd nmbd sudo systemctl restart smbd nmbd 9 - Testar configura\u00e7\u00e3o Verifique se n\u00e3o h\u00e1 erros: testparm 10 - Acessar os compartilhamentos Agora, de outra m\u00e1quina na mesma rede, voc\u00ea pode acessar: \\\\IP_DO_SERVIDOR\\Estoque \\\\IP_DO_SERVIDOR\\Gestao \\\\IP_DO_SERVIDOR\\Publico 11 - Estrutura de Pastas e Permiss\u00f5es \u2013 Samba4 no Debian 13 /arquivos \u251c\u2500\u2500 estoque/ (rw para oliveira, somente leitura para outros) \u2502 \u2514\u2500\u2500 Permiss\u00f5es: \u2502 - oliveira: leitura e escrita \u2502 - demais: leitura \u2502 \u251c\u2500\u2500 gestao/ (rw para oliveira e giovanna, bloqueado para outros) \u2502 \u2514\u2500\u2500 Permiss\u00f5es: \u2502 - oliveira: leitura e escrita \u2502 - giovanna: leitura e escrita \u2502 - demais: sem acesso \u2502 \u2514\u2500\u2500 publico/ (rw para todos usu\u00e1rios Samba) \u2514\u2500\u2500 Permiss\u00f5es: - Todos os usu\u00e1rios cadastrados: leitura e escrita 12 - Fluxo de Configura\u00e7\u00e3o (resumido) Usu\u00e1rios criados no sistema \u2502 \u251c\u2500\u2500> oliveira \u2514\u2500\u2500> giovanna \u2193 Usu\u00e1rios adicionados ao Samba smbpasswd -a oliveira smbpasswd -a giovanna \u2193 Pastas configuradas em /arquivos estoque | gestao | publico \u2193 Configura\u00e7\u00e3o no smb.conf [Estoque] [Gestao] [Publico] \u2193 Servi\u00e7os smbd + nmbd ativos THAT'S ALL FOLKS","title":"Este guia mostra como instalar e configurar o Samba4 em um servidor Debian 13, criando compartilhamentos de rede com permiss\u00f5es de usu\u00e1rios."},{"location":"Fileserver_Rocky/","text":"\ud83d\udcc1 FileServer Rocky Servidor de Arquivos do AD no Rocky Linux 9 Ap\u00f3s a instala\u00e7\u00e3o do sistema operacional, seguir com os comandos para a instala\u00e7\u00e3o e configura\u00e7\u00e3o do samba como membro e servidor de arquivos. Atualizar o sistema: yum update -y && yum upgrade -y Instalar os pacotes do samba necess\u00e1rios para samba e servidor de arquivos: yum install samba samba-winbind samba-winbind-clients Habilitar os servi\u00e7os para iniciar junto ao boot do sistema: systemctl enable smb nmb winbind Configurar e editar o arquivo /etc/hosts : nano /etc/hosts 127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 10.1.1.13 arquivos.esharknet.edu arquivos ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6 Salvar o arquivo Configurar e editar /etc/hostname: nano /etc/hostname arquivos.esharknet.edu Salvar o Arquivo Configurar e editar /etc/nsswitch.conf : nano /etc/nsswitch.conf Mudar a configura\u00e7\u00e3o De: passwd: sss files systemd Para: passwd: files winbind De: group: sss files systemd Para: group: files winbind Salve o arquivo Configurar a rede e inserir dados do DNS do AD-DC ou seja, do seu controlador de dom\u00ednio: nmtui Escolha Editar uma Conex\u00e3o Digite Enter Com a tela Tab v\u00e1 em Editar Com as teclas de dire\u00e7\u00e3o (setas) mova-se at\u00e9 Servidores DNS e troque o IP para o IP de seu AD DC (controlador de dom\u00ednio) Ainda com as setas de dire\u00e7\u00e3o, v\u00e1 at\u00e9 Dom\u00ednios de pesquisa e digite enter para adicionar o seu.dom\u00ednio . Ent\u00e3o, selecione OK com as setas de dire\u00e7\u00e3o e digite enter . Com a tecla Tab , v\u00e1 at\u00e9 a op\u00e7\u00e3o: voltar e digite enter . Ent\u00e3o, com a tecla Tab , selecione a op\u00e7\u00e3o OK e digite enter Reiniciar o sistema: reboot Editar o arquivo user.map no diret\u00f3rio /etc/samba com o conte\u00fado: nano /etc/samba/user.map !root = DOMINIO\\Administrator Salve o arquivo Fazer um backup do arquivo /etc/samba/smb.conf : mv /etc/samba/smb.conf /etc/samba/smb.conf.bkp Fazer um arquivo smb.conf para funcionar como membro e servidor de arquivo de modelo ( rid ) nano /etc/samba/smb.conf [global] bind interfaces only = Yes dedicated keytab file = /etc/krb5.keytab kerberos method = secrets and keytab log file = /var/log/samba/%m.log min domain uid = 0 realm = ESHARKNET.EDU security = ADS template homedir = /home/%U template shell = /bin/bash winbind refresh tickets = Yes winbind use default domain = Yes workgroup = ESHARKNET idmap config dominio : range = 10000-999999 idmap config dominio : backend = rid idmap config * : range = 3000-7999 idmap config * : backend = tdb map acl inherit = Yes vfs objects = acl_xattr Fazer uma c\u00f3pia do arquivo /etc/krb5.conf mv /etc/krb5.conf /etc/krb5.conf.bkp Editar um novo arquivo krb5.conf nano /etc/krb5.conf [libdefaults] dns_lookup_realm = false dns_lookup_kdc = true default_realm = ESHARKNET.EDU Salvar o arquivo Verificar se existe algum erro de sintaxe com o comando: testparm Se n\u00e3o houver erros, executar o comando para recarregar o samba novamente smbcontrol all reload-config Desabilitar o SELinux: nano /etc/selinux/config Na linha SELINUX=enforcing trocar para SELINUX=disabled Salvar o arquivo Ajustar o Firewall. Adicionar o servi\u00e7o do samba e recarregar o Firewall: firewall-cmd --add-service=samba --permanent firewall-cmd --reload Reiniciar o servidor : reboot Comando para juntar-se ao Dom\u00ednio Criado: net ads join -U administrator Enter administrator's password: senha do provisionamento Using short domain name -- ESHARKNET Joined 'ARQUIVOS' to dns domain 'esharknet.edu' Verificar conex\u00e3o NETLOGON com o AD: wbinfo --ping-dc Como resultado deve aparecer: checking the NETLOGON for domain[ESHARKNET] dc connection to \"dcmaster.esharknet.edu\" succeeded Verificar se o Servidor DC1 (seu controlador de dominio) volta resposta com o comando: nslookup SEU.DOMINIO: nslookup dcmaster.esharknet.edu Um resultado parecido com esse deve aparecer na tela: Server: 192.168.70.250 Address: 192.168.70.250#53 Name: dcmaster.esharknet.edu Address: 192.168.70.250 E tamb\u00e9m atrav\u00e9s IP do seu Servidor DCMaster: nslookup 192.168.70.250 Authoritative answers can be found from: 168.192.IN-ADDR.ARPA origin = 168.192.IN-ADDR.ARPA mail addr = . serial = 0 refresh = 28800 retry = 7200 expire = 604800 minimum = 86400 Antes de prosseguir, conectar seu DCMaster e criar um grupo e um usu\u00e1rio. NO DCMASTER fa\u00e7a o comando pra criar o grupo: samba-tool group add 'Linux Domain' E tamb\u00e9m adicione um usu\u00e1rio: samba-tool user add 'esharkuser' Verificar se retorna o GID do Grupo: getent group \"ESHARKNET\\\\Linux Domain\" linux domain:x:3013: Garantir privil\u00e9gio de acesso com o Comando: net rpc rights grant \"ESHARKNET\\Domain Admins\" SeDiskOperatorPrivilege -U \"ESHARKNET\\Administrator\" Enter ESHARK\\Administrator password: senha CRIADA no provisionamento do DCMaster # Caso tenha criado corretamente o sistema ir\u00e1 dar sucesso do comando Successfully granted rights. Chegando nesse ponto, est\u00e1 apto a iniciar a configura\u00e7\u00e3o da montagem de disco, o diret\u00f3rio escolhido para abrigar seus arquivos bem como, ajustar as permiss\u00f5es de acesso para que seja poss\u00edvel fazer as altera\u00e7\u00f5es via RSAT com as devidas permiss\u00f5es. Exemplo: Se criou um disco e disponibilizou o diret\u00f3rio /srv/arquivos e ent\u00e3o, indicou esse caminho em seu smb.conf ou seja, ap\u00f3s a sess\u00e3o global indicando o nome de seu compartilhamento do servidor de arquivos, caminho, e ajustar as permiss\u00f5es de acesso seguindo o exemplo: vim /etc/samba/smb.conf [ARQUIVOS] path = /srv/arquivos/ read only = no browseable = yes Salve o arquivo Ajustando as permiss\u00f5es para o Grupo no diret\u00f3rio criado: chown root:\"Domain Admins\" /srv/arquivos chmod 775 -R /srv/arquivos Recarregar novamente o smbcontrol smbcontrol all reload-config Atrav\u00e9s do Windows, logue-se com a conta Administrator e atrav\u00e9s do RSAT inicie suas configura\u00e7\u00f5es desejadas. THAT\u2019S ALL FOLKS!!","title":"\ud83d\udcc1 FileServer Rocky"},{"location":"Fileserver_Rocky/#fileserver-rocky","text":"","title":"\ud83d\udcc1 FileServer Rocky"},{"location":"Fileserver_Rocky/#servidor-de-arquivos-do-ad-no-rocky-linux-9","text":"Ap\u00f3s a instala\u00e7\u00e3o do sistema operacional, seguir com os comandos para a instala\u00e7\u00e3o e configura\u00e7\u00e3o do samba como membro e servidor de arquivos. Atualizar o sistema: yum update -y && yum upgrade -y Instalar os pacotes do samba necess\u00e1rios para samba e servidor de arquivos: yum install samba samba-winbind samba-winbind-clients Habilitar os servi\u00e7os para iniciar junto ao boot do sistema: systemctl enable smb nmb winbind Configurar e editar o arquivo /etc/hosts : nano /etc/hosts 127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 10.1.1.13 arquivos.esharknet.edu arquivos ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6 Salvar o arquivo Configurar e editar /etc/hostname: nano /etc/hostname arquivos.esharknet.edu Salvar o Arquivo Configurar e editar /etc/nsswitch.conf : nano /etc/nsswitch.conf Mudar a configura\u00e7\u00e3o De: passwd: sss files systemd","title":"Servidor de Arquivos do AD no Rocky Linux 9"},{"location":"Fileserver_Rocky/#para","text":"passwd: files winbind De: group: sss files systemd","title":"Para:"},{"location":"Fileserver_Rocky/#para_1","text":"group: files winbind Salve o arquivo","title":"Para:"},{"location":"Fileserver_Rocky/#configurar-a-rede-e-inserir-dados-do-dns-do-ad-dc-ou-seja-do-seu-controlador-de-dominio","text":"nmtui Escolha Editar uma Conex\u00e3o Digite Enter Com a tela Tab v\u00e1 em Editar Com as teclas de dire\u00e7\u00e3o (setas) mova-se at\u00e9 Servidores DNS e troque o IP para o IP de seu AD DC (controlador de dom\u00ednio) Ainda com as setas de dire\u00e7\u00e3o, v\u00e1 at\u00e9 Dom\u00ednios de pesquisa e digite enter para adicionar o seu.dom\u00ednio . Ent\u00e3o, selecione OK com as setas de dire\u00e7\u00e3o e digite enter . Com a tecla Tab , v\u00e1 at\u00e9 a op\u00e7\u00e3o: voltar e digite enter . Ent\u00e3o, com a tecla Tab , selecione a op\u00e7\u00e3o OK e digite enter Reiniciar o sistema: reboot Editar o arquivo user.map no diret\u00f3rio /etc/samba com o conte\u00fado: nano /etc/samba/user.map !root = DOMINIO\\Administrator Salve o arquivo Fazer um backup do arquivo /etc/samba/smb.conf : mv /etc/samba/smb.conf /etc/samba/smb.conf.bkp Fazer um arquivo smb.conf para funcionar como membro e servidor de arquivo de modelo ( rid ) nano /etc/samba/smb.conf [global] bind interfaces only = Yes dedicated keytab file = /etc/krb5.keytab kerberos method = secrets and keytab log file = /var/log/samba/%m.log min domain uid = 0 realm = ESHARKNET.EDU security = ADS template homedir = /home/%U template shell = /bin/bash winbind refresh tickets = Yes winbind use default domain = Yes workgroup = ESHARKNET idmap config dominio : range = 10000-999999 idmap config dominio : backend = rid idmap config * : range = 3000-7999 idmap config * : backend = tdb map acl inherit = Yes vfs objects = acl_xattr Fazer uma c\u00f3pia do arquivo /etc/krb5.conf mv /etc/krb5.conf /etc/krb5.conf.bkp Editar um novo arquivo krb5.conf nano /etc/krb5.conf [libdefaults] dns_lookup_realm = false dns_lookup_kdc = true default_realm = ESHARKNET.EDU Salvar o arquivo Verificar se existe algum erro de sintaxe com o comando: testparm Se n\u00e3o houver erros, executar o comando para recarregar o samba novamente smbcontrol all reload-config Desabilitar o SELinux: nano /etc/selinux/config Na linha SELINUX=enforcing trocar para SELINUX=disabled Salvar o arquivo Ajustar o Firewall. Adicionar o servi\u00e7o do samba e recarregar o Firewall: firewall-cmd --add-service=samba --permanent firewall-cmd --reload Reiniciar o servidor : reboot Comando para juntar-se ao Dom\u00ednio Criado: net ads join -U administrator Enter administrator's password: senha do provisionamento Using short domain name -- ESHARKNET Joined 'ARQUIVOS' to dns domain 'esharknet.edu'","title":"Configurar a rede e inserir dados do DNS do AD-DC ou seja, do seu controlador de dom\u00ednio:"},{"location":"Fileserver_Rocky/#verificar-conexao-netlogon-com-o-ad","text":"wbinfo --ping-dc Como resultado deve aparecer: checking the NETLOGON for domain[ESHARKNET] dc connection to \"dcmaster.esharknet.edu\" succeeded","title":"Verificar conex\u00e3o NETLOGON com o AD:"},{"location":"Fileserver_Rocky/#verificar-se-o-servidor-dc1-seu-controlador-de-dominio-volta-resposta-com-o-comando-nslookup-seudominio","text":"nslookup dcmaster.esharknet.edu Um resultado parecido com esse deve aparecer na tela: Server: 192.168.70.250 Address: 192.168.70.250#53 Name: dcmaster.esharknet.edu Address: 192.168.70.250","title":"Verificar se o Servidor DC1 (seu controlador de dominio) volta resposta com o comando: nslookup SEU.DOMINIO:"},{"location":"Fileserver_Rocky/#e-tambem-atraves-ip-do-seu-servidor-dcmaster","text":"nslookup 192.168.70.250 Authoritative answers can be found from: 168.192.IN-ADDR.ARPA origin = 168.192.IN-ADDR.ARPA mail addr = . serial = 0 refresh = 28800 retry = 7200 expire = 604800 minimum = 86400 Antes de prosseguir, conectar seu DCMaster e criar um grupo e um usu\u00e1rio. NO DCMASTER fa\u00e7a o comando pra criar o grupo: samba-tool group add 'Linux Domain' E tamb\u00e9m adicione um usu\u00e1rio: samba-tool user add 'esharkuser'","title":"E tamb\u00e9m atrav\u00e9s IP do seu Servidor DCMaster:"},{"location":"Fileserver_Rocky/#verificar-se-retorna-o-gid-do-grupo","text":"getent group \"ESHARKNET\\\\Linux Domain\" linux domain:x:3013:","title":"Verificar se retorna o GID do Grupo:"},{"location":"Fileserver_Rocky/#garantir-privilegio-de-acesso-com-o-comando","text":"net rpc rights grant \"ESHARKNET\\Domain Admins\" SeDiskOperatorPrivilege -U \"ESHARKNET\\Administrator\" Enter ESHARK\\Administrator password: senha CRIADA no provisionamento do DCMaster # Caso tenha criado corretamente o sistema ir\u00e1 dar sucesso do comando Successfully granted rights. Chegando nesse ponto, est\u00e1 apto a iniciar a configura\u00e7\u00e3o da montagem de disco, o diret\u00f3rio escolhido para abrigar seus arquivos bem como, ajustar as permiss\u00f5es de acesso para que seja poss\u00edvel fazer as altera\u00e7\u00f5es via RSAT com as devidas permiss\u00f5es. Exemplo: Se criou um disco e disponibilizou o diret\u00f3rio /srv/arquivos e ent\u00e3o, indicou esse caminho em seu smb.conf ou seja, ap\u00f3s a sess\u00e3o global indicando o nome de seu compartilhamento do servidor de arquivos, caminho, e ajustar as permiss\u00f5es de acesso seguindo o exemplo: vim /etc/samba/smb.conf [ARQUIVOS] path = /srv/arquivos/ read only = no browseable = yes Salve o arquivo","title":"Garantir privil\u00e9gio de acesso com o Comando:"},{"location":"Fileserver_Rocky/#ajustando-as-permissoes-para-o-grupo-no-diretorio-criado","text":"chown root:\"Domain Admins\" /srv/arquivos chmod 775 -R /srv/arquivos","title":"Ajustando as permiss\u00f5es para o Grupo no diret\u00f3rio criado:"},{"location":"Fileserver_Rocky/#recarregar-novamente-o-smbcontrol","text":"smbcontrol all reload-config Atrav\u00e9s do Windows, logue-se com a conta Administrator e atrav\u00e9s do RSAT inicie suas configura\u00e7\u00f5es desejadas. THAT\u2019S ALL FOLKS!!","title":"Recarregar novamente o smbcontrol"},{"location":"Fileserver_RockyLinux/","text":"\ud83d\udcc1 FileServer RockyLinux INSTALA\u00c7\u00c3O DO SAMBA4 dnf install samba samba-client HABILITANDO O SERVI\u00c7O systemctl start smb.service systemctl start nmb.service systemctl enable smb.service systemctl enable nmb.service smbd --version EDITANDO O smb.conf mv /etc/samba/smb.conf{,.orig} vim /etc/samba/smb.conf [global] workgroup = ESHARKNET #hosts allow = 127. 192.168.0 server string = Servidor de Arquivos %v netbios name = servidor security = user map to guest = bad user dns proxy = no ntlm auth = true passdb backend = tdbsam printing = cups printcap name = cups load printers = yes cups options = raw [home] comment = Diretorio Home valid users = %S, %D%w%S browseable = No read only = No inherit acls = Yes [printers] comment = All Printers path = /var/tmp printable = Yes create mask = 0600 browseable = No [print$] comment = Printer Drivers path = /var/lib/samba/drivers write list = @printadmin root force group = @printadmin create mask = 0664 directory mask = 0775 [ARQUIVOS] comment = Compartilhamentos de Rede path = /srv/samba/ARQUIVOS browseable = Yes writeable = Yes guest ok = Yes [Diretoria] path = /srv/samba/Diretoria valid users = @diretoria guest ok = no writable = no browsable = yes [Financeiro] path = /srv/samba/Financeiro valid users = @financeiro guest ok = no writable = no browsable = yes [Rh] path = /srv/samba/Rh valid users = @rh guest ok = no writable = no browsable = yes [Comercial] path = /srv/samba/Comercial valid users = @comercial guest ok = no writable = no browsable = yes [Tecnicos] path = /srv/samba/Tecnicos valid users = @tecnicos guest ok = no writable = no browsable = yes VALIDANDO AS CONFIGURA\u00c7\u00d5ES testparm CRIANDO GRUPOS DE ACESSO groupadd diretoria groupadd financeiro groupadd rh groupadd comercial groupadd tecnicos CRIANDO USU\u00c1RIO DE ACESSO E INSERINDO NOS GRUPOS useradd Eduardo smbpasswd -a Eduardo usermod -g diretoria Eduardo useradd Keila smbpasswd -a Keila usermod -g financeiro Keila useradd Marcelo smbpasswd -a Marcelo usermod -g rh Marcelo useradd Kaua smbpasswd -a kaua usermod -g comercial kaua useradd Marcia smbpasswd -a Marcia usermod -g tecnicos Marcia VALIDANDO USU\u00c1RIOS pdbedit -L pdbedit -v -L CRIANDO DIRET\u00d3RIO ESPEC\u00cdFICO COM POL\u00cdTICAS DE ACESSO mkdir -p /srv/samba/Diretoria chmod -R 770 /srv/samba/Diretoria chown -R root:diretoria /srv/samba/Diretoria mkdir -p /srv/samba/financeiro chmod -R 770 /srv/samba/financeiro chown -R root:financeiro /srv/samba/Financeiro mkdir -p /srv/samba/Rh chmod -R 770 /srv/samba/Rh chown -R root:rh /srv/samba/Rh mkdir -p /srv/samba/Tecnicos chmod -R 770 /srv/samba/Tecnicos chown -R root:tecnicos /srv/samba/Tecnicos mkdir -p /srv/samba/Comercial chmod -R 770 /srv/samba/Comercial chown -R root:comercial /srv/samba/Comercial Restartando os servi\u00e7os systemctl restart smbd systemctl restart nmbd Acesse o diret\u00f3rio Geral e logue com seu usu\u00e1rio e senha No Explorer do Windows ou do Linux: smb://192.168.0.250/ No Terminal do Linux: smbclient \u00b4\\\\192.168.0.250\u00b4 -U eduardo smbclient //192.168.0.250 -U Eduardo smbstatus Pesquisar: setfacl -R -m \"g:financeiro:rwx\" /srv/samba/Financeiro","title":"\ud83d\udcc1 FileServer RockyLinux"},{"location":"Fileserver_RockyLinux/#fileserver-rockylinux","text":"","title":"\ud83d\udcc1 FileServer RockyLinux"},{"location":"Fileserver_RockyLinux/#instalacao-do-samba4","text":"dnf install samba samba-client","title":"INSTALA\u00c7\u00c3O DO SAMBA4"},{"location":"Fileserver_RockyLinux/#habilitando-o-servico","text":"systemctl start smb.service systemctl start nmb.service systemctl enable smb.service systemctl enable nmb.service smbd --version","title":"HABILITANDO O SERVI\u00c7O"},{"location":"Fileserver_RockyLinux/#editando-o-smbconf","text":"mv /etc/samba/smb.conf{,.orig} vim /etc/samba/smb.conf [global] workgroup = ESHARKNET #hosts allow = 127. 192.168.0 server string = Servidor de Arquivos %v netbios name = servidor security = user map to guest = bad user dns proxy = no ntlm auth = true passdb backend = tdbsam printing = cups printcap name = cups load printers = yes cups options = raw [home] comment = Diretorio Home valid users = %S, %D%w%S browseable = No read only = No inherit acls = Yes [printers] comment = All Printers path = /var/tmp printable = Yes create mask = 0600 browseable = No [print$] comment = Printer Drivers path = /var/lib/samba/drivers write list = @printadmin root force group = @printadmin create mask = 0664 directory mask = 0775 [ARQUIVOS] comment = Compartilhamentos de Rede path = /srv/samba/ARQUIVOS browseable = Yes writeable = Yes guest ok = Yes [Diretoria] path = /srv/samba/Diretoria valid users = @diretoria guest ok = no writable = no browsable = yes [Financeiro] path = /srv/samba/Financeiro valid users = @financeiro guest ok = no writable = no browsable = yes [Rh] path = /srv/samba/Rh valid users = @rh guest ok = no writable = no browsable = yes [Comercial] path = /srv/samba/Comercial valid users = @comercial guest ok = no writable = no browsable = yes [Tecnicos] path = /srv/samba/Tecnicos valid users = @tecnicos guest ok = no writable = no browsable = yes","title":"EDITANDO O smb.conf"},{"location":"Fileserver_RockyLinux/#validando-as-configuracoes","text":"testparm","title":"VALIDANDO AS CONFIGURA\u00c7\u00d5ES"},{"location":"Fileserver_RockyLinux/#criando-grupos-de-acesso","text":"groupadd diretoria groupadd financeiro groupadd rh groupadd comercial groupadd tecnicos","title":"CRIANDO GRUPOS DE ACESSO"},{"location":"Fileserver_RockyLinux/#criando-usuario-de-acesso-e-inserindo-nos-grupos","text":"useradd Eduardo smbpasswd -a Eduardo usermod -g diretoria Eduardo useradd Keila smbpasswd -a Keila usermod -g financeiro Keila useradd Marcelo smbpasswd -a Marcelo usermod -g rh Marcelo useradd Kaua smbpasswd -a kaua usermod -g comercial kaua useradd Marcia smbpasswd -a Marcia usermod -g tecnicos Marcia","title":"CRIANDO USU\u00c1RIO DE ACESSO E INSERINDO NOS GRUPOS"},{"location":"Fileserver_RockyLinux/#validando-usuarios","text":"pdbedit -L pdbedit -v -L","title":"VALIDANDO USU\u00c1RIOS"},{"location":"Fileserver_RockyLinux/#criando-diretorio-especifico-com-politicas-de-acesso","text":"mkdir -p /srv/samba/Diretoria chmod -R 770 /srv/samba/Diretoria chown -R root:diretoria /srv/samba/Diretoria mkdir -p /srv/samba/financeiro chmod -R 770 /srv/samba/financeiro chown -R root:financeiro /srv/samba/Financeiro mkdir -p /srv/samba/Rh chmod -R 770 /srv/samba/Rh chown -R root:rh /srv/samba/Rh mkdir -p /srv/samba/Tecnicos chmod -R 770 /srv/samba/Tecnicos chown -R root:tecnicos /srv/samba/Tecnicos mkdir -p /srv/samba/Comercial chmod -R 770 /srv/samba/Comercial chown -R root:comercial /srv/samba/Comercial","title":"CRIANDO DIRET\u00d3RIO ESPEC\u00cdFICO COM POL\u00cdTICAS DE ACESSO"},{"location":"Fileserver_RockyLinux/#restartando-os-servicos","text":"systemctl restart smbd systemctl restart nmbd","title":"Restartando os servi\u00e7os"},{"location":"Fileserver_RockyLinux/#acesse-o-diretorio-geral-e-logue-com-seu-usuario-e-senha","text":"No Explorer do Windows ou do Linux: smb://192.168.0.250/ No Terminal do Linux: smbclient \u00b4\\\\192.168.0.250\u00b4 -U eduardo smbclient //192.168.0.250 -U Eduardo smbstatus","title":"Acesse o diret\u00f3rio Geral e logue com seu usu\u00e1rio e senha"},{"location":"Fileserver_RockyLinux/#pesquisar","text":"setfacl -R -m \"g:financeiro:rwx\" /srv/samba/Financeiro","title":"Pesquisar:"},{"location":"Fileserver_sem_RSAT/","text":"SAMBA4 - Fileserver sem gerenciamento por RSAT Tutorial: Configura\u00e7\u00e3o de Compartilhamento SMB no Linux Este tutorial ir\u00e1 gui\u00e1-lo atrav\u00e9s do processo de configura\u00e7\u00e3o de um servidor Samba em um ambiente Linux. ## Instala\u00e7\u00e3o do Samba Primeiro, atualize a lista de pacotes e instale o Samba: sudo apt update sudo apt install samba -y Criando Usu\u00e1rios e Diret\u00f3rios sudo adduser suporte Criar diret\u00f3rios para compartilhamento sudo mkdir -p /home/samba/estoque sudo mkdir -p /home/samba/gestao sudo mkdir -p /home/samba/publico Ajustar permiss\u00f5es dos diret\u00f3rios sudo chmod -R 770 /home/samba/estoque sudo chmod -R 770 /home/samba/gestao sudo chmod -R 777 /home/samba/publico sudo chown -R root:users /home/samba/estoque sudo chown -R root:users /home/samba/gestao sudo chown -R nobody:nogroup /home/samba/publico Configurando o Samba Fazer backup do arquivo de configura\u00e7\u00e3o original sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bak Editar o arquivo de configura\u00e7\u00e3o sudo nano /etc/samba/smb.conf Adicione as seguintes configura\u00e7\u00f5es ao final do arquivo: [global] workgroup = WORKGROUP server string = Servidor Samba security = user map to guest = bad user dns proxy = no [Estoque] comment = Diret\u00f3rio de Estoque path = /home/samba/estoque browsable = yes writable = yes valid users = @users create mask = 0770 directory mask = 0770 [Gestao] comment = Diret\u00f3rio de Gest\u00e3o path = /home/samba/gestao browsable = yes writable = yes valid users = @users create mask = 0770 directory mask = 0770 [Publico] comment = Diret\u00f3rio P\u00fablico path = /home/samba/publico browsable = yes writable = yes guest ok = yes create mask = 0777 directory mask = 0777 Adicionando Usu\u00e1rios ao Samba Adicione o usu\u00e1rio criado anteriormente ao Samba: sudo smbpasswd -a suporte Voc\u00ea ser\u00e1 solicitado a definir uma senha para o acesso Samba. Reiniciando e Testando o Servi\u00e7o sudo systemctl restart smbd sudo systemctl restart nmbd sudo systemctl status smbd Testar a configura\u00e7\u00e3o testparm Revisando usu\u00e1rios e grupos: cat /etc/passwd # ( usu\u00e1rios locais do Linux gerencia do LDAP ) samba-tool user list # ( usu\u00e1rios de rede gerenciados pelo SAMBA4 ) Outras valida\u00e7\u00f5es no dom\u00ednio: wbinfo -u wbinfo -g wbinfo --ping-dc getent group \u201cDomain Admins\u201d Verificando servi\u00e7o ativo: ps aux | grep samba ps ax | egrep \"samba|smbd|nmbd|winbindd\" ps axf Consultando o Servidor: testparm smbclient --version smbclient -L localhost -U% samba-tool domain level show Desabilitando a complexidade de senhas (INSEGURO!): samba-tool domain passwordsettings show samba-tool domain passwordsettings set --complexity=off samba-tool domain passwordsettings set --history-length=0 samba-tool domain passwordsettings set --min-pwd-length=0 samba-tool domain passwordsettings set --min-pwd-age=0 samba-tool user setexpiry Administrator --noexpiry Relendo as configura\u00e7\u00f5es do Samba4: smbcontrol all reload-config Validando a troca de tickets do Kerberos: kinit Administrator@ESHARKNET.EDU klist Consultando servi\u00e7os do kerberos e do ldap : host -t srv _kerberos._tcp.ESHARKNET.edu host -t srv _ldap._tcp.ESHARKNET.edu dig ESHARKNET.edu host -t A firewall Agora \u00e9 s\u00f3 instalar as ferramentas do rsat em uma m\u00e1quina Windows e gerenciar o Servidor! THAT\u2019S ALL FOLKS!! Acessando os Compartilhamentos Agora voc\u00ea pode acessar os compartilhamentos de outros computadores na rede: No Windows: Abra o Explorer e digite \\IP_DO_SERVIDOR na barra de endere\u00e7os No Linux: Abra o gerenciador de arquivos e digite smb://IP_DO_SERVIDOR na barra de endere\u00e7os (Substitua IP_DO_SERVIDOR pelo endere\u00e7o IP do seu servidor Linux.) Conclus\u00e3o Voc\u00ea configurou com sucesso um servidor Samba com tr\u00eas compartilhamentos diferentes: Estoque: Acess\u00edvel apenas para usu\u00e1rios autenticados Gestao: Acess\u00edvel apenas para usu\u00e1rios autenticados Publico: Acess\u00edvel para qualquer usu\u00e1rio, incluindo convidados Lembre-se de ajustar as configura\u00e7\u00f5es de firewall se necess\u00e1rio para permitir o tr\u00e1fego SMB na sua rede. Thats All Folk's","title":"SAMBA4 - Fileserver sem gerenciamento por RSAT"},{"location":"Fileserver_sem_RSAT/#samba4-fileserver-sem-gerenciamento-por-rsat","text":"","title":"SAMBA4 - Fileserver sem gerenciamento por RSAT"},{"location":"Fileserver_sem_RSAT/#tutorial-configuracao-de-compartilhamento-smb-no-linux","text":"Este tutorial ir\u00e1 gui\u00e1-lo atrav\u00e9s do processo de configura\u00e7\u00e3o de um servidor Samba em um ambiente Linux. ## Instala\u00e7\u00e3o do Samba Primeiro, atualize a lista de pacotes e instale o Samba: sudo apt update sudo apt install samba -y","title":"Tutorial: Configura\u00e7\u00e3o de Compartilhamento SMB no Linux"},{"location":"Fileserver_sem_RSAT/#criando-usuarios-e-diretorios","text":"sudo adduser suporte Criar diret\u00f3rios para compartilhamento sudo mkdir -p /home/samba/estoque sudo mkdir -p /home/samba/gestao sudo mkdir -p /home/samba/publico Ajustar permiss\u00f5es dos diret\u00f3rios sudo chmod -R 770 /home/samba/estoque sudo chmod -R 770 /home/samba/gestao sudo chmod -R 777 /home/samba/publico sudo chown -R root:users /home/samba/estoque sudo chown -R root:users /home/samba/gestao sudo chown -R nobody:nogroup /home/samba/publico","title":"Criando Usu\u00e1rios e Diret\u00f3rios"},{"location":"Fileserver_sem_RSAT/#configurando-o-samba","text":"Fazer backup do arquivo de configura\u00e7\u00e3o original sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bak Editar o arquivo de configura\u00e7\u00e3o sudo nano /etc/samba/smb.conf Adicione as seguintes configura\u00e7\u00f5es ao final do arquivo: [global] workgroup = WORKGROUP server string = Servidor Samba security = user map to guest = bad user dns proxy = no [Estoque] comment = Diret\u00f3rio de Estoque path = /home/samba/estoque browsable = yes writable = yes valid users = @users create mask = 0770 directory mask = 0770 [Gestao] comment = Diret\u00f3rio de Gest\u00e3o path = /home/samba/gestao browsable = yes writable = yes valid users = @users create mask = 0770 directory mask = 0770 [Publico] comment = Diret\u00f3rio P\u00fablico path = /home/samba/publico browsable = yes writable = yes guest ok = yes create mask = 0777 directory mask = 0777","title":"Configurando o Samba"},{"location":"Fileserver_sem_RSAT/#adicionando-usuarios-ao-samba","text":"Adicione o usu\u00e1rio criado anteriormente ao Samba: sudo smbpasswd -a suporte Voc\u00ea ser\u00e1 solicitado a definir uma senha para o acesso Samba.","title":"Adicionando Usu\u00e1rios ao Samba"},{"location":"Fileserver_sem_RSAT/#reiniciando-e-testando-o-servico","text":"sudo systemctl restart smbd sudo systemctl restart nmbd sudo systemctl status smbd Testar a configura\u00e7\u00e3o testparm","title":"Reiniciando e Testando o Servi\u00e7o"},{"location":"Fileserver_sem_RSAT/#revisando-usuarios-e-grupos","text":"cat /etc/passwd # ( usu\u00e1rios locais do Linux gerencia do LDAP ) samba-tool user list # ( usu\u00e1rios de rede gerenciados pelo SAMBA4 )","title":"Revisando usu\u00e1rios e grupos:"},{"location":"Fileserver_sem_RSAT/#outras-validacoes-no-dominio","text":"wbinfo -u wbinfo -g wbinfo --ping-dc getent group \u201cDomain Admins\u201d","title":"Outras valida\u00e7\u00f5es no dom\u00ednio:"},{"location":"Fileserver_sem_RSAT/#verificando-servico-ativo","text":"ps aux | grep samba ps ax | egrep \"samba|smbd|nmbd|winbindd\" ps axf","title":"Verificando servi\u00e7o ativo:"},{"location":"Fileserver_sem_RSAT/#consultando-o-servidor","text":"testparm smbclient --version smbclient -L localhost -U% samba-tool domain level show","title":"Consultando o Servidor:"},{"location":"Fileserver_sem_RSAT/#desabilitando-a-complexidade-de-senhas-inseguro","text":"samba-tool domain passwordsettings show samba-tool domain passwordsettings set --complexity=off samba-tool domain passwordsettings set --history-length=0 samba-tool domain passwordsettings set --min-pwd-length=0 samba-tool domain passwordsettings set --min-pwd-age=0 samba-tool user setexpiry Administrator --noexpiry","title":"Desabilitando a complexidade de senhas (INSEGURO!):"},{"location":"Fileserver_sem_RSAT/#relendo-as-configuracoes-do-samba4","text":"smbcontrol all reload-config","title":"Relendo as configura\u00e7\u00f5es do Samba4:"},{"location":"Fileserver_sem_RSAT/#validando-a-troca-de-tickets-do-kerberos","text":"kinit Administrator@ESHARKNET.EDU klist","title":"Validando a troca de tickets do Kerberos:"},{"location":"Fileserver_sem_RSAT/#consultando-servicos-do-kerberos-e-do-ldap","text":"host -t srv _kerberos._tcp.ESHARKNET.edu host -t srv _ldap._tcp.ESHARKNET.edu dig ESHARKNET.edu host -t A firewall","title":"Consultando servi\u00e7os do kerberos e do ldap:"},{"location":"Fileserver_sem_RSAT/#agora-e-so-instalar-as-ferramentas-do-rsat-em-uma-maquina-windows-e-gerenciar-o-servidor","text":"THAT\u2019S ALL FOLKS!!","title":"Agora \u00e9 s\u00f3 instalar as ferramentas do rsat em uma m\u00e1quina Windows e gerenciar o Servidor!"},{"location":"Fileserver_sem_RSAT/#acessando-os-compartilhamentos","text":"Agora voc\u00ea pode acessar os compartilhamentos de outros computadores na rede: No Windows: Abra o Explorer e digite \\IP_DO_SERVIDOR na barra de endere\u00e7os No Linux: Abra o gerenciador de arquivos e digite smb://IP_DO_SERVIDOR na barra de endere\u00e7os (Substitua IP_DO_SERVIDOR pelo endere\u00e7o IP do seu servidor Linux.) Conclus\u00e3o Voc\u00ea configurou com sucesso um servidor Samba com tr\u00eas compartilhamentos diferentes: Estoque: Acess\u00edvel apenas para usu\u00e1rios autenticados Gestao: Acess\u00edvel apenas para usu\u00e1rios autenticados Publico: Acess\u00edvel para qualquer usu\u00e1rio, incluindo convidados Lembre-se de ajustar as configura\u00e7\u00f5es de firewall se necess\u00e1rio para permitir o tr\u00e1fego SMB na sua rede. Thats All Folk's","title":"Acessando os Compartilhamentos"},{"location":"Firewall_Server/","text":"\ud83d\udcc1 Firewall Server Criando um Servidor de Firewall Esta m\u00e1quina est\u00e1 equipada com 2 placas de rede (enp1s0 e enp7s0): Editando as placas de redes e setando ip fixo: vim /etc/network/interfaces # The primary network interface allow-hotplug enp1s0 iface enp1s0 inet static address 192.168.122.254 network 192.168.122.0 netmask 255.255.255.0 gateway 192.168.122.1 dns-nameserver 192.168.122.1 # The secundary network interface allow-hotplug enp7s0 iface enp7s0 inet static address 192.168.70.254 network 192.168.70.0 netmask 255.255.255.0 Editando o resolvedor de nomes: vim /etc/resolv.conf domain esharknet.edu search esharknet.edu. nameserver 192.168.122.1 #(Roteador) Habilitando o roteamento atrav\u00e9s do Kernel: vim /etc/sysctl.d/sysctl.conf net.ipv4.ip_forward=1 sysctl -p /etc/sysctl.d/sysctl.conf /etc/init.d/procps restart Instala\u00e7\u00e3o do pacote do iptables: apt remove nftables && apt-get install iptables Criando o arquivo com as regras: vim /usr/local/bin/firewall ########################################### ## Firewall Projeto Officinas ## ## eduardo.charquero@gmail.com ## ## vers\u00e3o 05.2025 ## ## Licen\u00e7a GPL3 ## ########################################### #!/usr/bin/env bash # enp0s8 = PLACA EXTERNA # enp0s3 = PLACA INTERNA # CARREGANDO M\u00d3DULOS DO KERNEL: modprobe iptable_nat modprobe iptable_mangle modprobe iptable_filter # LIMPANDO AS CADEIAS DO NETFILTER: iptables -F iptables -t nat -F iptables -t mangle -F iptables -t filter -F # PERMITE RETORNO DE CONEX\u00d5ES J\u00c1 ENCAMINHADAS: iptables -A INPUT -m state --state ESTABLISHED,RELATED,NEW -j ACCEPT iptables -A OUTPUT -m state --state ESTABLISHED,RELATED,NEW -j ACCEPT iptables -A FORWARD -m state --state ESTABLISHED,RELATED,NEW -j ACCEPT # BLOQUEANDO ACESSO AO FIREWALL: iptables -P INPUT DROP # BLOQUEANDO SA\u00cdDA DO FIREWALL: iptables -P OUTPUT DROP # BLOQUEANDO PASSAGENS PELO FIREWALL: iptables -P FORWARD DROP # ATIVANDO MASCARAMENTO DA REDE INTERNA: iptables -t nat -A POSTROUTING -s 192.168.70.0/24 -o enp0s3 -j MASQUERADE # LIBERANDO ACESSO POR SSH NO FIREWALL: iptables -I INPUT -p tcp -d 192.168.70.254 -s 192.168.70.0/24 --dport 22254 -j ACCEPT # TESTES DE REJECT E DROP # iptables -I INPUT -p tcp -d 192.168.70.254 -s 192.168.70.0/24 --dport 22254 -j REJECT # iptables -I INPUT -p tcp -d 192.168.70.254 -s 192.168.70.0/24 --dport 22254 -j DROP # LIBERANDO O PING PARA O FIREWALL: iptables -A INPUT -p icmp --icmp-type ping -j ACCEPT # TESTES DE REJECT E DROP # iptables -A INPUT -p icmp --icmp-type ping -j REJECT # iptables -A INPUT -p icmp --icmp-type ping -j DROP # LIBERANDO INTERNET PARA O FIREWALL: iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT iptables -A OUTPUT -p tcp --dport 443 -j ACCEPT iptables -A OUTPUT -p tcp --dport 53 -j ACCEPT iptables -A OUTPUT -p udp --dport 53 -j ACCEPT # LIBERANDO INTERNET PARA PASSAGEM DA REDE: iptables -A FORWARD -p tcp --dport 80 -j ACCEPT iptables -A FORWARD -p tcp --dport 443 -j ACCEPT iptables -A FORWARD -p tcp --dport 53 -j ACCEPT iptables -A FORWARD -p udp --dport 53 -j ACCEPT # REDIRECT SSH PARA DCMASTER: iptables -t nat -A PREROUTING -p tcp -s 0/0 -d 192.168.0.254 --dport 22250 -j DNAT --to 192.168.70.250:22250 iptables -t filter -A FORWARD -p tcp -s 0/0 -d 192.168.70.250 --dport 22250 -j ACCEPT # REDIRECT SSH PARA ARQUIVOS: iptables -t nat -A PREROUTING -p tcp -s 0/0 -d 192.168.0.254 --dport 22200 -j DNAT --to 192.168.70.200:22200 iptables -t filter -A FORWARD -p tcp -s 0/0 -d 192.168.70.200 --dport 22200 -j ACCEPT # Liberando RDP: iptables -A FORWARD -p tcp --dport 3389 -j ACCEPT iptables -t nat -A PREROUTING -i enp0s8 -p tcp --dport 3389 -j DNAT --to 192.168.70.171:3389 # Redirect da rede interna pra porta do Squid: #iptables -A FORWARD -p tcp --dport 80 -j DROP #iptables -A FORWARD -p tcp --dport 443 -j DROP #iptables -t nat -A PREROUTING -i enp7s0 -p tcp --dport 80 -j REDIRECT --to-port 3128 Setando permiss\u00e3o de execu\u00e7\u00e3o ao Shell-script e executando: chmod +x /usr/local/bin/firewall sh /usr/local/bin/firewall Salvando as regras do iptables: apt-get install iptables-persistent iptables-save > /etc/iptables/rules.v4 /etc/init.d/netfilter-persistent restart systemctl is-enabled netfilter-persistent.service systemctl enable netfilter-persistent.service systemctl status netfilter-persistent.service that's all folks!","title":"\ud83d\udcc1 Firewall Server"},{"location":"Firewall_Server/#firewall-server","text":"","title":"\ud83d\udcc1 Firewall Server"},{"location":"Firewall_Server/#criando-um-servidor-de-firewall","text":"","title":"Criando um Servidor de Firewall"},{"location":"Firewall_Server/#esta-maquina-esta-equipada-com-2-placas-de-rede-enp1s0-e-enp7s0","text":"","title":"Esta m\u00e1quina est\u00e1 equipada com 2 placas de rede (enp1s0 e enp7s0):"},{"location":"Firewall_Server/#editando-as-placas-de-redes-e-setando-ip-fixo","text":"vim /etc/network/interfaces # The primary network interface allow-hotplug enp1s0 iface enp1s0 inet static address 192.168.122.254 network 192.168.122.0 netmask 255.255.255.0 gateway 192.168.122.1 dns-nameserver 192.168.122.1 # The secundary network interface allow-hotplug enp7s0 iface enp7s0 inet static address 192.168.70.254 network 192.168.70.0 netmask 255.255.255.0","title":"Editando as placas de redes e setando ip fixo:"},{"location":"Firewall_Server/#editando-o-resolvedor-de-nomes","text":"vim /etc/resolv.conf domain esharknet.edu search esharknet.edu. nameserver 192.168.122.1 #(Roteador)","title":"Editando o resolvedor de nomes:"},{"location":"Firewall_Server/#habilitando-o-roteamento-atraves-do-kernel","text":"vim /etc/sysctl.d/sysctl.conf net.ipv4.ip_forward=1 sysctl -p /etc/sysctl.d/sysctl.conf /etc/init.d/procps restart","title":"Habilitando o roteamento atrav\u00e9s do Kernel:"},{"location":"Firewall_Server/#instalacao-do-pacote-do-iptables","text":"apt remove nftables && apt-get install iptables","title":"Instala\u00e7\u00e3o do pacote do iptables:"},{"location":"Firewall_Server/#criando-o-arquivo-com-as-regras","text":"vim /usr/local/bin/firewall ########################################### ## Firewall Projeto Officinas ## ## eduardo.charquero@gmail.com ## ## vers\u00e3o 05.2025 ## ## Licen\u00e7a GPL3 ## ########################################### #!/usr/bin/env bash # enp0s8 = PLACA EXTERNA # enp0s3 = PLACA INTERNA # CARREGANDO M\u00d3DULOS DO KERNEL: modprobe iptable_nat modprobe iptable_mangle modprobe iptable_filter # LIMPANDO AS CADEIAS DO NETFILTER: iptables -F iptables -t nat -F iptables -t mangle -F iptables -t filter -F # PERMITE RETORNO DE CONEX\u00d5ES J\u00c1 ENCAMINHADAS: iptables -A INPUT -m state --state ESTABLISHED,RELATED,NEW -j ACCEPT iptables -A OUTPUT -m state --state ESTABLISHED,RELATED,NEW -j ACCEPT iptables -A FORWARD -m state --state ESTABLISHED,RELATED,NEW -j ACCEPT # BLOQUEANDO ACESSO AO FIREWALL: iptables -P INPUT DROP # BLOQUEANDO SA\u00cdDA DO FIREWALL: iptables -P OUTPUT DROP # BLOQUEANDO PASSAGENS PELO FIREWALL: iptables -P FORWARD DROP # ATIVANDO MASCARAMENTO DA REDE INTERNA: iptables -t nat -A POSTROUTING -s 192.168.70.0/24 -o enp0s3 -j MASQUERADE # LIBERANDO ACESSO POR SSH NO FIREWALL: iptables -I INPUT -p tcp -d 192.168.70.254 -s 192.168.70.0/24 --dport 22254 -j ACCEPT # TESTES DE REJECT E DROP # iptables -I INPUT -p tcp -d 192.168.70.254 -s 192.168.70.0/24 --dport 22254 -j REJECT # iptables -I INPUT -p tcp -d 192.168.70.254 -s 192.168.70.0/24 --dport 22254 -j DROP # LIBERANDO O PING PARA O FIREWALL: iptables -A INPUT -p icmp --icmp-type ping -j ACCEPT # TESTES DE REJECT E DROP # iptables -A INPUT -p icmp --icmp-type ping -j REJECT # iptables -A INPUT -p icmp --icmp-type ping -j DROP # LIBERANDO INTERNET PARA O FIREWALL: iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT iptables -A OUTPUT -p tcp --dport 443 -j ACCEPT iptables -A OUTPUT -p tcp --dport 53 -j ACCEPT iptables -A OUTPUT -p udp --dport 53 -j ACCEPT # LIBERANDO INTERNET PARA PASSAGEM DA REDE: iptables -A FORWARD -p tcp --dport 80 -j ACCEPT iptables -A FORWARD -p tcp --dport 443 -j ACCEPT iptables -A FORWARD -p tcp --dport 53 -j ACCEPT iptables -A FORWARD -p udp --dport 53 -j ACCEPT # REDIRECT SSH PARA DCMASTER: iptables -t nat -A PREROUTING -p tcp -s 0/0 -d 192.168.0.254 --dport 22250 -j DNAT --to 192.168.70.250:22250 iptables -t filter -A FORWARD -p tcp -s 0/0 -d 192.168.70.250 --dport 22250 -j ACCEPT # REDIRECT SSH PARA ARQUIVOS: iptables -t nat -A PREROUTING -p tcp -s 0/0 -d 192.168.0.254 --dport 22200 -j DNAT --to 192.168.70.200:22200 iptables -t filter -A FORWARD -p tcp -s 0/0 -d 192.168.70.200 --dport 22200 -j ACCEPT # Liberando RDP: iptables -A FORWARD -p tcp --dport 3389 -j ACCEPT iptables -t nat -A PREROUTING -i enp0s8 -p tcp --dport 3389 -j DNAT --to 192.168.70.171:3389 # Redirect da rede interna pra porta do Squid: #iptables -A FORWARD -p tcp --dport 80 -j DROP #iptables -A FORWARD -p tcp --dport 443 -j DROP #iptables -t nat -A PREROUTING -i enp7s0 -p tcp --dport 80 -j REDIRECT --to-port 3128","title":"Criando o arquivo com as regras:"},{"location":"Firewall_Server/#setando-permissao-de-execucao-ao-shell-script-e-executando","text":"chmod +x /usr/local/bin/firewall sh /usr/local/bin/firewall","title":"Setando permiss\u00e3o de execu\u00e7\u00e3o ao Shell-script e executando:"},{"location":"Firewall_Server/#salvando-as-regras-do-iptables","text":"apt-get install iptables-persistent iptables-save > /etc/iptables/rules.v4 /etc/init.d/netfilter-persistent restart systemctl is-enabled netfilter-persistent.service systemctl enable netfilter-persistent.service systemctl status netfilter-persistent.service that's all folks!","title":"Salvando as regras do iptables:"},{"location":"Mkdocs_Server/","text":"\ud83d\udcc1 Servidor de documenta\u00e7\u00e3o MkDocs MkDocs \u00e9 um gerador de site est\u00e1tico r\u00e1pido, simples e absolutamente lindo que \u00e9 voltado para a documenta\u00e7\u00e3o do projeto de constru\u00e7\u00e3o. Os arquivos de origem da documenta\u00e7\u00e3o s\u00e3o gravados em Markdown e configurados com um \u00fanico arquivo de configura\u00e7\u00e3o YAML. Setando e validando o hostname do Servidor MkDocs: hostnamectl set-hostname mkdocs Configurando o arquivo de hosts: vim /etc/hosts .0.0.1 localhost 127.0.1.1 mkdocs.officinas.edu mkdocs 192.168.70.150 fileserver.officinas.edu fileserver 192.168.70.200 dcslave.officinas.edu dcslave 192.168.70.222 mkdocs.officinas.edu mkdocs 192.168.70.250 dcmaster.officinas.edu dcmaster 192.168.70.254 firewall.officinas.edu firewall hostname -f Setando ip fixo no servidor dcmaster: vim /etc/network/interfaces iface enp1s0 inet static address 192.168.70.222 netmask 255.255.255.0 gateway 192.168.70.254 dns-nameserver 192.168.70.254 #(firewall) dns-search officinas.edu Setando endere\u00e7o do firewall como resolvedor externo: vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.254 #(firewall) Validando o ip da placa: ip -c addr ip -br link Instala\u00e7\u00e3o dos pacotes necess\u00e1rios ao Debian: apt install wget net-tools tree python3-pip vim Instala\u00e7\u00e3o dos pacotes do MkDocs: apt install mkdocs mkdocs-material-extensions mkdocs-nature mkdocs-click Validando vers\u00e3o do pacote: mkdocs --version Criando um novo projeto: cd /opt/ mkdocs new mkdocs cd /opt/mkdocs Valide a cria\u00e7\u00e3o da estrutura: tree \u251c\u2500\u2500 docs \u2502 \u2514\u2500\u2500 index.md \u251c\u2500\u2500 mkdocs.yml \u2514\u2500\u2500 site \u251c\u2500\u2500 404.html \u251c\u2500\u2500 css \u2502 \u251c\u2500\u2500 base.css \u2502 \u251c\u2500\u2500 bootstrap.min.css \u2502 \u2514\u2500\u2500 font-awesome.min.css \u251c\u2500\u2500 fonts \u2502 \u251c\u2500\u2500 FontAwesome.otf \u2502 \u251c\u2500\u2500 fontawesome-webfont.eot \u2502 \u251c\u2500\u2500 fontawesome-webfont.svg \u2502 \u251c\u2500\u2500 fontawesome-webfont.ttf \u2502 \u251c\u2500\u2500 fontawesome-webfont.woff \u2502 \u2514\u2500\u2500 fontawesome-webfont.woff2 \u251c\u2500\u2500 img \u2502 \u251c\u2500\u2500 favicon.ico \u2502 \u2514\u2500\u2500 grid.png \u251c\u2500\u2500 index.html \u251c\u2500\u2500 js \u2502 \u251c\u2500\u2500 base.js \u2502 \u251c\u2500\u2500 bootstrap.min.js \u2502 \u2514\u2500\u2500 jquery-1.10.2.min.js \u251c\u2500\u2500 search \u2502 \u251c\u2500\u2500 lunr.js \u2502 \u251c\u2500\u2500 main.js \u2502 \u251c\u2500\u2500 search_index.json \u2502 \u2514\u2500\u2500 worker.js \u251c\u2500\u2500 sitemap.xml \u2514\u2500\u2500 sitemap.xml.gz Valida o ip do Servidor: ip -c addr Inicia o Servidor: mkdocs serve -a 192.168.70.222:8000 INFO - Building documentation... INFO - Cleaning site directory INFO - Documentation built in 0.05 seconds INFO - [10:41:22] Serving on http://192.168.70.222:8000/ Agora abra no seu navegador o endere\u00e7o: http://192.168.70.222:8000 Edite o arquivo de configura\u00e7\u00e3o principal: vim /opt/mkdocs/mkdocs.yml site_name: Officina's theme: name: readthedocs Restart do Servi\u00e7o: systemctl restart mkdocs Agora vamos criar 2 arquivos de exemplo, \"Sobre.md\" e \"Instala\u00e7\u00e3o.md\": vim /opt/mkdocs/docs/sobre.md # Markdown ## O que \u00e9 Markdown ? Markdown \u00e9 uma linguagem de marca\u00e7\u00e3o leve com sintaxe de formata\u00e7\u00e3o de texto simples projetada para que ela possa ser convertida em HTML e muitos outros formatos usando uma ferramenta com o mesmo nome. Markdown \u00e9 usado frequentemente para formatar arquivos readme, para escrever mensagens em f\u00f3runs de discuss\u00e3o on-line e para criar texto rico usando um editor de texto simples. ## Porque usar Markdown? * **F\u00c1CIL** : A sintaxe \u00e9 t\u00e3o f\u00e1cil que voc\u00ea pode aprender em um minuto ou dois, em seguida, escreva sem perceber nada estranho ou nerd. * **R\u00c1PIDO** : Ele economiza tempo em compara\u00e7\u00e3o com outros tipos de arquivos / formatos de texto. Isso ajuda a aumentar a produtividade e os fluxos de trabalho do escritor. * **LIMPO** : Tanto a sintaxe como a sa\u00edda s\u00e3o limpas, sem confus\u00e3o com nossos olhos e simples de gerenciar. * **FLEX\u00cdVEL** : Com apenas algumas configura\u00e7\u00f5es, o seu texto ser\u00e1 traduzido atravessando qualquer plataforma l\u00e1 fora, edit\u00e1vel em qualquer software de edi\u00e7\u00e3o de texto e convers\u00edvel para uma ampla variedade de formatos. **Em resumo**, os usu\u00e1rios comuns achar\u00e3o \u00fatil em todos os casos, especialmente quando voc\u00ea precisar de algo melhor que o texto simples, mas menos funcional do que o Microsoft Word. **Para desenvolvedores**, Se voc\u00ea \u00e9 pregui\u00e7oso para escrever c\u00f3digo HTML, voc\u00ea vai adorar o markdown. **Al\u00e9m disso**, **Github** e muitos sites favorecem o markdown para o arquivo readme de projetos. Isso significa que voc\u00ea vai encontrar o markdown em sua vida de uma forma ou de outra. vim /opt/mkdocs/docs/instala\u00e7\u00e3o.md # apt install mkdocs # pip3 install mkdocs Crie um novo projeto chamado mkdocs e construa um novo site: ```bash # cd /opt/ # mkdocs new mkdocs # cd /opt/mkdocs # mkdocs build Inicie o servi\u00e7o: # mkdocs serve -a 192.168.70.222:8000 \u00c9 poss\u00edvel inserir figuras na documenta\u00e7\u00e3o, com a seguinte estrutura: ![Descri\u00e7\u00e3o da imagem](caminho/para/a/imagem.jpg) ou ![Descri\u00e7\u00e3o da imagem](URL_da_imagem) O MKDocs pode gerar conte\u00fado est\u00e1tico, para ser inserido no Apache Server ou NGINX Server: mkdocs build Vai criar um diret\u00f3rio chamado de site, que pode ser copiado para /var/www/html: cp -rv /opt/mkdocs/site /var/www/html Seta permiss\u00f5es no diret\u00f3rio: chown -R www-data:www-data /var/www/html chmod -R 755 /var/www/html Restart do Apache Server: systemctl restart apache2 Acesse pelo seu navegador Web favorito: http://192.168.70.251/site THAT\u2019S ALL FOLKS!!","title":"\ud83d\udcc1 Servidor de documenta\u00e7\u00e3o MkDocs"},{"location":"Mkdocs_Server/#servidor-de-documentacao-mkdocs","text":"MkDocs \u00e9 um gerador de site est\u00e1tico r\u00e1pido, simples e absolutamente lindo que \u00e9 voltado para a documenta\u00e7\u00e3o do projeto de constru\u00e7\u00e3o. Os arquivos de origem da documenta\u00e7\u00e3o s\u00e3o gravados em Markdown e configurados com um \u00fanico arquivo de configura\u00e7\u00e3o YAML.","title":"\ud83d\udcc1 Servidor de documenta\u00e7\u00e3o MkDocs"},{"location":"Mkdocs_Server/#setando-e-validando-o-hostname-do-servidor-mkdocs","text":"hostnamectl set-hostname mkdocs","title":"Setando e validando o hostname do Servidor MkDocs:"},{"location":"Mkdocs_Server/#configurando-o-arquivo-de-hosts","text":"vim /etc/hosts .0.0.1 localhost 127.0.1.1 mkdocs.officinas.edu mkdocs 192.168.70.150 fileserver.officinas.edu fileserver 192.168.70.200 dcslave.officinas.edu dcslave 192.168.70.222 mkdocs.officinas.edu mkdocs 192.168.70.250 dcmaster.officinas.edu dcmaster 192.168.70.254 firewall.officinas.edu firewall hostname -f","title":"Configurando o arquivo de hosts:"},{"location":"Mkdocs_Server/#setando-ip-fixo-no-servidor-dcmaster","text":"vim /etc/network/interfaces iface enp1s0 inet static address 192.168.70.222 netmask 255.255.255.0 gateway 192.168.70.254 dns-nameserver 192.168.70.254 #(firewall) dns-search officinas.edu","title":"Setando ip fixo no servidor dcmaster:"},{"location":"Mkdocs_Server/#setando-endereco-do-firewall-como-resolvedor-externo","text":"vim /etc/resolv.conf domain officinas.edu search officinas.edu. nameserver 192.168.70.254 #(firewall)","title":"Setando endere\u00e7o do firewall como resolvedor externo:"},{"location":"Mkdocs_Server/#validando-o-ip-da-placa","text":"ip -c addr ip -br link","title":"Validando o ip da placa:"},{"location":"Mkdocs_Server/#instalacao-dos-pacotes-necessarios-ao-debian","text":"apt install wget net-tools tree python3-pip vim","title":"Instala\u00e7\u00e3o dos pacotes necess\u00e1rios ao Debian:"},{"location":"Mkdocs_Server/#instalacao-dos-pacotes-do-mkdocs","text":"apt install mkdocs mkdocs-material-extensions mkdocs-nature mkdocs-click","title":"Instala\u00e7\u00e3o dos pacotes do MkDocs:"},{"location":"Mkdocs_Server/#validando-versao-do-pacote","text":"mkdocs --version","title":"Validando vers\u00e3o do pacote:"},{"location":"Mkdocs_Server/#criando-um-novo-projeto","text":"cd /opt/ mkdocs new mkdocs cd /opt/mkdocs","title":"Criando um novo projeto:"},{"location":"Mkdocs_Server/#valide-a-criacao-da-estrutura","text":"tree \u251c\u2500\u2500 docs \u2502 \u2514\u2500\u2500 index.md \u251c\u2500\u2500 mkdocs.yml \u2514\u2500\u2500 site \u251c\u2500\u2500 404.html \u251c\u2500\u2500 css \u2502 \u251c\u2500\u2500 base.css \u2502 \u251c\u2500\u2500 bootstrap.min.css \u2502 \u2514\u2500\u2500 font-awesome.min.css \u251c\u2500\u2500 fonts \u2502 \u251c\u2500\u2500 FontAwesome.otf \u2502 \u251c\u2500\u2500 fontawesome-webfont.eot \u2502 \u251c\u2500\u2500 fontawesome-webfont.svg \u2502 \u251c\u2500\u2500 fontawesome-webfont.ttf \u2502 \u251c\u2500\u2500 fontawesome-webfont.woff \u2502 \u2514\u2500\u2500 fontawesome-webfont.woff2 \u251c\u2500\u2500 img \u2502 \u251c\u2500\u2500 favicon.ico \u2502 \u2514\u2500\u2500 grid.png \u251c\u2500\u2500 index.html \u251c\u2500\u2500 js \u2502 \u251c\u2500\u2500 base.js \u2502 \u251c\u2500\u2500 bootstrap.min.js \u2502 \u2514\u2500\u2500 jquery-1.10.2.min.js \u251c\u2500\u2500 search \u2502 \u251c\u2500\u2500 lunr.js \u2502 \u251c\u2500\u2500 main.js \u2502 \u251c\u2500\u2500 search_index.json \u2502 \u2514\u2500\u2500 worker.js \u251c\u2500\u2500 sitemap.xml \u2514\u2500\u2500 sitemap.xml.gz","title":"Valide a cria\u00e7\u00e3o da estrutura:"},{"location":"Mkdocs_Server/#valida-o-ip-do-servidor","text":"ip -c addr","title":"Valida o ip do Servidor:"},{"location":"Mkdocs_Server/#inicia-o-servidor","text":"mkdocs serve -a 192.168.70.222:8000 INFO - Building documentation... INFO - Cleaning site directory INFO - Documentation built in 0.05 seconds INFO - [10:41:22] Serving on http://192.168.70.222:8000/","title":"Inicia o Servidor:"},{"location":"Mkdocs_Server/#agora-abra-no-seu-navegador-o-endereco","text":"http://192.168.70.222:8000","title":"Agora abra no seu navegador o endere\u00e7o:"},{"location":"Mkdocs_Server/#edite-o-arquivo-de-configuracao-principal","text":"vim /opt/mkdocs/mkdocs.yml site_name: Officina's theme: name: readthedocs","title":"Edite o arquivo de configura\u00e7\u00e3o principal:"},{"location":"Mkdocs_Server/#restart-do-servico","text":"systemctl restart mkdocs","title":"Restart do Servi\u00e7o:"},{"location":"Mkdocs_Server/#agora-vamos-criar-2-arquivos-de-exemplo-sobremd-e-instalacaomd","text":"vim /opt/mkdocs/docs/sobre.md # Markdown ## O que \u00e9 Markdown ? Markdown \u00e9 uma linguagem de marca\u00e7\u00e3o leve com sintaxe de formata\u00e7\u00e3o de texto simples projetada para que ela possa ser convertida em HTML e muitos outros formatos usando uma ferramenta com o mesmo nome. Markdown \u00e9 usado frequentemente para formatar arquivos readme, para escrever mensagens em f\u00f3runs de discuss\u00e3o on-line e para criar texto rico usando um editor de texto simples. ## Porque usar Markdown? * **F\u00c1CIL** : A sintaxe \u00e9 t\u00e3o f\u00e1cil que voc\u00ea pode aprender em um minuto ou dois, em seguida, escreva sem perceber nada estranho ou nerd. * **R\u00c1PIDO** : Ele economiza tempo em compara\u00e7\u00e3o com outros tipos de arquivos / formatos de texto. Isso ajuda a aumentar a produtividade e os fluxos de trabalho do escritor. * **LIMPO** : Tanto a sintaxe como a sa\u00edda s\u00e3o limpas, sem confus\u00e3o com nossos olhos e simples de gerenciar. * **FLEX\u00cdVEL** : Com apenas algumas configura\u00e7\u00f5es, o seu texto ser\u00e1 traduzido atravessando qualquer plataforma l\u00e1 fora, edit\u00e1vel em qualquer software de edi\u00e7\u00e3o de texto e convers\u00edvel para uma ampla variedade de formatos. **Em resumo**, os usu\u00e1rios comuns achar\u00e3o \u00fatil em todos os casos, especialmente quando voc\u00ea precisar de algo melhor que o texto simples, mas menos funcional do que o Microsoft Word. **Para desenvolvedores**, Se voc\u00ea \u00e9 pregui\u00e7oso para escrever c\u00f3digo HTML, voc\u00ea vai adorar o markdown. **Al\u00e9m disso**, **Github** e muitos sites favorecem o markdown para o arquivo readme de projetos. Isso significa que voc\u00ea vai encontrar o markdown em sua vida de uma forma ou de outra. vim /opt/mkdocs/docs/instala\u00e7\u00e3o.md # apt install mkdocs # pip3 install mkdocs Crie um novo projeto chamado mkdocs e construa um novo site: ```bash # cd /opt/ # mkdocs new mkdocs # cd /opt/mkdocs # mkdocs build","title":"Agora vamos criar 2 arquivos de exemplo, \"Sobre.md\" e \"Instala\u00e7\u00e3o.md\":"},{"location":"Mkdocs_Server/#inicie-o-servico","text":"# mkdocs serve -a 192.168.70.222:8000","title":"Inicie o servi\u00e7o:"},{"location":"Mkdocs_Server/#e-possivel-inserir-figuras-na-documentacao-com-a-seguinte-estrutura","text":"![Descri\u00e7\u00e3o da imagem](caminho/para/a/imagem.jpg)","title":"\u00c9 poss\u00edvel inserir figuras na documenta\u00e7\u00e3o, com a seguinte estrutura:"},{"location":"Mkdocs_Server/#ou","text":"![Descri\u00e7\u00e3o da imagem](URL_da_imagem)","title":"ou"},{"location":"Mkdocs_Server/#o-mkdocs-pode-gerar-conteudo-estatico-para-ser-inserido-no-apache-server-ou-nginx-server","text":"mkdocs build","title":"O MKDocs pode gerar conte\u00fado est\u00e1tico, para ser inserido no Apache Server ou NGINX Server:"},{"location":"Mkdocs_Server/#vai-criar-um-diretorio-chamado-de-site-que-pode-ser-copiado-para-varwwwhtml","text":"cp -rv /opt/mkdocs/site /var/www/html","title":"Vai criar um diret\u00f3rio chamado de site, que pode ser copiado para /var/www/html:"},{"location":"Mkdocs_Server/#seta-permissoes-no-diretorio","text":"chown -R www-data:www-data /var/www/html chmod -R 755 /var/www/html","title":"Seta permiss\u00f5es no diret\u00f3rio:"},{"location":"Mkdocs_Server/#restart-do-apache-server","text":"systemctl restart apache2","title":"Restart do Apache Server:"},{"location":"Mkdocs_Server/#acesse-pelo-seu-navegador-web-favorito","text":"http://192.168.70.251/site THAT\u2019S ALL FOLKS!!","title":"Acesse pelo seu navegador Web favorito:"},{"location":"Modulo_103.1-aula00/","text":"\ud83d\udc27 M\u00f3dulo 103.1 - AULA 00 COMANDOS B\u00c1SICOS DO TERMINAL LINUX NAVEGA\u00c7\u00c3O E MANIPULA\u00c7\u00c3O DE ARQUIVOS O COMANDO ls Lista os arquivos e diret\u00f3rios no diret\u00f3rio atual. O COMANDO cd Muda o diret\u00f3rio atual para o especificado. O COMANDO pwd Exibe o caminho completo do diret\u00f3rio atual. O COMANDO clear Limpa a tela do terminal. O COMANDO whoami Exibe o nome do usu\u00e1rio atual. O COMANDO touch Cria um arquivo vazio ou atualiza a data de modifica\u00e7\u00e3o de um arquivo existente. O COMANDO cat Concatena e exibe o conte\u00fado de um ou mais arquivos. O COMANDO tac Concatena e exibe o conte\u00fado de um ou mais arquivos em ordem inversa. O COMANDO cp Copia arquivos ou diret\u00f3rios. O COMANDO mv Move ou renomeia arquivos ou diret\u00f3rios. O COMANDO find Procura por arquivos e diret\u00f3rios em um diret\u00f3rio especificado. O COMANDO less Exibe o conte\u00fado de um arquivo uma p\u00e1gina por vez. O COMANDO grep Filtra um arquivo de texto buscando a express\u00e3o que voc\u00ea digitou. O COMANDO mkdir Cria um diret\u00f3rio vazio. O COMANDO rmdir Remove um diret\u00f3rio vazio. O COMANDO > Cria um arquivo vazio. O COMANDO rm Remove um arquivos. INFORMA\u00c7\u00d5ES DO SISTEMA O COMANDO hostname Exibe o nome do host do sistema. O COMANDO uname Exibe informa\u00e7\u00f5es sobre o sistema operacional. O COMANDO ip a Exibe informa\u00e7\u00f5es sobre as interfaces de rede. O COMANDO ping Envia pacotes ICMP ECHO_REQUEST para testar a conectividade de rede. O COMANDO free Exibe a quantidade de mem\u00f3ria livre e usada no sistema. O COMANDO top Exibe os processos em execu\u00e7\u00e3o e o uso de recursos do sistema em tempo real. O COMANDO df -h Exibe o uso de espa\u00e7o em disco em um formato leg\u00edvel por humanos. HIST\u00d3RICO O COMANDO history Exibe o hist\u00f3rico de comandos executados no terminal. DIRECIONADORES O DIRECIONADOR SIMPLES history > historico.txt Salva o hist\u00f3rico de comandos em um arquivo chamado historico.txt . O DIRECIONADOR DUPLO history >> historico2.txt Adiciona o hist\u00f3rico de comandos a um arquivo chamado historico2.txt sem sobrescrever o conte\u00fado existente. THAT\u2019S ALL FOLKS!!","title":"\ud83d\udc27 M\u00f3dulo 103.1 - AULA 00"},{"location":"Modulo_103.1-aula00/#modulo-1031-aula-00","text":"","title":"\ud83d\udc27 M\u00f3dulo 103.1 - AULA 00"},{"location":"Modulo_103.1-aula00/#comandos-basicos-do-terminal-linux","text":"","title":"COMANDOS B\u00c1SICOS DO TERMINAL LINUX"},{"location":"Modulo_103.1-aula00/#navegacao-e-manipulacao-de-arquivos","text":"","title":"NAVEGA\u00c7\u00c3O E MANIPULA\u00c7\u00c3O DE ARQUIVOS"},{"location":"Modulo_103.1-aula00/#o-comandols","text":"Lista os arquivos e diret\u00f3rios no diret\u00f3rio atual.","title":"O COMANDOls"},{"location":"Modulo_103.1-aula00/#o-comando-cd","text":"Muda o diret\u00f3rio atual para o especificado.","title":"O COMANDO cd"},{"location":"Modulo_103.1-aula00/#o-comando-pwd","text":"Exibe o caminho completo do diret\u00f3rio atual.","title":"O COMANDO pwd"},{"location":"Modulo_103.1-aula00/#o-comando-clear","text":"Limpa a tela do terminal.","title":"O COMANDO clear"},{"location":"Modulo_103.1-aula00/#o-comando-whoami","text":"Exibe o nome do usu\u00e1rio atual.","title":"O COMANDO whoami"},{"location":"Modulo_103.1-aula00/#o-comando-touch","text":"Cria um arquivo vazio ou atualiza a data de modifica\u00e7\u00e3o de um arquivo existente.","title":"O COMANDO touch"},{"location":"Modulo_103.1-aula00/#o-comando-cat","text":"Concatena e exibe o conte\u00fado de um ou mais arquivos.","title":"O COMANDO cat"},{"location":"Modulo_103.1-aula00/#o-comando-tac","text":"Concatena e exibe o conte\u00fado de um ou mais arquivos em ordem inversa.","title":"O COMANDO tac"},{"location":"Modulo_103.1-aula00/#o-comando-cp","text":"Copia arquivos ou diret\u00f3rios.","title":"O COMANDO cp"},{"location":"Modulo_103.1-aula00/#o-comando-mv","text":"Move ou renomeia arquivos ou diret\u00f3rios.","title":"O COMANDO mv"},{"location":"Modulo_103.1-aula00/#o-comando-find","text":"Procura por arquivos e diret\u00f3rios em um diret\u00f3rio especificado.","title":"O COMANDO find"},{"location":"Modulo_103.1-aula00/#o-comando-less","text":"Exibe o conte\u00fado de um arquivo uma p\u00e1gina por vez.","title":"O COMANDO less"},{"location":"Modulo_103.1-aula00/#o-comando-grep","text":"Filtra um arquivo de texto buscando a express\u00e3o que voc\u00ea digitou.","title":"O COMANDO grep"},{"location":"Modulo_103.1-aula00/#o-comando-mkdir","text":"Cria um diret\u00f3rio vazio.","title":"O COMANDO mkdir"},{"location":"Modulo_103.1-aula00/#o-comando-rmdir","text":"Remove um diret\u00f3rio vazio.","title":"O COMANDO rmdir"},{"location":"Modulo_103.1-aula00/#o-comando","text":"Cria um arquivo vazio.","title":"O COMANDO &gt;"},{"location":"Modulo_103.1-aula00/#o-comando-rm","text":"Remove um arquivos.","title":"O COMANDO rm"},{"location":"Modulo_103.1-aula00/#informacoes-do-sistema","text":"","title":"INFORMA\u00c7\u00d5ES DO SISTEMA"},{"location":"Modulo_103.1-aula00/#o-comando-hostname","text":"Exibe o nome do host do sistema.","title":"O COMANDO hostname"},{"location":"Modulo_103.1-aula00/#o-comando-uname","text":"Exibe informa\u00e7\u00f5es sobre o sistema operacional.","title":"O COMANDO uname"},{"location":"Modulo_103.1-aula00/#o-comando-ip-a","text":"Exibe informa\u00e7\u00f5es sobre as interfaces de rede.","title":"O COMANDO ip a"},{"location":"Modulo_103.1-aula00/#o-comando-ping","text":"Envia pacotes ICMP ECHO_REQUEST para testar a conectividade de rede.","title":"O COMANDO ping"},{"location":"Modulo_103.1-aula00/#o-comando-free","text":"Exibe a quantidade de mem\u00f3ria livre e usada no sistema.","title":"O COMANDO free"},{"location":"Modulo_103.1-aula00/#o-comando-top","text":"Exibe os processos em execu\u00e7\u00e3o e o uso de recursos do sistema em tempo real.","title":"O COMANDO top"},{"location":"Modulo_103.1-aula00/#o-comando-df-h","text":"Exibe o uso de espa\u00e7o em disco em um formato leg\u00edvel por humanos.","title":"O COMANDO df -h"},{"location":"Modulo_103.1-aula00/#historico","text":"","title":"HIST\u00d3RICO"},{"location":"Modulo_103.1-aula00/#o-comando-history","text":"Exibe o hist\u00f3rico de comandos executados no terminal.","title":"O COMANDO history"},{"location":"Modulo_103.1-aula00/#direcionadores","text":"","title":"DIRECIONADORES"},{"location":"Modulo_103.1-aula00/#o-direcionador-simples-historyhistoricotxt","text":"Salva o hist\u00f3rico de comandos em um arquivo chamado historico.txt .","title":"O DIRECIONADOR SIMPLES history&gt;historico.txt"},{"location":"Modulo_103.1-aula00/#o-direcionador-duplo-historyhistorico2txt","text":"Adiciona o hist\u00f3rico de comandos a um arquivo chamado historico2.txt sem sobrescrever o conte\u00fado existente. THAT\u2019S ALL FOLKS!!","title":"O DIRECIONADOR DUPLO history&gt;&gt;historico2.txt"},{"location":"Modulo_103.1-aula01/","text":"\ud83d\udc27 M\u00f3dulo 103.1 - AULA 01 O SHELL sh, dash, bash, csh, zsh ... O shell \u00e9 uma interface ou ambiente de intera\u00e7\u00e3o entre o usu\u00e1rio e o kernel (ou n\u00facleo), que por sua vez, interage com o hardware, que o usu\u00e1rio n\u00e3o consegue fazer. HARDWARE <---> KERNEL <---> SHELL <---> USU\u00c1RIO Vamos analizar um comando importante nessa aula, o comando echo : O comando echo imprime na tela o que for digitado na tela. Exemplo: echo linux echo \"Debian Linux\" Podemos consultar informa\u00e7\u00f5es sobre esse comando com o manual ou com o help , do comando: help echo man echo VARI\u00c1VEIS Vari\u00e1veis s\u00e3o elementos que recebem e guardam um valor atribu\u00eddo a elas. VARI\u00c1VEIS != CONSTANTES Exemplo: senha=123 echo senha echo $senha senhas=\"123 321\" echo $senhas fruta=banana echo $fruta nota=10 echo $nota nomes=\"joao jose maria\" echo $nomes Note que o Shell tem suas pr\u00f3prias vari\u00e1veis de trabalho, que podem ser consultadas atrav\u00e9s do comando env e pelo comando set : env set Uma vari\u00e1vel pode receber a sa\u00edda de um comando do sistema, desde que esteja entre $() : Exemplo, lembra do comando whoami ? Vamos testar: QuemSouEu=$(whoami) echo $QuemSouEu Conteudo_Local=$(ls --color) echo $Conteudo_Local Expandindo o comando na execu\u00e7\u00e3o: fruta='echo abacaxi' echo $fruta != de fruta=$(echo abacaxi) echo $fruta Podemos criar vari\u00e1veis com: LETRAS MAI\u00daSCULAS e/ou MIN\u00daSCULAS e/ou N\u00daMEROS O \u00fanico caracter permitido na composi\u00e7\u00e3o de uma vari\u00e1vel \u00e9 o underline _ N\u00c3O podem conter acentos e N\u00c3O podem iniciar com n\u00fameros nem com qualquer outro caractere. cria_pasta=$(mkdir PASTA-DE-FOTOS) ls NOTE QUE SE EU ENTRAR EM OUTRA SESS\u00c3O DE SHELL ESSAS VARI\u00c1VEIS N\u00c3O CONSTAM: Exemplo de chamada para outra sess\u00e3o de terminal: bash echo $senhas echo $fruta echo $nota echo $QuemSouEu Fechando essa sess\u00e3o : exit Agora as vari\u00e1veis que criamos constam novamente: echo $senhas echo $fruta echo $nota echo $QuemSouEu A n\u00e3o ser que vc use o comando export , que faz com que a vari\u00e1vel que voc\u00ea criou, seja enviada para as vari\u00e1veis do Sistema: export fruta=kiwi env | grep fruta Vai estar vis\u00edvel para essa sess\u00e3o de bash e seus processos filhos, apenas! Caso queira \"DES-exportar\" unset fruta COMANDO read OU LEIA O comando read espera e armazena como vari\u00e1vel o valor que voc\u00ea digitar: read \"x\" caderno echo $x A vari\u00e1vel \u00e9 x read \"variavel14\" vassoura echo $variavel14 A vari\u00e1vel \u00e9 variavel14 read nota echo $nota A vari\u00e1vel \u00e9 nota Adicionando a op\u00e7\u00e3o -p de prompt , ele fica interativo (por\u00e9m vai precisar de uma vari\u00e1vel de armazenamento): read -p \"fruta\" echo $fruta Interage mas n\u00e3o armazenou nada, pois n\u00e3o criamos uma vari\u00e1vel! Agora vamos ler e armazenar uma vari\u00e1vel: read -p \"fruta\" var echo $var CUIDADO para n\u00e3o dar um echo em fruta , e sim em $var ! Vamos tentar de novo... read -p \"fruta: \" x echo $fruta ou echo $x ?? NOTE que deixamos um espa\u00e7o entre os : e \" unset fruta read -p \"Diga uma fruta: \" fruta echo $fruta Lendo uma vari\u00e1vel que armazena um nome: read -p \"Digite seu nome: \" x echo $x read -p \"Digite seu nome: \" y echo $y read -p \"Digite seu nome: \" nome echo $nome Lendo uma vari\u00e1vel que armazena uma nota: read -p \"Digite a nota do aluno: \" nota echo $nota OS COMANDOS BUILTIN ( Comandos Internos ) DO shell Podemos ver quais s\u00e3o os comandos internos ou builtins do shell com o help : help help <2xtab> help echo help pwd help cd NOTE que um help ls n\u00e3o retorna nada, pois o ls n\u00e3o \u00e9 um comando builtin . Tamb\u00e9m podemos comparar os comandos builtin e os comandos utilit\u00e1rios do sistema com o type : type cd type echo type ls type apt type mv Os comandos que N\u00c3O FOREM builtin , sempre ter\u00e3o sua localiza\u00e7\u00e3o PATH apontada. Os comandos builtin n\u00e3o tem esse apontamento. AS VARI\u00c1VEIS DE AMBIENTE EM USO PELO SISTEMA OPERACIONAl As vari\u00e1veis de ambiente s\u00e3o definidas sempre em caixa alta . Sendo mostradas pelos comandos set ou env : O comando utilit\u00e1rio env MOSTRA APENAS AS VAR\u00c1VEIS GLOBAIS E AS EXPORTADAS NA SESS\u00c3O. O builtin set mostra todas as vari\u00e1veis internas e globais , mesmo sem exportar. type env type set env | less set | less SHELL=/bin/bash LANGUAGE=pt_BR XCURSOR_SIZE=24 LOGNAME=mevorak HOME=/home/mevorak USER=mevorak HOSTNAME=mevorak PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games ... Podemos realizar buscas por vari\u00e1veis espec\u00edficas: echo $USER echo $SHELL echo $LANGUAGE O CONCEITO DE PATH OU CAMINHO Nos comandos dados ao bash , ele valida PRIMEIRO se \u00e9 um comando builtin , DEPOIS ele valida se \u00e9 um comando utilit\u00e1rio do sistema, da vari\u00e1vel PATH , DEPOIS ele imprime um erro de COMMAND NOT FOUND . bem l\u00f3gico! Exemplo:: meu_programa bash: meu_programa: comando n\u00e3o encontrado MAS eu posso criar um arquivo com esse nome e fazer virar um Shell script echo \"ls\" > meu_programa chmod +x meu_programa ./meuprograma Outros exemplos pr\u00e1ticos: echo \"echo Ol\u00e1 mundo\" > meu_programa echo mkdir PASTA_D > meu_programa Ou ent\u00e3o posso jogar o meu programa no PATH do Sistema: sudo mv meu_programa /usr/bin/ Agora ele consta nos comandos internos do Sistema e autocompleta com a tecla TAB : meu_prog 2x<TAB> A LINGUAGEM DO SHELL SCRIPT (Modo n\u00e3o interativo) Qual a vantagem de usar Shell script ? Bom, podemos usar comandos em lote, ao inv\u00e9s de um de cada vez! Exemplo: whoami hostname uptime -p uname -rms Imagine se tivesse que validar essas informa\u00e7\u00f5es a cada troca de turno, por exemplo. Sendo MUITO mais pr\u00e1tico, criar um Shell script com todos estes comandos para rodar de uma vez s\u00f3. Criando o arquivo: $ > informacoes.sh Inserindo os comandos nele: #! /usr/bin/env bash whoami hostname uptime -p uname -rms Setando permiss\u00e3o de execu\u00e7\u00e3o: chmod +x informacoes.sh Chamando o programa para rodar: ./informacoes.sh A linha #! /usr/bin/env bash informa ao Shell qual interpretador vai rodar o script, no caso, apontamos para o bash . Chamamos essa linha obrigat\u00f3ria inicial de Hashbang ou de Shebang , tanto faz. Na maioria dos casos o programador vai usar o caminho absoluto #!/bin/bash , para criar a hashbang ao inv\u00e9s de optar pelo environment (ambiente) env . Vamos criar um arquivo de Shell script que leia, guarde e imprima um nome: Criamos o arquivo: > seunome.sh Inserimos o conte\u00fado: #!/usr/bin/env bash read -p \"Digite seu nome: \" nome echo \"Ol\u00e1, $nome!\" Setamos a permiss\u00e3o de execu\u00e7\u00e3o: chmod +x seunome.sh Chamamos \u00e1 execu\u00e7\u00e3o: ./seunome Criemos outro Shell script que mostre a data e hora, hospedando no /opt e usando o editor vim : mkdir -p /opt/Meus_Programas/ vim /opt/Meus_Programa/Data_Hora #!/bin/bash echo \"Este \u00e9 um Script de Teste\" echo \" \" date echo \" \" echo \"Fim do Script\" Este script s\u00f3 roda se eu der permiss\u00e3o e rodar o comando \u00e1 partir do pr\u00f3prio diret\u00f3rio: chmod +x /opt/Meus_Programas/Data_Hora cd /opt/Meus_Programas/ ./Data_Hora #./ aponta diret\u00f3rio atual sh Data_Hora Ou bash Data_Hora Opcionalmente posso apontar o PATH completo no comando: bash /opt/Meuprograma/Data_Hora Tentar execut\u00e1-lo \u00e1 partir de outro diret\u00f3rio ser\u00e1 imposs\u00edvel! CAMINHO ABSOLUTO X CAMINHO RELATIVO: CAMINHO ABSOLUTO /opt/Meuprograma/Data_Hora CAMINHO RELATIVO cd /opt/ cd Meus_Programas/ cd Data_Hora A VARI\u00c1VEL PATH ( OU CAMINHO) Todo programa que roda no Terminal, est\u00e1 armazenado em algum lugar espec\u00edfico. Geralmente os scripts do Sistema operacional, ficam em /usr/bin/ , /usr/sbin , /bin , etc. Contudo, pra que eu n\u00e3o tenha que ficar digitando o caminho completo, toda vez em que for preciso rodar um programa, como por exemplo o navegador web Firefox , foi criada a vari\u00e1vel PATH , contendo os caminhos de busca, para uso do Sistema operacional. Temos dois modos de adicionar o caminho do diret\u00f3rio onde salvei meu script, \u00e1 vari\u00e1vel PATH , que \u00e9 onde o Terminal busca os programas, possibilitando com que ele conste, \u00e1 partir de qualquer diret\u00f3rio onde eu estiver. 1) MODO TRANSIT\u00d3RIO Leio o PATH padr\u00e3o: echo $PATH Adiciono meu pr\u00f3prio caminho \u00e1 ela: PATH=$PATH:/opt/Meus_Programas Leio novamente e ele est\u00e1 constando nela: echo $PATH 2) MODO DEFINITIVO Leio o PATH padr\u00e3o: echo $PATH Edito o pr\u00f3prio arquivo global do Sistema operacional, adicionando o caminho do meu programa: sudo vim /etc/profile PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/Meus_Programas\" For\u00e7o a reconfigura\u00e7\u00e3o para efetivar a altera\u00e7\u00e3o: sudo source /etc/profile Releio o PATH padr\u00e3o e j\u00e1 consta o /opt/Meus_Programas : echo $PATH Inclusive os comandos which ou whereis tb\u00e9m j\u00e1 encontram o meu programa : whereis Data_Hora which Data_Hora Respondendo \u00e1 tecla TAB para autocompletar o nome do programa : Data_H 2x<TAB> Data_Hora Alguns usu\u00e1rios preferem criar seus pr\u00f3prios diret\u00f3rios pessoais, ignorando a vari\u00e1vel Global /etc/profile , optando por usar a vari\u00e1vel local .bashrc , para armazenar seus pr\u00f3prios caminhos. Exemplo: Criamos o diretorio /home/usuario/Programas : mkdir ~/Programas Editamos a vari\u00e1vel local .bashrc : sudo vim ~/.bashrc Adicionamos um teste de execu\u00e7\u00e3o: if [ -d ~/Programas ] then PATH=$PATH:~/Programas fi Copia um script, como o seunome.sh para dentro desse diret\u00f3rio: cp seunome.sh /home/usuario/Programas/ For\u00e7amos a releitura da configura\u00e7\u00e3o da vari\u00e1vel de sistema : source .bashrc Procuramos o novo caminho na vari\u00e1vel PATH : env | grep PATH CRIANDO UM SCRIPT E SETANDO NO PATH DO SISTEMA Fa\u00e7a os seguintes testes: echo \"m\u00e1quina; hostname echo -n m\u00e1quina; hostname echo -n m\u00e1quina:; hostname ENT\u00c3O Criamos o script: vim ~/Programas/Informacoes Inserimos os comandos: #! /usr/bin/env bash # Informa\u00e7\u00f5es.sh # Vers\u00e3o 1.0 # Script para capturar informa\u00e7\u00f5es do Sistema # 02/25 # Eduardo Charquero clear echo \"\" echo \"VALIDANDO NFORMA\u00c7\u00d5ES LOCAIS:\" echo \"----------------------------------\" echo -n \"Usu\u00e1rio logado : \" whoami echo -n \"M\u00e1quina da rede: \" hostname echo -n \"Kernel em uso : \" uname -rms echo -n \"Tempo ligada : \" uptime -p echo \"----------------------------------\" echo \"\" Setamos permiss\u00e3o de execu\u00e7\u00e3o: chmod +x ~/Programas/Informacoes Mandamos o TAB autocompletar e o ENTER para rodar: Infor 2x<TAB> ENTER DICAS Locais interessantes de usar para reposit\u00f3rio de seus scripts pessoais: ~/.Programas /opt /usr/local/bin ATEN\u00c7\u00c3O!! N\u00c3O RODE COMANDOS OU SCRIPTS DE TERCEIROS ENCONTRADOS NA WEB, SEM SABER O QUE ELE DE FATO EST\u00c1 FAZENDO! CUIDADO COM O USO DE USU\u00c1RIO ROOT OU SUDO! Voc\u00ea foi avisado!! THAT\u2019S ALL FOLKS!!","title":"\ud83d\udc27 M\u00f3dulo 103.1 - AULA 01"},{"location":"Modulo_103.1-aula01/#modulo-1031-aula-01","text":"","title":"\ud83d\udc27 M\u00f3dulo 103.1 - AULA 01"},{"location":"Modulo_103.1-aula01/#o-shell","text":"","title":"O SHELL"},{"location":"Modulo_103.1-aula01/#sh-dash-bash-csh-zsh","text":"O shell \u00e9 uma interface ou ambiente de intera\u00e7\u00e3o entre o usu\u00e1rio e o kernel (ou n\u00facleo), que por sua vez, interage com o hardware, que o usu\u00e1rio n\u00e3o consegue fazer. HARDWARE <---> KERNEL <---> SHELL <---> USU\u00c1RIO Vamos analizar um comando importante nessa aula, o comando echo : O comando echo imprime na tela o que for digitado na tela. Exemplo: echo linux echo \"Debian Linux\" Podemos consultar informa\u00e7\u00f5es sobre esse comando com o manual ou com o help , do comando: help echo man echo","title":"sh, dash, bash, csh, zsh ..."},{"location":"Modulo_103.1-aula01/#variaveis","text":"Vari\u00e1veis s\u00e3o elementos que recebem e guardam um valor atribu\u00eddo a elas. VARI\u00c1VEIS != CONSTANTES Exemplo: senha=123 echo senha echo $senha senhas=\"123 321\" echo $senhas fruta=banana echo $fruta nota=10 echo $nota nomes=\"joao jose maria\" echo $nomes Note que o Shell tem suas pr\u00f3prias vari\u00e1veis de trabalho, que podem ser consultadas atrav\u00e9s do comando env e pelo comando set : env set Uma vari\u00e1vel pode receber a sa\u00edda de um comando do sistema, desde que esteja entre $() : Exemplo, lembra do comando whoami ? Vamos testar: QuemSouEu=$(whoami) echo $QuemSouEu Conteudo_Local=$(ls --color) echo $Conteudo_Local Expandindo o comando na execu\u00e7\u00e3o: fruta='echo abacaxi' echo $fruta != de fruta=$(echo abacaxi) echo $fruta Podemos criar vari\u00e1veis com: LETRAS MAI\u00daSCULAS e/ou MIN\u00daSCULAS e/ou N\u00daMEROS O \u00fanico caracter permitido na composi\u00e7\u00e3o de uma vari\u00e1vel \u00e9 o underline _ N\u00c3O podem conter acentos e N\u00c3O podem iniciar com n\u00fameros nem com qualquer outro caractere. cria_pasta=$(mkdir PASTA-DE-FOTOS) ls NOTE QUE SE EU ENTRAR EM OUTRA SESS\u00c3O DE SHELL ESSAS VARI\u00c1VEIS N\u00c3O CONSTAM: Exemplo de chamada para outra sess\u00e3o de terminal: bash echo $senhas echo $fruta echo $nota echo $QuemSouEu Fechando essa sess\u00e3o : exit Agora as vari\u00e1veis que criamos constam novamente: echo $senhas echo $fruta echo $nota echo $QuemSouEu A n\u00e3o ser que vc use o comando export , que faz com que a vari\u00e1vel que voc\u00ea criou, seja enviada para as vari\u00e1veis do Sistema: export fruta=kiwi env | grep fruta Vai estar vis\u00edvel para essa sess\u00e3o de bash e seus processos filhos, apenas! Caso queira \"DES-exportar\" unset fruta","title":"VARI\u00c1VEIS"},{"location":"Modulo_103.1-aula01/#comando-read-ou-leia","text":"O comando read espera e armazena como vari\u00e1vel o valor que voc\u00ea digitar: read \"x\" caderno echo $x A vari\u00e1vel \u00e9 x read \"variavel14\" vassoura echo $variavel14 A vari\u00e1vel \u00e9 variavel14 read nota echo $nota A vari\u00e1vel \u00e9 nota Adicionando a op\u00e7\u00e3o -p de prompt , ele fica interativo (por\u00e9m vai precisar de uma vari\u00e1vel de armazenamento): read -p \"fruta\" echo $fruta Interage mas n\u00e3o armazenou nada, pois n\u00e3o criamos uma vari\u00e1vel! Agora vamos ler e armazenar uma vari\u00e1vel: read -p \"fruta\" var echo $var CUIDADO para n\u00e3o dar um echo em fruta , e sim em $var ! Vamos tentar de novo... read -p \"fruta: \" x echo $fruta ou echo $x ?? NOTE que deixamos um espa\u00e7o entre os : e \" unset fruta read -p \"Diga uma fruta: \" fruta echo $fruta Lendo uma vari\u00e1vel que armazena um nome: read -p \"Digite seu nome: \" x echo $x read -p \"Digite seu nome: \" y echo $y read -p \"Digite seu nome: \" nome echo $nome Lendo uma vari\u00e1vel que armazena uma nota: read -p \"Digite a nota do aluno: \" nota echo $nota","title":"COMANDO read OU LEIA"},{"location":"Modulo_103.1-aula01/#os-comandos-builtin-comandos-internos-do-shell","text":"Podemos ver quais s\u00e3o os comandos internos ou builtins do shell com o help : help help <2xtab> help echo help pwd help cd NOTE que um help ls n\u00e3o retorna nada, pois o ls n\u00e3o \u00e9 um comando builtin . Tamb\u00e9m podemos comparar os comandos builtin e os comandos utilit\u00e1rios do sistema com o type : type cd type echo type ls type apt type mv Os comandos que N\u00c3O FOREM builtin , sempre ter\u00e3o sua localiza\u00e7\u00e3o PATH apontada. Os comandos builtin n\u00e3o tem esse apontamento.","title":"OS COMANDOS BUILTIN (Comandos Internos) DO shell"},{"location":"Modulo_103.1-aula01/#as-variaveis-de-ambiente-em-uso-pelo-sistema-operacional","text":"As vari\u00e1veis de ambiente s\u00e3o definidas sempre em caixa alta . Sendo mostradas pelos comandos set ou env : O comando utilit\u00e1rio env MOSTRA APENAS AS VAR\u00c1VEIS GLOBAIS E AS EXPORTADAS NA SESS\u00c3O. O builtin set mostra todas as vari\u00e1veis internas e globais , mesmo sem exportar. type env type set env | less set | less SHELL=/bin/bash LANGUAGE=pt_BR XCURSOR_SIZE=24 LOGNAME=mevorak HOME=/home/mevorak USER=mevorak HOSTNAME=mevorak PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games ... Podemos realizar buscas por vari\u00e1veis espec\u00edficas: echo $USER echo $SHELL echo $LANGUAGE","title":"AS VARI\u00c1VEIS DE AMBIENTE EM USO PELO SISTEMA OPERACIONAl"},{"location":"Modulo_103.1-aula01/#o-conceito-de-path-ou-caminho","text":"Nos comandos dados ao bash , ele valida PRIMEIRO se \u00e9 um comando builtin , DEPOIS ele valida se \u00e9 um comando utilit\u00e1rio do sistema, da vari\u00e1vel PATH , DEPOIS ele imprime um erro de COMMAND NOT FOUND . bem l\u00f3gico! Exemplo:: meu_programa bash: meu_programa: comando n\u00e3o encontrado MAS eu posso criar um arquivo com esse nome e fazer virar um Shell script echo \"ls\" > meu_programa chmod +x meu_programa ./meuprograma Outros exemplos pr\u00e1ticos: echo \"echo Ol\u00e1 mundo\" > meu_programa echo mkdir PASTA_D > meu_programa Ou ent\u00e3o posso jogar o meu programa no PATH do Sistema: sudo mv meu_programa /usr/bin/ Agora ele consta nos comandos internos do Sistema e autocompleta com a tecla TAB : meu_prog 2x<TAB>","title":"O CONCEITO DE PATH OU CAMINHO"},{"location":"Modulo_103.1-aula01/#a-linguagem-do-shell-script-modo-nao-interativo","text":"Qual a vantagem de usar Shell script ? Bom, podemos usar comandos em lote, ao inv\u00e9s de um de cada vez! Exemplo: whoami hostname uptime -p uname -rms Imagine se tivesse que validar essas informa\u00e7\u00f5es a cada troca de turno, por exemplo. Sendo MUITO mais pr\u00e1tico, criar um Shell script com todos estes comandos para rodar de uma vez s\u00f3. Criando o arquivo: $ > informacoes.sh Inserindo os comandos nele: #! /usr/bin/env bash whoami hostname uptime -p uname -rms Setando permiss\u00e3o de execu\u00e7\u00e3o: chmod +x informacoes.sh Chamando o programa para rodar: ./informacoes.sh A linha #! /usr/bin/env bash informa ao Shell qual interpretador vai rodar o script, no caso, apontamos para o bash . Chamamos essa linha obrigat\u00f3ria inicial de Hashbang ou de Shebang , tanto faz. Na maioria dos casos o programador vai usar o caminho absoluto #!/bin/bash , para criar a hashbang ao inv\u00e9s de optar pelo environment (ambiente) env . Vamos criar um arquivo de Shell script que leia, guarde e imprima um nome: Criamos o arquivo: > seunome.sh Inserimos o conte\u00fado: #!/usr/bin/env bash read -p \"Digite seu nome: \" nome echo \"Ol\u00e1, $nome!\" Setamos a permiss\u00e3o de execu\u00e7\u00e3o: chmod +x seunome.sh Chamamos \u00e1 execu\u00e7\u00e3o: ./seunome Criemos outro Shell script que mostre a data e hora, hospedando no /opt e usando o editor vim : mkdir -p /opt/Meus_Programas/ vim /opt/Meus_Programa/Data_Hora #!/bin/bash echo \"Este \u00e9 um Script de Teste\" echo \" \" date echo \" \" echo \"Fim do Script\" Este script s\u00f3 roda se eu der permiss\u00e3o e rodar o comando \u00e1 partir do pr\u00f3prio diret\u00f3rio: chmod +x /opt/Meus_Programas/Data_Hora cd /opt/Meus_Programas/ ./Data_Hora #./ aponta diret\u00f3rio atual sh Data_Hora Ou bash Data_Hora Opcionalmente posso apontar o PATH completo no comando: bash /opt/Meuprograma/Data_Hora Tentar execut\u00e1-lo \u00e1 partir de outro diret\u00f3rio ser\u00e1 imposs\u00edvel!","title":"A LINGUAGEM DO SHELL SCRIPT (Modo n\u00e3o interativo)"},{"location":"Modulo_103.1-aula01/#caminho-absoluto-x-caminho-relativo","text":"CAMINHO ABSOLUTO /opt/Meuprograma/Data_Hora CAMINHO RELATIVO cd /opt/ cd Meus_Programas/ cd Data_Hora","title":"CAMINHO ABSOLUTO X CAMINHO RELATIVO:"},{"location":"Modulo_103.1-aula01/#a-variavel-path-ou-caminho","text":"Todo programa que roda no Terminal, est\u00e1 armazenado em algum lugar espec\u00edfico. Geralmente os scripts do Sistema operacional, ficam em /usr/bin/ , /usr/sbin , /bin , etc. Contudo, pra que eu n\u00e3o tenha que ficar digitando o caminho completo, toda vez em que for preciso rodar um programa, como por exemplo o navegador web Firefox , foi criada a vari\u00e1vel PATH , contendo os caminhos de busca, para uso do Sistema operacional. Temos dois modos de adicionar o caminho do diret\u00f3rio onde salvei meu script, \u00e1 vari\u00e1vel PATH , que \u00e9 onde o Terminal busca os programas, possibilitando com que ele conste, \u00e1 partir de qualquer diret\u00f3rio onde eu estiver. 1) MODO TRANSIT\u00d3RIO Leio o PATH padr\u00e3o: echo $PATH Adiciono meu pr\u00f3prio caminho \u00e1 ela: PATH=$PATH:/opt/Meus_Programas Leio novamente e ele est\u00e1 constando nela: echo $PATH 2) MODO DEFINITIVO Leio o PATH padr\u00e3o: echo $PATH Edito o pr\u00f3prio arquivo global do Sistema operacional, adicionando o caminho do meu programa: sudo vim /etc/profile PATH=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/opt/Meus_Programas\" For\u00e7o a reconfigura\u00e7\u00e3o para efetivar a altera\u00e7\u00e3o: sudo source /etc/profile Releio o PATH padr\u00e3o e j\u00e1 consta o /opt/Meus_Programas : echo $PATH Inclusive os comandos which ou whereis tb\u00e9m j\u00e1 encontram o meu programa : whereis Data_Hora which Data_Hora Respondendo \u00e1 tecla TAB para autocompletar o nome do programa : Data_H 2x<TAB> Data_Hora Alguns usu\u00e1rios preferem criar seus pr\u00f3prios diret\u00f3rios pessoais, ignorando a vari\u00e1vel Global /etc/profile , optando por usar a vari\u00e1vel local .bashrc , para armazenar seus pr\u00f3prios caminhos. Exemplo: Criamos o diretorio /home/usuario/Programas : mkdir ~/Programas Editamos a vari\u00e1vel local .bashrc : sudo vim ~/.bashrc Adicionamos um teste de execu\u00e7\u00e3o: if [ -d ~/Programas ] then PATH=$PATH:~/Programas fi Copia um script, como o seunome.sh para dentro desse diret\u00f3rio: cp seunome.sh /home/usuario/Programas/ For\u00e7amos a releitura da configura\u00e7\u00e3o da vari\u00e1vel de sistema : source .bashrc Procuramos o novo caminho na vari\u00e1vel PATH : env | grep PATH","title":"A VARI\u00c1VEL PATH ( OU CAMINHO)"},{"location":"Modulo_103.1-aula01/#criando-um-script-e-setando-no-path-do-sistema","text":"Fa\u00e7a os seguintes testes: echo \"m\u00e1quina; hostname echo -n m\u00e1quina; hostname echo -n m\u00e1quina:; hostname ENT\u00c3O Criamos o script: vim ~/Programas/Informacoes Inserimos os comandos: #! /usr/bin/env bash # Informa\u00e7\u00f5es.sh # Vers\u00e3o 1.0 # Script para capturar informa\u00e7\u00f5es do Sistema # 02/25 # Eduardo Charquero clear echo \"\" echo \"VALIDANDO NFORMA\u00c7\u00d5ES LOCAIS:\" echo \"----------------------------------\" echo -n \"Usu\u00e1rio logado : \" whoami echo -n \"M\u00e1quina da rede: \" hostname echo -n \"Kernel em uso : \" uname -rms echo -n \"Tempo ligada : \" uptime -p echo \"----------------------------------\" echo \"\" Setamos permiss\u00e3o de execu\u00e7\u00e3o: chmod +x ~/Programas/Informacoes Mandamos o TAB autocompletar e o ENTER para rodar: Infor 2x<TAB> ENTER","title":"CRIANDO UM SCRIPT E SETANDO NO PATH DO SISTEMA"},{"location":"Modulo_103.1-aula01/#dicas","text":"Locais interessantes de usar para reposit\u00f3rio de seus scripts pessoais: ~/.Programas /opt /usr/local/bin","title":"DICAS"},{"location":"Modulo_103.1-aula01/#atencao","text":"N\u00c3O RODE COMANDOS OU SCRIPTS DE TERCEIROS ENCONTRADOS NA WEB, SEM SABER O QUE ELE DE FATO EST\u00c1 FAZENDO! CUIDADO COM O USO DE USU\u00c1RIO ROOT OU SUDO! Voc\u00ea foi avisado!! THAT\u2019S ALL FOLKS!!","title":"ATEN\u00c7\u00c3O!!"},{"location":"Modulo_103.1-aula02/","text":"\ud83d\udc27 M\u00f3dulo \ufeff103.1 AULA02 HIST\u00d3RICO DOS COMANDOS \u00c9 poss\u00edvel acessar o hist\u00f3rico de comandos dados no terminal, clicando no direcional do teclado, para cima ou para baixo. Podemos usar o comando history , aliado ao comando less , para ver o conte\u00fado do cache : history history | less Se usar dois !! , ele retorna o \u00faltimo comando dado no Terminal: !! Posso aliar um ! , mais o n\u00famero do comando que eu quero repetir: !37 Quem armazena esse cache \u00e9 o arquivo .bash_history : cat ~/.bash_history Que pode ser esvaziado com a op\u00e7\u00e3o -c : history -c A vari\u00e1vel de ambiente que aponta para esse arquivo \u00e9 a HISTFILE : set | grep HISTFILE HISTFILE=/home/usuario/.bash_history HISTFILESIZE=20000 _=HISTFILE Assim como a que aponta o tamanho do cache , HISTSIZE , em n\u00famero de linhas: echo $HISTSIZE 1000 Uma op\u00e7\u00e3o poderosa na busca de hist\u00f3rico de comandos, \u00e9 a associa\u00e7\u00e3o entre ctrl+r e alguma parte do comando, ao dar ENTER , ele roda o comando: ctrl + r dist sudo apt update && sudo apt dist-upgrade Outro detalhe interessante, na busca pelo hist\u00f3rico de comandos, \u00e9 o uso da tecla <TAB> , que clicada 2x, vai tentando autocompletar, com op\u00e7\u00f5es, o comando que estou digitando: histor + 2X<TAB> COMANDOS SEQUENCIAIS Podemos usar comandos sequenciais com alguns direcionadores, como o ; , o && e o || . O ; executa sempre, sequencialmente os comandos: clear; date; ls Enquanto o && s\u00f3 d\u00e1 sequ\u00eancia ao pr\u00f3ximo comando se obtiver sucesso no comando anterior. se este falhar, ele n\u00e3o prossegue ao pr\u00f3ximo: ls /tmp/naoexiste && echo linux ls: n\u00e3o foi poss\u00edvel acessar '/tmp/teste': Arquivo ou diret\u00f3rio inexistente ls /tmp/ && echo linux kdocs_asrfirjc MozillaUpdateLock-6AFDA46A1A8AD48 ssh-W8FSwzdY1DB2 systemd-private-881a6f50d3544de58d23489a38c4214c-bluetooth.service-qpAL6j systemd-private-881a6f50d3544de58d23489a38c4214c-colord.service-DB6QUM systemd-private-881a6f50d3544de58d23489a38c4214c-ModemManager.service-aG3Y6H systemd-private-881a6f50d3544de58d23489a38c4214c-switcheroo-control.service-67zwcx systemd-private-881a6f50d3544de58d23489a38c4214c-systemd-logind.service-M8ORHo systemd-private-881a6f50d3544de58d23489a38c4214c-systemd-timesyncd.service-qN7VXN systemd-private-881a6f50d3544de58d23489a38c4214c-upower.service-O1RZMk vmware-root linux J\u00e1 o outro direcionador, o || , s\u00f3 prossegue para o pr\u00f3ximo comando se der erro no primeiro: ls /tmp || echo linux ls /tmp/naoexiste || echo linux THAT\u2019S ALL FOLKS!!","title":"\ud83d\udc27 M\u00f3dulo \ufeff103.1 AULA02"},{"location":"Modulo_103.1-aula02/#modulo-1031-aula02","text":"","title":"\ud83d\udc27 M\u00f3dulo \ufeff103.1 AULA02"},{"location":"Modulo_103.1-aula02/#historico-dos-comandos","text":"\u00c9 poss\u00edvel acessar o hist\u00f3rico de comandos dados no terminal, clicando no direcional do teclado, para cima ou para baixo. Podemos usar o comando history , aliado ao comando less , para ver o conte\u00fado do cache : history history | less Se usar dois !! , ele retorna o \u00faltimo comando dado no Terminal: !! Posso aliar um ! , mais o n\u00famero do comando que eu quero repetir: !37 Quem armazena esse cache \u00e9 o arquivo .bash_history : cat ~/.bash_history Que pode ser esvaziado com a op\u00e7\u00e3o -c : history -c A vari\u00e1vel de ambiente que aponta para esse arquivo \u00e9 a HISTFILE : set | grep HISTFILE HISTFILE=/home/usuario/.bash_history HISTFILESIZE=20000 _=HISTFILE Assim como a que aponta o tamanho do cache , HISTSIZE , em n\u00famero de linhas: echo $HISTSIZE 1000 Uma op\u00e7\u00e3o poderosa na busca de hist\u00f3rico de comandos, \u00e9 a associa\u00e7\u00e3o entre ctrl+r e alguma parte do comando, ao dar ENTER , ele roda o comando: ctrl + r dist sudo apt update && sudo apt dist-upgrade Outro detalhe interessante, na busca pelo hist\u00f3rico de comandos, \u00e9 o uso da tecla <TAB> , que clicada 2x, vai tentando autocompletar, com op\u00e7\u00f5es, o comando que estou digitando: histor + 2X<TAB>","title":"HIST\u00d3RICO DOS COMANDOS"},{"location":"Modulo_103.1-aula02/#comandos-sequenciais","text":"Podemos usar comandos sequenciais com alguns direcionadores, como o ; , o && e o || . O ; executa sempre, sequencialmente os comandos: clear; date; ls Enquanto o && s\u00f3 d\u00e1 sequ\u00eancia ao pr\u00f3ximo comando se obtiver sucesso no comando anterior. se este falhar, ele n\u00e3o prossegue ao pr\u00f3ximo: ls /tmp/naoexiste && echo linux ls: n\u00e3o foi poss\u00edvel acessar '/tmp/teste': Arquivo ou diret\u00f3rio inexistente ls /tmp/ && echo linux kdocs_asrfirjc MozillaUpdateLock-6AFDA46A1A8AD48 ssh-W8FSwzdY1DB2 systemd-private-881a6f50d3544de58d23489a38c4214c-bluetooth.service-qpAL6j systemd-private-881a6f50d3544de58d23489a38c4214c-colord.service-DB6QUM systemd-private-881a6f50d3544de58d23489a38c4214c-ModemManager.service-aG3Y6H systemd-private-881a6f50d3544de58d23489a38c4214c-switcheroo-control.service-67zwcx systemd-private-881a6f50d3544de58d23489a38c4214c-systemd-logind.service-M8ORHo systemd-private-881a6f50d3544de58d23489a38c4214c-systemd-timesyncd.service-qN7VXN systemd-private-881a6f50d3544de58d23489a38c4214c-upower.service-O1RZMk vmware-root linux J\u00e1 o outro direcionador, o || , s\u00f3 prossegue para o pr\u00f3ximo comando se der erro no primeiro: ls /tmp || echo linux ls /tmp/naoexiste || echo linux THAT\u2019S ALL FOLKS!!","title":"COMANDOS SEQUENCIAIS"},{"location":"Modulo_103.1-aula03/","text":"\ud83d\udc27 M\u00f3dulo \ufeff103.1 AULA03 COMANDO alias, which, uname e quoting CRIANDO UM BACKUP DE QUALQUER ARQUIVO ANTES DE EDI\u00c7\u00c3O! FA\u00c7A BACKUP DE ARQUIVOS (SEMPRE!!) Exemplo: $ > arquivo-teste $ cp arquivo-teste arquivo-teste.orig Ou $ cp arquivo-teste{,.orig} $ cp /home/usuario/.bashrc /home/usuario/.bashrc.orig Ou $ cp .bashrc{,.orig} $ cp /etc/network/interfaces /etc/network/interfaces.orig Ou $ cp /etc/network/interfaces{,.orig} O CONCEITO DE ALIAS O alias \u00e9 como um apelido: $ cat .bashrc NOTE as linhas comentadas: #alias ll #alias la #alias l ENT\u00c3O para que esses aliases rodem, eu preciso descomentar, removendo o '#': alias ll alias la alias l E releio o arquivo: $ source .bashrc Ou posso seguir a orienta\u00e7\u00e3o do pr\u00f3prio .bashrc e crio outro arquivo, o .bash_aliases vim .bash_aliases alias ll alias la alias l Releio o arquivo: $ source .bash_aliases AGORA os comandos de aliases ll , la e l , v\u00e3o rodar sob o ls -l , ls -A e ls -CF Veja as op\u00e7\u00f5es que podem ser encontradas no manual do ls : $ man ls O comando alias , apresenta na tela todos os aliases criados no Shell $ alias Para criar um alias TEMPOR\u00c1RIO, eu posso simplesmente criar do modo como eu crio uma vari\u00e1vel Exemplo: $ alias lt='ls /tmp' $ alias $ lt Para que esse alias fique definitivo, preciso adicion\u00e1-lo ao .bashrc OU ao .bash_aliases O COMANDO which O comando which varre o PATH em busca de bin\u00e1rios (programas) dentro desses caminhos $ echo $PATH $ which echo Ele lembra o comando whereis $ whereis echo $ whereis ls O COMANDO uname O comando uname mostra a vers\u00e3o do Kernel , usada pelo Sistema Operacional: $ uname $ uname -r $ uname -ra $ uname --help O COMANDO quoting (aspas duplas \"\", aspas simples '', e a barra invertida ) A primeira coisa que o Shell faz, \u00e9 interpretar os caracteres especias e depois executar os comandos associados a eles. Os comandos de quoting , servem pra proteger os CARACTERES ESPECIAS , contra a interpreta\u00e7\u00e3o do Shell , imprimindo n\u00e3o seu valor associado, mas ele pr\u00f3prio. Exemplo: $ echo * != $ echo \\* A barra invertida, ou barra de escape, \\ , protege APENAS o pr\u00f3ximo caracter, imediato a ela mesma, e n\u00e3o os pr\u00f3ximos caracteres subsequentes a ela. Exemplo: $ echo \\& \\* != $ echo & * != $ echo \\& \\$ * Outro exemplo de uso da barra invertida: $ echo \"Curso de Linux\" != $ echo Curso de Linux != $ echo Curso\\ \\ \\ de\\ \\ \\ Linux E qual \u00e9 a diferen\u00e7a, entre as ASPAS DUPLAS \"\" , e as ASPAS SIMPLES '' ? As aspas duplas \"\" , protegem TODOS os caracteres especiais, EXCETO o cifr\u00e3o $ , a cr\u00e1se ' ' ', e a pr\u00f3pria barra de scape \\ . Ou seja, um echo $\\ N\u00c3O FUNCIONA para prote\u00e7\u00e3o desses Caracteres Especiais J\u00e1 as aspas simples '' , protegem TODOS os caracteres especiais, INCLUSIVE estes $ , ' ' ' e \\ que as aspas duplas n\u00e3o protegem. CRIANDO UMA VARI\u00c1VEL $ CIFRAO=CARACTER Ao expendir com echo protegendo, teremos: $ echo $CIFRAO != $ echo '$CIFRAO' NOTE que SE eu protegesse com ASPAS DUPLAS, n\u00e3o seria efetivo: $ echo \"$CIFRAO\" THAT\u2019S ALL FOLKS!!","title":"\ud83d\udc27 M\u00f3dulo \ufeff103.1 AULA03"},{"location":"Modulo_103.1-aula03/#modulo-1031-aula03","text":"","title":"\ud83d\udc27 M\u00f3dulo \ufeff103.1 AULA03"},{"location":"Modulo_103.1-aula03/#comando-alias-which-uname-e-quoting","text":"","title":"COMANDO alias, which, uname e quoting"},{"location":"Modulo_103.1-aula03/#criando-um-backup-de-qualquer-arquivo-antes-de-edicao","text":"FA\u00c7A BACKUP DE ARQUIVOS (SEMPRE!!) Exemplo: $ > arquivo-teste $ cp arquivo-teste arquivo-teste.orig Ou $ cp arquivo-teste{,.orig} $ cp /home/usuario/.bashrc /home/usuario/.bashrc.orig Ou $ cp .bashrc{,.orig} $ cp /etc/network/interfaces /etc/network/interfaces.orig Ou $ cp /etc/network/interfaces{,.orig}","title":"CRIANDO UM BACKUP DE QUALQUER ARQUIVO ANTES DE EDI\u00c7\u00c3O!"},{"location":"Modulo_103.1-aula03/#o-conceito-de-alias","text":"O alias \u00e9 como um apelido: $ cat .bashrc NOTE as linhas comentadas: #alias ll #alias la #alias l ENT\u00c3O para que esses aliases rodem, eu preciso descomentar, removendo o '#': alias ll alias la alias l E releio o arquivo: $ source .bashrc Ou posso seguir a orienta\u00e7\u00e3o do pr\u00f3prio .bashrc e crio outro arquivo, o .bash_aliases vim .bash_aliases alias ll alias la alias l Releio o arquivo: $ source .bash_aliases AGORA os comandos de aliases ll , la e l , v\u00e3o rodar sob o ls -l , ls -A e ls -CF Veja as op\u00e7\u00f5es que podem ser encontradas no manual do ls : $ man ls O comando alias , apresenta na tela todos os aliases criados no Shell $ alias Para criar um alias TEMPOR\u00c1RIO, eu posso simplesmente criar do modo como eu crio uma vari\u00e1vel Exemplo: $ alias lt='ls /tmp' $ alias $ lt Para que esse alias fique definitivo, preciso adicion\u00e1-lo ao .bashrc OU ao .bash_aliases","title":"O CONCEITO DE ALIAS"},{"location":"Modulo_103.1-aula03/#o-comando-which","text":"O comando which varre o PATH em busca de bin\u00e1rios (programas) dentro desses caminhos $ echo $PATH $ which echo Ele lembra o comando whereis $ whereis echo $ whereis ls","title":"O COMANDO which"},{"location":"Modulo_103.1-aula03/#o-comando-uname","text":"O comando uname mostra a vers\u00e3o do Kernel , usada pelo Sistema Operacional: $ uname $ uname -r $ uname -ra $ uname --help","title":"O COMANDO uname"},{"location":"Modulo_103.1-aula03/#o-comando-quoting-aspas-duplas-aspas-simples-e-a-barra-invertida","text":"A primeira coisa que o Shell faz, \u00e9 interpretar os caracteres especias e depois executar os comandos associados a eles. Os comandos de quoting , servem pra proteger os CARACTERES ESPECIAS , contra a interpreta\u00e7\u00e3o do Shell , imprimindo n\u00e3o seu valor associado, mas ele pr\u00f3prio. Exemplo: $ echo * != $ echo \\* A barra invertida, ou barra de escape, \\ , protege APENAS o pr\u00f3ximo caracter, imediato a ela mesma, e n\u00e3o os pr\u00f3ximos caracteres subsequentes a ela. Exemplo: $ echo \\& \\* != $ echo & * != $ echo \\& \\$ * Outro exemplo de uso da barra invertida: $ echo \"Curso de Linux\" != $ echo Curso de Linux != $ echo Curso\\ \\ \\ de\\ \\ \\ Linux E qual \u00e9 a diferen\u00e7a, entre as ASPAS DUPLAS \"\" , e as ASPAS SIMPLES '' ? As aspas duplas \"\" , protegem TODOS os caracteres especiais, EXCETO o cifr\u00e3o $ , a cr\u00e1se ' ' ', e a pr\u00f3pria barra de scape \\ . Ou seja, um echo $\\ N\u00c3O FUNCIONA para prote\u00e7\u00e3o desses Caracteres Especiais J\u00e1 as aspas simples '' , protegem TODOS os caracteres especiais, INCLUSIVE estes $ , ' ' ' e \\ que as aspas duplas n\u00e3o protegem.","title":"O COMANDO quoting (aspas duplas \"\", aspas simples '', e a barra invertida )"},{"location":"Modulo_103.1-aula03/#criando-uma-variavel","text":"$ CIFRAO=CARACTER Ao expendir com echo protegendo, teremos: $ echo $CIFRAO != $ echo '$CIFRAO' NOTE que SE eu protegesse com ASPAS DUPLAS, n\u00e3o seria efetivo: $ echo \"$CIFRAO\" THAT\u2019S ALL FOLKS!!","title":"CRIANDO UMA VARI\u00c1VEL"},{"location":"Modulo_103.1-aula04/","text":"\ud83d\udc27 M\u00f3dulo 103.1 AULA 04 OS COMANDOS cat , head , tail , sort , less e wc NO LINUX Os comandos cat , head , tail , sort , less e wc s\u00e3o ferramentas essenciais para manipula\u00e7\u00e3o e visualiza\u00e7\u00e3o de arquivos de texto no Linux. Cada um desses comandos tem suas pr\u00f3prias funcionalidades e casos de uso espec\u00edficos. Vamos explorar cada um desses comandos em detalhes. O COMANDO cat O comando cat \u00e9 usado para concatenar e exibir o conte\u00fado de arquivos. Sintaxe: cat [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -n: Numera todas as linhas de sa\u00edda. -b: Numera apenas as linhas n\u00e3o vazias. -s: Suprime linhas em branco repetidas. Exemplos, exibir o conte\u00fado de um arquivo: cat arquivo.txt Concatenar e exibir o conte\u00fado de m\u00faltiplos arquivos: cat arquivo1.txt arquivo2.txt Numerar todas as linhas de um arquivo: cat -n arquivo.txt O COMANDO head O comando head \u00e9 usado para exibir as primeiras linhas de um arquivo. Sintaxe: head [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -n: Especifica o n\u00famero de linhas a serem exibidas. Exemplos: exibir as primeiras 10 linhas de um arquivo: head arquivo.txt Exibir as primeiras 5 linhas de um arquivo: head -n 5 arquivo.txt O COMANDO tail O comando tail \u00e9 usado para exibir as \u00faltimas linhas de um arquivo. Sintaxe: tail [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -n: Especifica o n\u00famero de linhas a serem exibidas. -f: Exibe as novas linhas adicionadas ao arquivo em tempo real. Exemplos: Exibir as \u00faltimas 10 linhas de um arquivo: tail arquivo.txt Exibir as \u00faltimas 5 linhas de um arquivo: tail -n 5 arquivo.txt Monitorar um arquivo em tempo real: tail -f arquivo.txt O COMANDO sort O comando sort \u00e9 usado para ordenar linhas de arquivos de texto. Sintaxe: sort [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -r: Ordena em ordem inversa. -n: Ordena numericamente. -u: Remove linhas duplicadas. Exemplos, ordenar as linhas de um arquivo: sort arquivo.txt Ordenar numericamente: sort -n arquivo.txt Ordenar em ordem inversa: sort -r arquivo.txt O COMANDO less O comando less \u00e9 usado para visualizar o conte\u00fado de arquivos de texto de forma paginada. Sintaxe: less [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -N: Exibe n\u00fameros de linha. -S: Desabilita o wrap de linhas longas. Exemplos: Visualizar o conte\u00fado de um arquivo: less arquivo.txt Visualizar o conte\u00fado de um arquivo com n\u00fameros de linha: less -N arquivo.txt O COMANDO wc O comando wc \u00e9 usado para contar linhas, palavras e caracteres em arquivos. Sintaxe: wc [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -l: Conta o n\u00famero de linhas. -w: Conta o n\u00famero de palavras. -c: Conta o n\u00famero de bytes. -m: Conta o n\u00famero de caracteres. Exemplos: Contar o n\u00famero de linhas, palavras e bytes em um arquivo: wc arquivo.txt Contar apenas o n\u00famero de linhas: wc -l arquivo.txt Contar apenas o n\u00famero de palavras: wc -w arquivo.txt CONCLUS\u00c3O Os comandos cat , head , tail , sort , less e wc s\u00e3o ferramentas poderosas para manipula\u00e7\u00e3o e visualiza\u00e7\u00e3o de arquivos de texto no Linux. Eles permitem que voc\u00ea realize uma ampla variedade de opera\u00e7\u00f5es de edi\u00e7\u00e3o e visualiza\u00e7\u00e3o de texto de maneira eficiente. Praticar com esses comandos ajudar\u00e1 voc\u00ea a se tornar mais eficiente em manipula\u00e7\u00e3o de texto no terminal. THAT\u2019S ALL FOLKS!!","title":"\ud83d\udc27 M\u00f3dulo 103.1 AULA 04"},{"location":"Modulo_103.1-aula04/#modulo-1031-aula-04","text":"","title":"\ud83d\udc27 M\u00f3dulo 103.1 AULA 04"},{"location":"Modulo_103.1-aula04/#os-comandos-cat-head-tail-sort-less-e-wc-no-linux","text":"Os comandos cat , head , tail , sort , less e wc s\u00e3o ferramentas essenciais para manipula\u00e7\u00e3o e visualiza\u00e7\u00e3o de arquivos de texto no Linux. Cada um desses comandos tem suas pr\u00f3prias funcionalidades e casos de uso espec\u00edficos. Vamos explorar cada um desses comandos em detalhes.","title":"OS COMANDOS cat, head, tail, sort, less e wc NO LINUX"},{"location":"Modulo_103.1-aula04/#o-comando-cat","text":"O comando cat \u00e9 usado para concatenar e exibir o conte\u00fado de arquivos. Sintaxe: cat [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -n: Numera todas as linhas de sa\u00edda. -b: Numera apenas as linhas n\u00e3o vazias. -s: Suprime linhas em branco repetidas. Exemplos, exibir o conte\u00fado de um arquivo: cat arquivo.txt Concatenar e exibir o conte\u00fado de m\u00faltiplos arquivos: cat arquivo1.txt arquivo2.txt Numerar todas as linhas de um arquivo: cat -n arquivo.txt","title":"O COMANDO cat"},{"location":"Modulo_103.1-aula04/#o-comando-head","text":"O comando head \u00e9 usado para exibir as primeiras linhas de um arquivo. Sintaxe: head [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -n: Especifica o n\u00famero de linhas a serem exibidas. Exemplos: exibir as primeiras 10 linhas de um arquivo: head arquivo.txt Exibir as primeiras 5 linhas de um arquivo: head -n 5 arquivo.txt","title":"O COMANDO head"},{"location":"Modulo_103.1-aula04/#o-comando-tail","text":"O comando tail \u00e9 usado para exibir as \u00faltimas linhas de um arquivo. Sintaxe: tail [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -n: Especifica o n\u00famero de linhas a serem exibidas. -f: Exibe as novas linhas adicionadas ao arquivo em tempo real. Exemplos: Exibir as \u00faltimas 10 linhas de um arquivo: tail arquivo.txt Exibir as \u00faltimas 5 linhas de um arquivo: tail -n 5 arquivo.txt Monitorar um arquivo em tempo real: tail -f arquivo.txt","title":"O COMANDO tail"},{"location":"Modulo_103.1-aula04/#o-comando-sort","text":"O comando sort \u00e9 usado para ordenar linhas de arquivos de texto. Sintaxe: sort [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -r: Ordena em ordem inversa. -n: Ordena numericamente. -u: Remove linhas duplicadas. Exemplos, ordenar as linhas de um arquivo: sort arquivo.txt Ordenar numericamente: sort -n arquivo.txt Ordenar em ordem inversa: sort -r arquivo.txt","title":"O COMANDO sort"},{"location":"Modulo_103.1-aula04/#o-comando-less","text":"O comando less \u00e9 usado para visualizar o conte\u00fado de arquivos de texto de forma paginada. Sintaxe: less [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -N: Exibe n\u00fameros de linha. -S: Desabilita o wrap de linhas longas. Exemplos: Visualizar o conte\u00fado de um arquivo: less arquivo.txt Visualizar o conte\u00fado de um arquivo com n\u00fameros de linha: less -N arquivo.txt","title":"O COMANDO less"},{"location":"Modulo_103.1-aula04/#o-comando-wc","text":"O comando wc \u00e9 usado para contar linhas, palavras e caracteres em arquivos. Sintaxe: wc [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: -l: Conta o n\u00famero de linhas. -w: Conta o n\u00famero de palavras. -c: Conta o n\u00famero de bytes. -m: Conta o n\u00famero de caracteres. Exemplos: Contar o n\u00famero de linhas, palavras e bytes em um arquivo: wc arquivo.txt Contar apenas o n\u00famero de linhas: wc -l arquivo.txt Contar apenas o n\u00famero de palavras: wc -w arquivo.txt","title":"O COMANDO wc"},{"location":"Modulo_103.1-aula04/#conclusao","text":"Os comandos cat , head , tail , sort , less e wc s\u00e3o ferramentas poderosas para manipula\u00e7\u00e3o e visualiza\u00e7\u00e3o de arquivos de texto no Linux. Eles permitem que voc\u00ea realize uma ampla variedade de opera\u00e7\u00f5es de edi\u00e7\u00e3o e visualiza\u00e7\u00e3o de texto de maneira eficiente. Praticar com esses comandos ajudar\u00e1 voc\u00ea a se tornar mais eficiente em manipula\u00e7\u00e3o de texto no terminal. THAT\u2019S ALL FOLKS!!","title":"CONCLUS\u00c3O"},{"location":"Modulo_103.1-aula05/","text":"\ud83d\udc27 M\u00f3dulo 103.1 AULA 05 COMANDOS tr , cut E sed NO LINUX Os comandos tr , cut e sed s\u00e3o ferramentas poderosas para manipula\u00e7\u00e3o de texto no Linux. Cada um deles tem suas pr\u00f3prias funcionalidades e casos de uso espec\u00edficos. Vamos explorar cada um desses comandos em detalhes. O COMANDO tr O comando tr \u00e9 usado para traduzir ou deletar caracteres. Ele l\u00ea a entrada padr\u00e3o e escreve a sa\u00edda padr\u00e3o. Sintaxe: tr [op\u00e7\u00f5es] conjunto1 [conjunto2] Op\u00e7\u00f5es Comuns: \u2022 -d: Deleta caracteres. \u2022 -s: Substitui sequ\u00eancias de um caractere repetido por um \u00fanico caractere. Exemplos: Converter letras min\u00fasculas para mai\u00fasculas: echo \"hello world\" | tr 'a-z' 'A-Z' Sa\u00edda: HELLO WORLD Deletar todos os d\u00edgitos: echo \"123abc456def\" | tr -d '0-9' Sa\u00edda: abcdef O COMANDO cut O comando cut \u00e9 usado para extrair se\u00e7\u00f5es de cada linha de arquivos. Sintaxe: cut [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: \u2022 -d: Especifica o delimitador. \u2022 -f: Seleciona campos espec\u00edficos. \u2022 -c: Seleciona caracteres espec\u00edficos. Exemplos: Extrair o primeiro campo de um arquivo delimitado por v\u00edrgulas: echo \"nome,idade,cidade\" | cut -d',' -f1 Sa\u00edda: nome Extrair os caracteres da 2\u00aa \u00e0 5\u00aa posi\u00e7\u00e3o: echo \"Hello World\" | cut -c2-5 Sa\u00edda: ello O COMANDO sed O comando sed \u00e9 um editor de fluxo de texto que pode realizar opera\u00e7\u00f5es b\u00e1sicas de edi\u00e7\u00e3o de texto em um arquivo ou entrada. Sintaxe: sed [op\u00e7\u00f5es] 'comando' [arquivo] Op\u00e7\u00f5es Comuns: \u2022 -i: Edita o arquivo no local. \u2022 -e: Adiciona um comando de script. Exemplos: Substituir todas as ocorr\u00eancias de \"foo\" por \"bar\": echo \"foo foo foo\" | sed 's/foo/bar/g' Sa\u00edda: \u2022 bar bar bar Deletar linhas que cont\u00eam a palavra \"error\": echo -e \"line1\\nerror line\\nline3\" | sed '/error/d' Sa\u00edda: line1 line3 Posso converter um texto inteiro, e gerar um outro txt: cat \"Aula01.txt\" | tr 'A-Z' 'a-z' > 22.txt EXERC\u00cdCIOS Exerc\u00edcio 1: Uso do tr 1. Converta todas as letras mai\u00fasculas para min\u00fasculas na string \"Hello World\". 2. Remova todos os espa\u00e7os em branco da string \"Hello World\". Exerc\u00edcio 2: Uso do cut 1. Extraia o segundo campo de um arquivo CSV com o conte\u00fado \"nome,idade,cidade\". 2. Extraia os caracteres da 3\u00aa \u00e0 6\u00aa posi\u00e7\u00e3o da string \"Hello World\". Exerc\u00edcio 3: Uso do sed 1. Substitua todas as ocorr\u00eancias de \"apple\" por \"orange\" na string \"apple apple apple\". 2. Remova todas as linhas que cont\u00eam a palavra \"error\" do seguinte texto: 2. line1 error line line3 CONCLUS\u00c3O Os comandos tr , cut e sed s\u00e3o ferramentas essenciais para manipula\u00e7\u00e3o de texto no Linux. Eles permitem que voc\u00ea realize uma ampla variedade de opera\u00e7\u00f5es de edi\u00e7\u00e3o de texto de maneira eficiente. Praticar com esses comandos ajudar\u00e1 voc\u00ea a se tornar mais eficiente em manipula\u00e7\u00e3o de texto no terminal. THAT\u2019S ALL FOLKS!!","title":"\ud83d\udc27 M\u00f3dulo 103.1 AULA 05"},{"location":"Modulo_103.1-aula05/#modulo-1031-aula-05","text":"","title":"\ud83d\udc27 M\u00f3dulo 103.1 AULA 05"},{"location":"Modulo_103.1-aula05/#comandos-tr-cut-e-sed-no-linux","text":"Os comandos tr , cut e sed s\u00e3o ferramentas poderosas para manipula\u00e7\u00e3o de texto no Linux. Cada um deles tem suas pr\u00f3prias funcionalidades e casos de uso espec\u00edficos. Vamos explorar cada um desses comandos em detalhes.","title":"COMANDOS tr, cut E sed NO LINUX"},{"location":"Modulo_103.1-aula05/#o-comando-tr","text":"O comando tr \u00e9 usado para traduzir ou deletar caracteres. Ele l\u00ea a entrada padr\u00e3o e escreve a sa\u00edda padr\u00e3o. Sintaxe: tr [op\u00e7\u00f5es] conjunto1 [conjunto2] Op\u00e7\u00f5es Comuns: \u2022 -d: Deleta caracteres. \u2022 -s: Substitui sequ\u00eancias de um caractere repetido por um \u00fanico caractere. Exemplos: Converter letras min\u00fasculas para mai\u00fasculas: echo \"hello world\" | tr 'a-z' 'A-Z' Sa\u00edda: HELLO WORLD Deletar todos os d\u00edgitos: echo \"123abc456def\" | tr -d '0-9' Sa\u00edda: abcdef","title":"O COMANDO tr"},{"location":"Modulo_103.1-aula05/#o-comando-cut","text":"O comando cut \u00e9 usado para extrair se\u00e7\u00f5es de cada linha de arquivos. Sintaxe: cut [op\u00e7\u00f5es] [arquivo] Op\u00e7\u00f5es Comuns: \u2022 -d: Especifica o delimitador. \u2022 -f: Seleciona campos espec\u00edficos. \u2022 -c: Seleciona caracteres espec\u00edficos. Exemplos: Extrair o primeiro campo de um arquivo delimitado por v\u00edrgulas: echo \"nome,idade,cidade\" | cut -d',' -f1 Sa\u00edda: nome Extrair os caracteres da 2\u00aa \u00e0 5\u00aa posi\u00e7\u00e3o: echo \"Hello World\" | cut -c2-5 Sa\u00edda: ello","title":"O COMANDO cut"},{"location":"Modulo_103.1-aula05/#o-comando-sed","text":"O comando sed \u00e9 um editor de fluxo de texto que pode realizar opera\u00e7\u00f5es b\u00e1sicas de edi\u00e7\u00e3o de texto em um arquivo ou entrada. Sintaxe: sed [op\u00e7\u00f5es] 'comando' [arquivo] Op\u00e7\u00f5es Comuns: \u2022 -i: Edita o arquivo no local. \u2022 -e: Adiciona um comando de script. Exemplos: Substituir todas as ocorr\u00eancias de \"foo\" por \"bar\": echo \"foo foo foo\" | sed 's/foo/bar/g' Sa\u00edda: \u2022 bar bar bar Deletar linhas que cont\u00eam a palavra \"error\": echo -e \"line1\\nerror line\\nline3\" | sed '/error/d' Sa\u00edda: line1 line3 Posso converter um texto inteiro, e gerar um outro txt: cat \"Aula01.txt\" | tr 'A-Z' 'a-z' > 22.txt","title":"O COMANDO sed"},{"location":"Modulo_103.1-aula05/#exercicios","text":"Exerc\u00edcio 1: Uso do tr 1. Converta todas as letras mai\u00fasculas para min\u00fasculas na string \"Hello World\". 2. Remova todos os espa\u00e7os em branco da string \"Hello World\". Exerc\u00edcio 2: Uso do cut 1. Extraia o segundo campo de um arquivo CSV com o conte\u00fado \"nome,idade,cidade\". 2. Extraia os caracteres da 3\u00aa \u00e0 6\u00aa posi\u00e7\u00e3o da string \"Hello World\". Exerc\u00edcio 3: Uso do sed 1. Substitua todas as ocorr\u00eancias de \"apple\" por \"orange\" na string \"apple apple apple\". 2. Remova todas as linhas que cont\u00eam a palavra \"error\" do seguinte texto: 2. line1 error line line3","title":"EXERC\u00cdCIOS"},{"location":"Modulo_103.1-aula05/#conclusao","text":"Os comandos tr , cut e sed s\u00e3o ferramentas essenciais para manipula\u00e7\u00e3o de texto no Linux. Eles permitem que voc\u00ea realize uma ampla variedade de opera\u00e7\u00f5es de edi\u00e7\u00e3o de texto de maneira eficiente. Praticar com esses comandos ajudar\u00e1 voc\u00ea a se tornar mais eficiente em manipula\u00e7\u00e3o de texto no terminal. THAT\u2019S ALL FOLKS!!","title":"CONCLUS\u00c3O"},{"location":"Modulo_103.2-aula01/","text":"\ud83d\udc27 M\u00f3dulo 103.2 AULA 01 filtros LEITURA DE ARQUIVOS COM OS COMANDOS cat , tac , head , tail , less , nl , sort E uniq O comando cat $ cat arquivo.txt Com a op\u00e7\u00e3o -n para numera\u00e7\u00e3o de linhas: $ cat -n arquivo.txt Com a op\u00e7\u00e3o -b , somente linhas com informa\u00e7\u00f5es, ignorando linhas vazias: $ cat -b arquivo.txt Unifica linhas em branco em uma apenas, com a op\u00e7\u00e3o -s : $ cat -s arquivo.txt Com a op\u00e7\u00e3o -a , mostra caracteres especiais. todo fim de linha tem um $ . todo tab ele mostra um ^i $ cat -a arquivo.txt O help tr\u00e1s ajuda: $ cat --help O man tem o manual completo: $ man cat FILTROS O COMANDO tac O inverso de cat, imprime o arquivo de tr\u00e1s pra frente. na ordem inversa, da \u00faltima linha pra primeira: $ tac arquivo.txt O COMANDO head Apresenta o cabe\u00e7alho do arquivo. por padr\u00e3o tr\u00e1s as primeiras 10 linhas do arquivo. (completas ou vazias): $ head arquivo.txt Posso definir a quantidade de linhas com a op\u00e7\u00e3o -n e mostrar apenas as 2 primeiras linhas: $ head -n2 arquivo.txt Mostrar as 20 primeiras linhas: $ head -n20 arquivo.txt Mostrar apenas os 50 primeiros bytes. (ele n\u00e3o quebra a linha no final do comando mesmo.): $ head -c50 arquivo.txt O COMANDO tail O comando tail mostra o final do arquivo. por padr\u00e3o as \u00daltimas 10 linhas. Posso definir a qtidade de linhas com a op\u00e7\u00e3o -n : $ tail arquivo.txt $ tail -n4 arquivo O tail tem uma op\u00e7\u00e3o muito interessante, que \u00e9 a -f , onde ele fica aguardando a entrada de informa\u00c7\u00d5es em um arquivo. muito usada pra monitorar eventos. Exemplo, em um terminal vc fica escutando: $ tail -n5 -f arquivo.txt E em outro terminal digita: $ echo \u201clinus torvaldis\u201d >> arquivo.txt Outro exemplo: $ tail -f /var/log/zypper Abre outro terminal e digita: $ sudo zypper dup Vai mostrar a evolu\u00e7\u00e3o do processo de atualiza\u00e7\u00e3o no OpenSUSE. Podemos validar a entrada e sa\u00edda de acesso a p\u00e1ginas web de um proxy, por exemplo. ou acompanhar qualquer log em tempo real que precisarmos! O COMANDO less Usando o ambiente gr\u00e1fico, vc pode usar a barra de rolagem pra leitura de arquivos no terminal, mas em ambientes modo texto, nem sempre vc tem essa op\u00e7\u00e3o. Ent\u00e3o podemos paginar a leitura de um arquivo. ele vai travar a leitura em casa vez que alcan\u00e7ar a linha de baixo (ou de cima), navegando pelo direcional do teclado ou pelo enter. vai travar na pr\u00f3xima p\u00e1gina usando o tab : $ less arquivo.txt Uma vez aberto , o less possibilita busca por palavras, com o atalho da / + a palavra que procuramos: /kernel enter Cada vez que aperto n , ele busca uma nova op\u00e7\u00e3o, dessa mesma palavra, em outras p\u00e1ginas. Com shift + n ele busca para tr\u00e1s. Se selecionar ctrl + g , ele mostra o status de onde estou no arquivo, nome, p\u00e1gina atual e percentual da leitura. Pressionado q , vc sai do less . O less , geralmente, \u00e9 usado em associa\u00e7\u00e3o com o cat + o | : $ cat arquivo.txt | less O pipe pega a sa\u00edda do primeiro comando e usa de entrada do segundo comando. O COMANDO wc o comando wc , imprime na tela, a quantidade de linhas, a quantidade de palavras e a quantidade de caracteres, desse arquivo: $ wc arquivo.txt Se usar a op\u00e7\u00e3o -l , mostra apenas as linhas. Se usar a op\u00e7\u00e3o -w , ele mostra as palavras. Se usar -m ele mostra de caracteres. A op\u00e7\u00e3o -c aponta a quantidade de bytes. Se vc der um wc * dentro de um diret\u00f3rio, ele vai apresentar dados sobre a quantidade de linhas, palavras e caracteres de todos os arquivos que estiverem dentro do diret\u00f3rio. trazendo o total no final. Podemos fazer combina\u00e7\u00f5es, tipo de cat + | + wc : $ cat arquivo.txt | wc -l ou tail + | + wc : $ tail -n10 arquivo.txt | wc O COMANDO nl O nl \u00e9 igual ao cat -b , ignorando linhas em branco: $ nl arquivo.txt O COMANDO sort O sort serve pra ordenar alfab\u00e9ticamente um arquivo. Se usar a op\u00e7\u00e3o -r , ele ordena reversamente, ao contr\u00e1rio do alfabeto. As demais op\u00e7\u00f5es do sort, podem ser estudadas com sort -h . O COMANDO uniq O uniq serve pra mostrar entradas \u00fanicas dentro de um arquivo com repeti\u00e7\u00f5es, ou seja, ele mostra ocorr\u00eancias \u00fanicas, sem as repeti\u00e7\u00f5es que possam ocorrer no arquivo: $ unique arquivo.txt Se houverem dois eventos de \u201clinux\u201d, ele tr\u00e1s apenas um deles. Se usar com a op\u00e7\u00e3o -k , ele ordena pelo segundo campo, tipo nome e sobrenome, ele ordenaria alfab\u00e9ticamente o sobrenome. THAT\u2019S ALL FOLKS!!","title":"\ud83d\udc27 M\u00f3dulo 103.2 AULA 01"},{"location":"Modulo_103.2-aula01/#modulo-1032-aula-01","text":"filtros","title":"\ud83d\udc27 M\u00f3dulo 103.2 AULA 01"},{"location":"Modulo_103.2-aula01/#leitura-de-arquivos-com-os-comandos-cat-tac-head-tail-less-nl-sort-e-uniq","text":"","title":"LEITURA DE ARQUIVOS COM OS COMANDOS cat, tac, head, tail, less, nl, sort E uniq"},{"location":"Modulo_103.2-aula01/#o-comando-cat","text":"$ cat arquivo.txt Com a op\u00e7\u00e3o -n para numera\u00e7\u00e3o de linhas: $ cat -n arquivo.txt Com a op\u00e7\u00e3o -b , somente linhas com informa\u00e7\u00f5es, ignorando linhas vazias: $ cat -b arquivo.txt Unifica linhas em branco em uma apenas, com a op\u00e7\u00e3o -s : $ cat -s arquivo.txt Com a op\u00e7\u00e3o -a , mostra caracteres especiais. todo fim de linha tem um $ . todo tab ele mostra um ^i $ cat -a arquivo.txt O help tr\u00e1s ajuda: $ cat --help O man tem o manual completo: $ man cat","title":"O comando cat"},{"location":"Modulo_103.2-aula01/#filtros","text":"","title":"FILTROS"},{"location":"Modulo_103.2-aula01/#o-comando-tac","text":"O inverso de cat, imprime o arquivo de tr\u00e1s pra frente. na ordem inversa, da \u00faltima linha pra primeira: $ tac arquivo.txt","title":"O COMANDO tac"},{"location":"Modulo_103.2-aula01/#o-comando-head","text":"Apresenta o cabe\u00e7alho do arquivo. por padr\u00e3o tr\u00e1s as primeiras 10 linhas do arquivo. (completas ou vazias): $ head arquivo.txt Posso definir a quantidade de linhas com a op\u00e7\u00e3o -n e mostrar apenas as 2 primeiras linhas: $ head -n2 arquivo.txt Mostrar as 20 primeiras linhas: $ head -n20 arquivo.txt Mostrar apenas os 50 primeiros bytes. (ele n\u00e3o quebra a linha no final do comando mesmo.): $ head -c50 arquivo.txt","title":"O COMANDO head"},{"location":"Modulo_103.2-aula01/#o-comando-tail","text":"O comando tail mostra o final do arquivo. por padr\u00e3o as \u00daltimas 10 linhas. Posso definir a qtidade de linhas com a op\u00e7\u00e3o -n : $ tail arquivo.txt $ tail -n4 arquivo O tail tem uma op\u00e7\u00e3o muito interessante, que \u00e9 a -f , onde ele fica aguardando a entrada de informa\u00c7\u00d5es em um arquivo. muito usada pra monitorar eventos. Exemplo, em um terminal vc fica escutando: $ tail -n5 -f arquivo.txt E em outro terminal digita: $ echo \u201clinus torvaldis\u201d >> arquivo.txt Outro exemplo: $ tail -f /var/log/zypper Abre outro terminal e digita: $ sudo zypper dup Vai mostrar a evolu\u00e7\u00e3o do processo de atualiza\u00e7\u00e3o no OpenSUSE. Podemos validar a entrada e sa\u00edda de acesso a p\u00e1ginas web de um proxy, por exemplo. ou acompanhar qualquer log em tempo real que precisarmos!","title":"O COMANDO tail"},{"location":"Modulo_103.2-aula01/#o-comando-less","text":"Usando o ambiente gr\u00e1fico, vc pode usar a barra de rolagem pra leitura de arquivos no terminal, mas em ambientes modo texto, nem sempre vc tem essa op\u00e7\u00e3o. Ent\u00e3o podemos paginar a leitura de um arquivo. ele vai travar a leitura em casa vez que alcan\u00e7ar a linha de baixo (ou de cima), navegando pelo direcional do teclado ou pelo enter. vai travar na pr\u00f3xima p\u00e1gina usando o tab : $ less arquivo.txt Uma vez aberto , o less possibilita busca por palavras, com o atalho da / + a palavra que procuramos: /kernel enter Cada vez que aperto n , ele busca uma nova op\u00e7\u00e3o, dessa mesma palavra, em outras p\u00e1ginas. Com shift + n ele busca para tr\u00e1s. Se selecionar ctrl + g , ele mostra o status de onde estou no arquivo, nome, p\u00e1gina atual e percentual da leitura. Pressionado q , vc sai do less . O less , geralmente, \u00e9 usado em associa\u00e7\u00e3o com o cat + o | : $ cat arquivo.txt | less O pipe pega a sa\u00edda do primeiro comando e usa de entrada do segundo comando.","title":"O COMANDO less"},{"location":"Modulo_103.2-aula01/#o-comando-wc","text":"o comando wc , imprime na tela, a quantidade de linhas, a quantidade de palavras e a quantidade de caracteres, desse arquivo: $ wc arquivo.txt Se usar a op\u00e7\u00e3o -l , mostra apenas as linhas. Se usar a op\u00e7\u00e3o -w , ele mostra as palavras. Se usar -m ele mostra de caracteres. A op\u00e7\u00e3o -c aponta a quantidade de bytes. Se vc der um wc * dentro de um diret\u00f3rio, ele vai apresentar dados sobre a quantidade de linhas, palavras e caracteres de todos os arquivos que estiverem dentro do diret\u00f3rio. trazendo o total no final. Podemos fazer combina\u00e7\u00f5es, tipo de cat + | + wc : $ cat arquivo.txt | wc -l ou tail + | + wc : $ tail -n10 arquivo.txt | wc","title":"O COMANDO wc"},{"location":"Modulo_103.2-aula01/#o-comando-nl","text":"O nl \u00e9 igual ao cat -b , ignorando linhas em branco: $ nl arquivo.txt","title":"O COMANDO nl"},{"location":"Modulo_103.2-aula01/#o-comando-sort","text":"O sort serve pra ordenar alfab\u00e9ticamente um arquivo. Se usar a op\u00e7\u00e3o -r , ele ordena reversamente, ao contr\u00e1rio do alfabeto. As demais op\u00e7\u00f5es do sort, podem ser estudadas com sort -h .","title":"O COMANDO sort"},{"location":"Modulo_103.2-aula01/#o-comando-uniq","text":"O uniq serve pra mostrar entradas \u00fanicas dentro de um arquivo com repeti\u00e7\u00f5es, ou seja, ele mostra ocorr\u00eancias \u00fanicas, sem as repeti\u00e7\u00f5es que possam ocorrer no arquivo: $ unique arquivo.txt Se houverem dois eventos de \u201clinux\u201d, ele tr\u00e1s apenas um deles. Se usar com a op\u00e7\u00e3o -k , ele ordena pelo segundo campo, tipo nome e sobrenome, ele ordenaria alfab\u00e9ticamente o sobrenome. THAT\u2019S ALL FOLKS!!","title":"O COMANDO uniq"},{"location":"NFS_Server/","text":"\ud83d\udcc1 NFS Server no Debian Linux O NFS (Network File System) permite que sistemas Linux compartilhem diret\u00f3rios e arquivos pela rede, como se estivessem em um mesmo disco local. Neste tutorial, voc\u00ea aprender\u00e1 a configurar um servidor NFS no Debian Linux e montar os compartilhamentos em clientes. \ud83d\udda5\ufe0f 1. Pr\u00e9-requisitos Um servidor rodando Linux Acesso root ou permiss\u00f5es sudo Um ou mais clientes Linux (tamb\u00e9m pode ser Debian, Ubuntu, CentOS, etc.) \ud83d\udce6 2. Instalando o Servidor NFS No servidor: sudo apt update sudo apt install nfs-kernel-server -y \ud83d\udcc2 3. Criando Diret\u00f3rio para Compartilhamento Crie a pasta que ser\u00e1 compartilhada: sudo mkdir -p /srv/nfs/<minha-pasta> Defina as permiss\u00f5es (exemplo: acesso leitura/escrita para todos os clientes da rede): sudo chown -R nobody:nogroup /srv/nfs/<minha-pasta> sudo chmod -R 777 /srv/nfs/<minha-pasta> Valide as permiss\u00f5es: sudo ls -l /srv/nfs/<minha-pasta> \u2699\ufe0f 4. Configurando o Arquivo de EXPORTA\u00c7\u00c3O para a rede ter acesso \u00e1 SUA pasta. Edite o arquivo /etc/exports : sudo vim /etc/exports Adicione uma linha especificando o diret\u00f3rio e as permiss\u00f5es. Exemplo (compartilhar para toda a rede local 192.168.0.0/24 ): /srv/nfs/<minha-pasta> 192.168.0.0/24(rw,sync,no_subtree_check,no_root_squash) Par\u00e2metros principais: rw \u2192 leitura e escrita sync \u2192 grava dados imediatamente no disco (mais seguro) no_subtree_check \u2192 melhora desempenho em subdiret\u00f3rios no_root_squash \u2192 Permite acesso sem o usu\u00e1rio root Ap\u00f3s salvar, aplique as configura\u00e7\u00f5es: sudo exportfs -ra \u25b6\ufe0f 5. Iniciando e Habilitando o Servi\u00e7o sudo systemctl enable nfs-server sudo systemctl start nfs-server sudo systemctl status nfs-server \ud83d\udcbb 7. Configurando o Cliente NFS No cliente (exemplo: outro Debian/Ubuntu): 7.1 Instale o cliente NFS sudo apt install nfs-common -y 7.2 Crie um ponto de montagem sudo mkdir -p /mnt/nfs/compartilhado 7.3 Monte manualmente o compartilhamento sudo mount <ip-do-amigo>:/srv/nfs/<path-do-amigo /mnt/nfs/compartilhado (Substitua <ip-do-amigo> pelo ip do Servidor NFS Remoto) Verifique com: df -h | grep nfs 7.4 Montagem autom\u00e1tica no boot (substitua com o ip do Servidor NFS Remoto) Edite o arquivo /etc/fstab e adicione: <ip-do-amigo>:/srv/nfs/<pasta-do-amigo> /mnt/nfs/compartilhado nfs defaults 0 0 \ud83d\udee0\ufe0f 8. Testando a Configura\u00e7\u00e3o No cliente: touch /mnt/nfs/compartilhado/teste.txt Verifique no servidor: ls -l /srv/nfs/compartilhado/ Se o arquivo aparecer, o compartilhamento est\u00e1 funcionando corretamente. Para desmontar, use o comando: sudo umount /mnt/nfs/compartilhado \u2705 Conclus\u00e3o Agora voc\u00ea tem um servidor NFS configurado no Debian Linux , com compartilhamento acess\u00edvel a clientes da rede. Esse m\u00e9todo \u00e9 \u00fatil para armazenamento centralizado, clusters de servidores e ambientes de virtualiza\u00e7\u00e3o . That's all Folks!","title":"\ud83d\udcc1 NFS Server no Debian Linux"},{"location":"NFS_Server/#nfs-server-no-debian-linux","text":"O NFS (Network File System) permite que sistemas Linux compartilhem diret\u00f3rios e arquivos pela rede, como se estivessem em um mesmo disco local. Neste tutorial, voc\u00ea aprender\u00e1 a configurar um servidor NFS no Debian Linux e montar os compartilhamentos em clientes.","title":"\ud83d\udcc1 NFS Server no Debian Linux"},{"location":"NFS_Server/#1-pre-requisitos","text":"Um servidor rodando Linux Acesso root ou permiss\u00f5es sudo Um ou mais clientes Linux (tamb\u00e9m pode ser Debian, Ubuntu, CentOS, etc.)","title":"\ud83d\udda5\ufe0f 1. Pr\u00e9-requisitos"},{"location":"NFS_Server/#2-instalando-o-servidor-nfs","text":"No servidor: sudo apt update sudo apt install nfs-kernel-server -y","title":"\ud83d\udce6 2. Instalando o Servidor NFS"},{"location":"NFS_Server/#3-criando-diretorio-para-compartilhamento","text":"Crie a pasta que ser\u00e1 compartilhada: sudo mkdir -p /srv/nfs/<minha-pasta> Defina as permiss\u00f5es (exemplo: acesso leitura/escrita para todos os clientes da rede): sudo chown -R nobody:nogroup /srv/nfs/<minha-pasta> sudo chmod -R 777 /srv/nfs/<minha-pasta> Valide as permiss\u00f5es: sudo ls -l /srv/nfs/<minha-pasta>","title":"\ud83d\udcc2 3. Criando Diret\u00f3rio para Compartilhamento"},{"location":"NFS_Server/#4-configurando-o-arquivo-de-exportacao-para-a-rede-ter-acesso-a-sua-pasta","text":"Edite o arquivo /etc/exports : sudo vim /etc/exports Adicione uma linha especificando o diret\u00f3rio e as permiss\u00f5es. Exemplo (compartilhar para toda a rede local 192.168.0.0/24 ): /srv/nfs/<minha-pasta> 192.168.0.0/24(rw,sync,no_subtree_check,no_root_squash) Par\u00e2metros principais: rw \u2192 leitura e escrita sync \u2192 grava dados imediatamente no disco (mais seguro) no_subtree_check \u2192 melhora desempenho em subdiret\u00f3rios no_root_squash \u2192 Permite acesso sem o usu\u00e1rio root Ap\u00f3s salvar, aplique as configura\u00e7\u00f5es: sudo exportfs -ra","title":"\u2699\ufe0f 4. Configurando o Arquivo de EXPORTA\u00c7\u00c3O para a rede ter acesso \u00e1 SUA pasta."},{"location":"NFS_Server/#5-iniciando-e-habilitando-o-servico","text":"sudo systemctl enable nfs-server sudo systemctl start nfs-server sudo systemctl status nfs-server","title":"\u25b6\ufe0f 5. Iniciando e Habilitando o Servi\u00e7o"},{"location":"NFS_Server/#7-configurando-o-cliente-nfs","text":"No cliente (exemplo: outro Debian/Ubuntu):","title":"\ud83d\udcbb 7. Configurando o Cliente NFS"},{"location":"NFS_Server/#71-instale-o-cliente-nfs","text":"sudo apt install nfs-common -y","title":"7.1 Instale o cliente NFS"},{"location":"NFS_Server/#72-crie-um-ponto-de-montagem","text":"sudo mkdir -p /mnt/nfs/compartilhado","title":"7.2 Crie um ponto de montagem"},{"location":"NFS_Server/#73-monte-manualmente-o-compartilhamento","text":"sudo mount <ip-do-amigo>:/srv/nfs/<path-do-amigo /mnt/nfs/compartilhado (Substitua <ip-do-amigo> pelo ip do Servidor NFS Remoto) Verifique com: df -h | grep nfs","title":"7.3 Monte manualmente o compartilhamento"},{"location":"NFS_Server/#74-montagem-automatica-no-boot-substitua-com-o-ip-do-servidor-nfs-remoto","text":"Edite o arquivo /etc/fstab e adicione: <ip-do-amigo>:/srv/nfs/<pasta-do-amigo> /mnt/nfs/compartilhado nfs defaults 0 0","title":"7.4 Montagem autom\u00e1tica no boot (substitua com o ip do Servidor NFS Remoto)"},{"location":"NFS_Server/#8-testando-a-configuracao","text":"No cliente: touch /mnt/nfs/compartilhado/teste.txt Verifique no servidor: ls -l /srv/nfs/compartilhado/ Se o arquivo aparecer, o compartilhamento est\u00e1 funcionando corretamente. Para desmontar, use o comando: sudo umount /mnt/nfs/compartilhado","title":"\ud83d\udee0\ufe0f 8. Testando a Configura\u00e7\u00e3o"},{"location":"NFS_Server/#conclusao","text":"Agora voc\u00ea tem um servidor NFS configurado no Debian Linux , com compartilhamento acess\u00edvel a clientes da rede. Esse m\u00e9todo \u00e9 \u00fatil para armazenamento centralizado, clusters de servidores e ambientes de virtualiza\u00e7\u00e3o . That's all Folks!","title":"\u2705 Conclus\u00e3o"},{"location":"OpenSUSE/","text":"OpenSUSE TW P\u00f3s instala\u00e7\u00e3o: Atualiza a distibui\u00e7\u00e3o sudo zypper ref && sudo zypper dup Alterando o valor da swappiness sudo nano /etc/sysctl.conf vm.swappiness=10 Adicionando o Reposit\u00f3rio Packman (codecs non-free) sudo zypper addrepo -cfp 90 'https://ftp.gwdg.de/pub/linux/misc/packman/suse/openSUSE_Tumbleweed/' packman Importando a chave da assinatura GPG do reposit\u00f3rio sudo zypper --gpg-auto-import-keys ref Atualiza\u00e7\u00e3o no sistema a partir do reposit\u00f3rio Packman sudo zypper dist-upgrade --from packman --allow-vendor-change Instalando os codecs no openSUSE Tumbleweed sudo zypper install --from packman ffmpeg gstreamer-plugins-{good,bad,ugly,libav} libavcodec Adicionando o reposit\u00f3rio Flathub (Flatpak) sudo zypper in flatpak flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo Instalando a m\u00e1quina virtual JAVA sudo zypper in java-24-openjdk Suporte para extra\u00e7\u00e3o e compacta\u00e7\u00e3o de arquivos sudo zypper in bzip2 cabextract lhasa lzip 7zip rar unrar unzip zip Baixar torrents sudo zypper in qbittorrent Player VLC sudo zypper in --from packman vlc vlc-codecs Edi\u00e7\u00e3o de v\u00eddeo sudo zypper in --from packman kdenlive Grava\u00e7\u00e3o de tela sudo zypper in --from packman obs-studio Cliente de email sudo zypper in thunderbird Cliente de chat flatpak install discord flatpak install telegram Ferramentas para gerenciamento de Banco de dados flatpak install dbeaver flatpak install pgadmin4 Navegadores flatpak install chrome flatpak install edge Ferramenta de acesso remoto flatpak install rustdesk Gerenciamento de discos sudo zypper in gparted Instalando o Virtualbox sudo zypper in virtualbox virtualbox-guest-tools sudo gpasswd -a $USER vboxusers Gnome Instale o Gerenciador de Extens\u00f5es, pelo \"Programas\" e busque pela extens\u00e3o \"dash2doc animated\" MKDocs Server sudo zypper install python313-pipx sudo pipx install mkdocs sudo mkdocs --version sudo mkdocs new mkdocs sudo mkdocs build mkdocs serve -a localhost","title":"OpenSUSE TW P\u00f3s instala\u00e7\u00e3o:"},{"location":"OpenSUSE/#opensuse-tw-pos-instalacao","text":"","title":"OpenSUSE TW P\u00f3s instala\u00e7\u00e3o:"},{"location":"OpenSUSE/#atualiza-a-distibuicao","text":"sudo zypper ref && sudo zypper dup","title":"Atualiza a distibui\u00e7\u00e3o"},{"location":"OpenSUSE/#alterando-o-valor-da-swappiness","text":"sudo nano /etc/sysctl.conf vm.swappiness=10","title":"Alterando o valor da swappiness"},{"location":"OpenSUSE/#adicionando-o-repositorio-packman-codecs-non-free","text":"sudo zypper addrepo -cfp 90 'https://ftp.gwdg.de/pub/linux/misc/packman/suse/openSUSE_Tumbleweed/' packman","title":"Adicionando o Reposit\u00f3rio Packman (codecs non-free)"},{"location":"OpenSUSE/#importando-a-chave-da-assinatura-gpg-do-repositorio","text":"sudo zypper --gpg-auto-import-keys ref","title":"Importando a chave da assinatura GPG do reposit\u00f3rio"},{"location":"OpenSUSE/#atualizacao-no-sistema-a-partir-do-repositorio-packman","text":"sudo zypper dist-upgrade --from packman --allow-vendor-change","title":"Atualiza\u00e7\u00e3o no sistema a partir do reposit\u00f3rio Packman"},{"location":"OpenSUSE/#instalando-os-codecs-no-opensuse-tumbleweed","text":"sudo zypper install --from packman ffmpeg gstreamer-plugins-{good,bad,ugly,libav} libavcodec","title":"Instalando os codecs no openSUSE Tumbleweed"},{"location":"OpenSUSE/#adicionando-o-repositorio-flathub-flatpak","text":"sudo zypper in flatpak flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo","title":"Adicionando o reposit\u00f3rio Flathub (Flatpak)"},{"location":"OpenSUSE/#instalando-a-maquina-virtual-java","text":"sudo zypper in java-24-openjdk","title":"Instalando a m\u00e1quina virtual JAVA"},{"location":"OpenSUSE/#suporte-para-extracao-e-compactacao-de-arquivos","text":"sudo zypper in bzip2 cabextract lhasa lzip 7zip rar unrar unzip zip","title":"Suporte para extra\u00e7\u00e3o e compacta\u00e7\u00e3o de arquivos"},{"location":"OpenSUSE/#baixar-torrents","text":"sudo zypper in qbittorrent","title":"Baixar torrents"},{"location":"OpenSUSE/#player-vlc","text":"sudo zypper in --from packman vlc vlc-codecs","title":"Player VLC"},{"location":"OpenSUSE/#edicao-de-video","text":"sudo zypper in --from packman kdenlive","title":"Edi\u00e7\u00e3o de v\u00eddeo"},{"location":"OpenSUSE/#gravacao-de-tela","text":"sudo zypper in --from packman obs-studio","title":"Grava\u00e7\u00e3o de tela"},{"location":"OpenSUSE/#cliente-de-email","text":"sudo zypper in thunderbird","title":"Cliente de email"},{"location":"OpenSUSE/#cliente-de-chat","text":"flatpak install discord flatpak install telegram","title":"Cliente de chat"},{"location":"OpenSUSE/#ferramentas-para-gerenciamento-de-banco-de-dados","text":"flatpak install dbeaver flatpak install pgadmin4","title":"Ferramentas para gerenciamento de Banco de dados"},{"location":"OpenSUSE/#navegadores","text":"flatpak install chrome flatpak install edge","title":"Navegadores"},{"location":"OpenSUSE/#ferramenta-de-acesso-remoto","text":"flatpak install rustdesk","title":"Ferramenta de acesso remoto"},{"location":"OpenSUSE/#gerenciamento-de-discos","text":"sudo zypper in gparted","title":"Gerenciamento de discos"},{"location":"OpenSUSE/#instalando-o-virtualbox","text":"sudo zypper in virtualbox virtualbox-guest-tools sudo gpasswd -a $USER vboxusers","title":"Instalando o Virtualbox"},{"location":"OpenSUSE/#gnome","text":"Instale o Gerenciador de Extens\u00f5es, pelo \"Programas\" e busque pela extens\u00e3o \"dash2doc animated\"","title":"Gnome"},{"location":"OpenSUSE/#mkdocs-server","text":"sudo zypper install python313-pipx sudo pipx install mkdocs sudo mkdocs --version sudo mkdocs new mkdocs sudo mkdocs build mkdocs serve -a localhost","title":"MKDocs Server"},{"location":"Permissoes_Linux-01/","text":"\ud83d\udcc1 Tutorial de Permiss\u00f5es de Arquivos e Diret\u00f3rios no Linux Aprenda a visualizar, modificar e entender o sistema de permiss\u00f5es no Linux utilizando comandos como chmod , chown e chgrp . \ud83d\udd0d Introdu\u00e7\u00e3o O sistema de permiss\u00f5es do Linux \u00e9 fundamental para garantir a seguran\u00e7a e organiza\u00e7\u00e3o do sistema. Cada arquivo ou diret\u00f3rio possui regras que definem quem pode ler (r) , escrever (w) e executar (x) . \ud83d\udcd1 Entendendo as Permiss\u00f5es Execute: ls -l Exemplo de sa\u00edda: -rwxr-xr-- 1 user grupo 1234 jul 28 10:00 script.sh Explicando os campos: Campo Significado - Tipo de arquivo ( - arquivo, d diret\u00f3rio) rwx Permiss\u00f5es do dono r-x Permiss\u00f5es do grupo r-- Permiss\u00f5es de outros (p\u00fablico) 1 N\u00famero de links user Dono do arquivo grupo Grupo do arquivo 1234 Tamanho em bytes jul 28 10:00 Data de modifica\u00e7\u00e3o script.sh Nome do arquivo \ud83d\udd27 Modificando Permiss\u00f5es: chmod \ud83e\uddee Modo Num\u00e9rico As permiss\u00f5es s\u00e3o representadas por n\u00fameros: Permiss\u00e3o Valor r (read) 4 w (write) 2 x (execute) 1 Exemplo : chmod 754 script.sh Isso define: Dono: 7 = rwx Grupo: 5 = r-x Outros: 4 = r-- \ud83d\udd24 Modo Simb\u00f3lico chmod u+x script.sh Adiciona permiss\u00e3o de execu\u00e7\u00e3o para o usu\u00e1rio (u) . Outros s\u00edmbolos: S\u00edmbolo Descri\u00e7\u00e3o u Usu\u00e1rio (owner) g Grupo o Outros a Todos + Adiciona permiss\u00e3o - Remove permiss\u00e3o = Define exatamente essas permiss\u00f5es Exemplos : chmod g-w arquivo.txt # Remove escrita do grupo chmod o=r arquivo.txt # Outros s\u00f3 podem ler chmod a+x script.sh # Todos ganham permiss\u00e3o de execu\u00e7\u00e3o \ud83d\udc64 Mudando Dono e Grupo: chown e chgrp chown \u2013 Altera o dono e/ou grupo chown novo_dono arquivo.txt chown novo_dono:novo_grupo arquivo.txt chgrp \u2013 Altera apenas o grupo chgrp novo_grupo arquivo.txt Exemplo : chown joao:desenvolvedores projeto/ \ud83d\udcc1 Permiss\u00f5es em Diret\u00f3rios As permiss\u00f5es t\u00eam efeitos diferentes: Permiss\u00e3o Significado no diret\u00f3rio r Listar arquivos ( ls ) w Criar/apagar arquivos x Acessar arquivos no diret\u00f3rio \ud83d\udd04 Permiss\u00f5es Recursivas chmod -R 755 pasta/ chown -R user:grupo pasta/ \ud83d\udccc Permiss\u00f5es Especiais \ud83d\udd12 setuid (S) Permite que o programa execute com permiss\u00f5es do dono. chmod u+s arquivo \ud83d\udd12 setgid (S) Arquivos criados no diret\u00f3rio herdam o grupo. chmod g+s pasta \ud83d\udd12 Sticky bit (t) Em diret\u00f3rios p\u00fablicos, evita que usu\u00e1rios deletem arquivos de outros. chmod +t /tmp \ud83e\uddea Exemplos Pr\u00e1ticos 1. Tornar um script execut\u00e1vel apenas para o dono: chmod 700 script.sh 2. Permitir que todos leiam um arquivo, mas apenas o dono possa editar: chmod 644 documento.txt 3. Definir uma pasta compartilhada por um grupo: chgrp grupo pasta/ chmod 2770 pasta/ \u2705 Verificando Permiss\u00f5es stat arquivo.txt \ud83d\uded1 Aten\u00e7\u00e3o Cuidado com chmod 777 \u2014 permite tudo para todos, o que representa risco de seguran\u00e7a. Modifique permiss\u00f5es com consci\u00eancia, especialmente em ambientes multiusu\u00e1rio ou servidores. \ud83d\udcda Refer\u00eancias man chmod man chown man chgrp The Linux Documentation Project","title":"\ud83d\udcc1 Tutorial de Permiss\u00f5es de Arquivos e Diret\u00f3rios no Linux"},{"location":"Permissoes_Linux-01/#tutorial-de-permissoes-de-arquivos-e-diretorios-no-linux","text":"Aprenda a visualizar, modificar e entender o sistema de permiss\u00f5es no Linux utilizando comandos como chmod , chown e chgrp .","title":"\ud83d\udcc1 Tutorial de Permiss\u00f5es de Arquivos e Diret\u00f3rios no Linux"},{"location":"Permissoes_Linux-01/#introducao","text":"O sistema de permiss\u00f5es do Linux \u00e9 fundamental para garantir a seguran\u00e7a e organiza\u00e7\u00e3o do sistema. Cada arquivo ou diret\u00f3rio possui regras que definem quem pode ler (r) , escrever (w) e executar (x) .","title":"\ud83d\udd0d Introdu\u00e7\u00e3o"},{"location":"Permissoes_Linux-01/#entendendo-as-permissoes","text":"Execute: ls -l Exemplo de sa\u00edda: -rwxr-xr-- 1 user grupo 1234 jul 28 10:00 script.sh Explicando os campos: Campo Significado - Tipo de arquivo ( - arquivo, d diret\u00f3rio) rwx Permiss\u00f5es do dono r-x Permiss\u00f5es do grupo r-- Permiss\u00f5es de outros (p\u00fablico) 1 N\u00famero de links user Dono do arquivo grupo Grupo do arquivo 1234 Tamanho em bytes jul 28 10:00 Data de modifica\u00e7\u00e3o script.sh Nome do arquivo","title":"\ud83d\udcd1 Entendendo as Permiss\u00f5es"},{"location":"Permissoes_Linux-01/#modificando-permissoes-chmod","text":"","title":"\ud83d\udd27 Modificando Permiss\u00f5es: chmod"},{"location":"Permissoes_Linux-01/#modo-numerico","text":"As permiss\u00f5es s\u00e3o representadas por n\u00fameros: Permiss\u00e3o Valor r (read) 4 w (write) 2 x (execute) 1 Exemplo : chmod 754 script.sh Isso define: Dono: 7 = rwx Grupo: 5 = r-x Outros: 4 = r--","title":"\ud83e\uddee Modo Num\u00e9rico"},{"location":"Permissoes_Linux-01/#modo-simbolico","text":"chmod u+x script.sh Adiciona permiss\u00e3o de execu\u00e7\u00e3o para o usu\u00e1rio (u) . Outros s\u00edmbolos: S\u00edmbolo Descri\u00e7\u00e3o u Usu\u00e1rio (owner) g Grupo o Outros a Todos + Adiciona permiss\u00e3o - Remove permiss\u00e3o = Define exatamente essas permiss\u00f5es Exemplos : chmod g-w arquivo.txt # Remove escrita do grupo chmod o=r arquivo.txt # Outros s\u00f3 podem ler chmod a+x script.sh # Todos ganham permiss\u00e3o de execu\u00e7\u00e3o","title":"\ud83d\udd24 Modo Simb\u00f3lico"},{"location":"Permissoes_Linux-01/#mudando-dono-e-grupo-chown-e-chgrp","text":"","title":"\ud83d\udc64 Mudando Dono e Grupo: chown e chgrp"},{"location":"Permissoes_Linux-01/#chown-altera-o-dono-eou-grupo","text":"chown novo_dono arquivo.txt chown novo_dono:novo_grupo arquivo.txt","title":"chown \u2013 Altera o dono e/ou grupo"},{"location":"Permissoes_Linux-01/#chgrp-altera-apenas-o-grupo","text":"chgrp novo_grupo arquivo.txt Exemplo : chown joao:desenvolvedores projeto/","title":"chgrp \u2013 Altera apenas o grupo"},{"location":"Permissoes_Linux-01/#permissoes-em-diretorios","text":"As permiss\u00f5es t\u00eam efeitos diferentes: Permiss\u00e3o Significado no diret\u00f3rio r Listar arquivos ( ls ) w Criar/apagar arquivos x Acessar arquivos no diret\u00f3rio","title":"\ud83d\udcc1 Permiss\u00f5es em Diret\u00f3rios"},{"location":"Permissoes_Linux-01/#permissoes-recursivas","text":"chmod -R 755 pasta/ chown -R user:grupo pasta/","title":"\ud83d\udd04 Permiss\u00f5es Recursivas"},{"location":"Permissoes_Linux-01/#permissoes-especiais","text":"","title":"\ud83d\udccc Permiss\u00f5es Especiais"},{"location":"Permissoes_Linux-01/#setuid-s","text":"Permite que o programa execute com permiss\u00f5es do dono. chmod u+s arquivo","title":"\ud83d\udd12 setuid (S)"},{"location":"Permissoes_Linux-01/#setgid-s","text":"Arquivos criados no diret\u00f3rio herdam o grupo. chmod g+s pasta","title":"\ud83d\udd12 setgid (S)"},{"location":"Permissoes_Linux-01/#sticky-bit-t","text":"Em diret\u00f3rios p\u00fablicos, evita que usu\u00e1rios deletem arquivos de outros. chmod +t /tmp","title":"\ud83d\udd12 Sticky bit (t)"},{"location":"Permissoes_Linux-01/#exemplos-praticos","text":"","title":"\ud83e\uddea Exemplos Pr\u00e1ticos"},{"location":"Permissoes_Linux-01/#1-tornar-um-script-executavel-apenas-para-o-dono","text":"chmod 700 script.sh","title":"1. Tornar um script execut\u00e1vel apenas para o dono:"},{"location":"Permissoes_Linux-01/#2-permitir-que-todos-leiam-um-arquivo-mas-apenas-o-dono-possa-editar","text":"chmod 644 documento.txt","title":"2. Permitir que todos leiam um arquivo, mas apenas o dono possa editar:"},{"location":"Permissoes_Linux-01/#3-definir-uma-pasta-compartilhada-por-um-grupo","text":"chgrp grupo pasta/ chmod 2770 pasta/","title":"3. Definir uma pasta compartilhada por um grupo:"},{"location":"Permissoes_Linux-01/#verificando-permissoes","text":"stat arquivo.txt","title":"\u2705 Verificando Permiss\u00f5es"},{"location":"Permissoes_Linux-01/#atencao","text":"Cuidado com chmod 777 \u2014 permite tudo para todos, o que representa risco de seguran\u00e7a. Modifique permiss\u00f5es com consci\u00eancia, especialmente em ambientes multiusu\u00e1rio ou servidores.","title":"\ud83d\uded1 Aten\u00e7\u00e3o"},{"location":"Permissoes_Linux-01/#referencias","text":"man chmod man chown man chgrp The Linux Documentation Project","title":"\ud83d\udcda Refer\u00eancias"},{"location":"Permissoes_Linux-02/","text":"\ud83d\udcc1 Tutorial de Permiss\u00f5es de Arquivos e Diret\u00f3rios no Linux - Fixa\u00e7\u00e3o ... PERMISS\u00d5ES TRATAM DE CRIA\u00c7\u00c3O/ACESSO \u00c1 ARQUIVOS/DIRET\u00d3RIOS. SEM ELAS, O USU\u00c1RIO N\u00c3O PODE ACESSAR, EXCLUIR OU EXECUTAR NADA RELATIVO \u00c1 ARQUIVOS OU DIRET\u00d3RIOS. OBSERVE AS PERMISS\u00d5ES DE SEUS ARQUIVOS E DIRET\u00d3RIOS COM O COMANDO ls -l: $ cd ~ $ ls -l SENDO QUE: DONO => QUEM CRIOU O ARQUIVO/DIRET\u00d3RIO GRUPO => PERMITE QUE OUTROS USU\u00c1RIOS TENHAM PERMISS\u00d5ES NO ARQUIVO/DIRET\u00d3RIO OUTROS => USU\u00c1RIOS QUE N\u00c3O S\u00c3O DONOS NEM PERTENCEM A GRUPOS COM ACESSO/PERMISS\u00d5ES OS TIPOS DE PERMISS\u00d5ES E SEUS SIGNIFICADOS, COM RELA\u00c7\u00c3O \u00c1 ARQUIVOS E TB\u00c9M COM RELA\u00c7\u00c3O \u00c1 DIRET\u00d3RIOS: r => significa permiss\u00e3o de leitura/acesso (read); w => significa permiss\u00e3o de grava\u00e7\u00e3o (write); x => significa permiss\u00e3o de execu\u00e7\u00e3o/acesso (execution); - => significa permiss\u00e3o desabilitada. --- => nenhuma permiss\u00e3o; r-- => permiss\u00e3o de leitura; r-x => leitura e execu\u00e7\u00e3o; rw- => leitura e grava\u00e7\u00e3o; rwx => leitura, grava\u00e7\u00e3o e execu\u00e7\u00e3o. OS COMANDOS chmod E chown A ALTERA\u00c7\u00c3O DE PERMISS\u00d5ES SE D\u00c1 COM OS COMANDOS chmod E chown. SENDO QUE chmod MUDA A PERMISS\u00c3O DE LEITURA/GRAVA\u00c7\u00c3O/EXECU\u00c7\u00c3O, EQTO O chown MODIFICA O USU\u00c1RIO/GRUPO PROPRIET\u00c1RIO DO ARQUIVO/DIRET\u00d3RIO. ENT\u00c3O, TEMOS PERMISS\u00d5ES POR PROPRIET\u00c1RIO, GRUPO E OUTROS, DIVIDIDOS POR: DONO GRUPO OUTROS rwx r-x r-x O LINUX VALIDA SE O USU\u00c1RIO \u00c9 O DONO DO ARQUIVO/DIRET\u00d3RIO, E APLICA AS PERMISS\u00d5ES DE DONO, DEPOIS ELE VALIDA SE O GRUPO PERTENCE AOS QUE TEM ACESSO AO ARQUIVO/DIRET\u00d3RIO, E DEPOIS APLICA AS PERMISS\u00d5ES DE GRUPO, CASO N\u00c3O SEJA DONO E NEM PERTEN\u00c7A AOS GRUPOS COM POL\u00cdTICAS DE ACESSO, O SISTEMA VALIDA AS PERMISS\u00d5ES DO GRUPO 'OUTROS'. MODIFICANDO PERMISS\u00d5ES DE ARQUIVOS/DIRET\u00d3RIOS COM O COMANDO chmod: chmod [op\u00e7\u00f5es] [permiss\u00f5es] [arquivo/diret\u00f3rio] O LINUX ENTENDE AS LETRAS INICIAIS u, g E o, como usuario, grupo E outros para setar as permiss\u00f5es, com adi\u00e7\u00e3o do s\u00edmbolo de '+' para adicionar e do s\u00edmbolo de '-' para remover permiss\u00e3o. PARA DAR PERMISS\u00c3O DE EXECU\u00c7\u00c3O A UM SCRIPT, PARA O USU\u00c1RIO LOGADO, USAMOS A COMBINA\u00c7\u00c3O: $ chmod +x /home/snarl/aplicativo.sh $ ls -l J\u00c1 PARA UMA PERMISS\u00c3O DE ESCRITA PARA GRUPO E OUTROS, FICARIA $ chmod go+w /home/snarl/aplicativo.sh PARA REMOVER A PERMISS\u00c3O DE ESCRITA PARA GRUPO E LEITURA PARA 'OUTROS', FICARIA: $ chmod o-w, o-r /home/snarl/aplicativo.sh $ ls -l OUTRO MODO DE MODIFICAR PERMISS\u00d5ES, \u00c9 USANDO UMA COMBINA\u00c7\u00c3O EM OCTAL, ONDE UM CONJUNTO DE 8 N\u00daMEROS DEFINE AS PERMISS\u00d5ES DE ACESSO Valor Octal | Valor Bin\u00e1rio rwx Caracteres Significado 0 000 \u2212\u2212\u2212 nenhuma permiss\u00e3o de acesso 1 001 \u2212\u2212x permiss\u00e3o de execu\u00e7\u00e3o 2 010 -w- permiss\u00e3o de grava\u00e7\u00e3o 3 011 -wx permiss\u00e3o de grava\u00e7\u00e3o e execu\u00e7\u00e3o 4 100 r\u2212\u2212 permiss\u00e3o de leitura 5 101 r-x permiss\u00e3o de leitura e execu\u00e7\u00e3o 6 110 rw- permiss\u00e3o de leitura e grava\u00e7\u00e3o 7 111 rwx permiss\u00e3o de leitura, grava\u00e7\u00e3o e execu\u00e7\u00e3o OU SEJA, PARA REMOVER TODAS AS PERMISS\u00d5ES, USAMOS: $ chmod 000 /home/snarl/aplicativo.sh $ ls -l ENT\u00c3O SE TEMOS X=1, W=2 E R=4, PODEMOS CRIAR COMBINA\u00c7\u00d5ES DE OCTAIS PARA DEFINIR ACESSOS. POR EXEMPLO, SE FOSSEMOS DAR PERMISS\u00c3O DE RWX PARA O DONO E DE RX PARA OS GRUPOS E OUTROS, FAR\u00cdAMOS AS SEGUINTES COMBINA\u00c7\u00d5ES: $ chmod 755 /home/snarl/aplicativo.sh POIS ACESSO TOTAL CORRESPONDE \u00c1 rwx=7 E ACESSO SOMENTE LEITURA E EXECU\u00c7\u00c3O CORRESPONDE \u00c1 rx=5 MODIFICANDO PROPRIET\u00c1RIO DE ARQUIVOS/DIRET\u00d3RIOS COM O COMANDO chown O COMANDO chown SERVE PARA MUDAR O 'USU\u00c1RIO DONO' OU O 'GRUPO DONO', DE UM DETERMINADO ARQUIVO/DIRET\u00d3RIO: chown [op\u00e7oes] [dono:grupo] [diret\u00f3rio/arquivo] $ chown -R snarl:users /home/snarl/aplicativo.sh Sendo que o -R valida o comando recursivamente, em caso de aplicado \u00e1 diret\u00f3rios.","title":"\ud83d\udcc1 Tutorial de Permiss\u00f5es de Arquivos e Diret\u00f3rios no Linux - Fixa\u00e7\u00e3o ..."},{"location":"Permissoes_Linux-02/#tutorial-de-permissoes-de-arquivos-e-diretorios-no-linux-fixacao","text":"","title":"\ud83d\udcc1 Tutorial de Permiss\u00f5es de Arquivos e Diret\u00f3rios no Linux - Fixa\u00e7\u00e3o ..."},{"location":"Permissoes_Linux-02/#permissoes-tratam-de-criacaoacesso-a-arquivosdiretorios-sem-elas-o-usuario-nao-pode-acessar-excluir-ou-executar-nada-relativo-a-arquivos-ou-diretorios","text":"","title":"PERMISS\u00d5ES TRATAM DE CRIA\u00c7\u00c3O/ACESSO \u00c1 ARQUIVOS/DIRET\u00d3RIOS. SEM ELAS, O USU\u00c1RIO N\u00c3O PODE ACESSAR, EXCLUIR OU EXECUTAR NADA RELATIVO \u00c1 ARQUIVOS OU DIRET\u00d3RIOS."},{"location":"Permissoes_Linux-02/#observe-as-permissoes-de-seus-arquivos-e-diretorios-com-o-comando-ls-l","text":"$ cd ~ $ ls -l","title":"OBSERVE AS PERMISS\u00d5ES DE SEUS ARQUIVOS E DIRET\u00d3RIOS COM O COMANDO ls -l:"},{"location":"Permissoes_Linux-02/#sendo-que","text":"","title":"SENDO QUE:"},{"location":"Permissoes_Linux-02/#dono-quem-criou-o-arquivodiretorio","text":"","title":"DONO =&gt; QUEM CRIOU O ARQUIVO/DIRET\u00d3RIO"},{"location":"Permissoes_Linux-02/#grupo-permite-que-outros-usuarios-tenham-permissoes-no-arquivodiretorio","text":"","title":"GRUPO =&gt; PERMITE QUE OUTROS USU\u00c1RIOS TENHAM PERMISS\u00d5ES NO ARQUIVO/DIRET\u00d3RIO"},{"location":"Permissoes_Linux-02/#outros-usuarios-que-nao-sao-donos-nem-pertencem-a-grupos-com-acessopermissoes","text":"","title":"OUTROS =&gt; USU\u00c1RIOS QUE N\u00c3O S\u00c3O DONOS NEM PERTENCEM A GRUPOS COM ACESSO/PERMISS\u00d5ES"},{"location":"Permissoes_Linux-02/#os-tipos-de-permissoes-e-seus-significados-com-relacao-a-arquivos-e-tbem-com-relacao-a-diretorios","text":"r => significa permiss\u00e3o de leitura/acesso (read); w => significa permiss\u00e3o de grava\u00e7\u00e3o (write); x => significa permiss\u00e3o de execu\u00e7\u00e3o/acesso (execution); - => significa permiss\u00e3o desabilitada. --- => nenhuma permiss\u00e3o; r-- => permiss\u00e3o de leitura; r-x => leitura e execu\u00e7\u00e3o; rw- => leitura e grava\u00e7\u00e3o; rwx => leitura, grava\u00e7\u00e3o e execu\u00e7\u00e3o.","title":"OS TIPOS DE PERMISS\u00d5ES E SEUS SIGNIFICADOS, COM RELA\u00c7\u00c3O \u00c1 ARQUIVOS E TB\u00c9M COM RELA\u00c7\u00c3O \u00c1 DIRET\u00d3RIOS:"},{"location":"Permissoes_Linux-02/#os-comandos-chmod-e-chown","text":"","title":"OS COMANDOS chmod E chown"},{"location":"Permissoes_Linux-02/#a-alteracao-de-permissoes-se-da-com-os-comandos-chmod-e-chown-sendo-que-chmod-muda-a-permissao-de-leituragravacaoexecucao-eqto-o-chown-modifica-o-usuariogrupo-proprietario-do-arquivodiretorio","text":"","title":"A ALTERA\u00c7\u00c3O DE PERMISS\u00d5ES SE D\u00c1 COM OS COMANDOS chmod E chown. SENDO QUE chmod MUDA A PERMISS\u00c3O DE LEITURA/GRAVA\u00c7\u00c3O/EXECU\u00c7\u00c3O, EQTO O chown MODIFICA O USU\u00c1RIO/GRUPO PROPRIET\u00c1RIO DO ARQUIVO/DIRET\u00d3RIO."},{"location":"Permissoes_Linux-02/#entao-temos-permissoes-por-proprietario-grupo-e-outros-divididos-por","text":"DONO GRUPO OUTROS rwx r-x r-x","title":"ENT\u00c3O, TEMOS PERMISS\u00d5ES POR PROPRIET\u00c1RIO, GRUPO E OUTROS, DIVIDIDOS POR:"},{"location":"Permissoes_Linux-02/#o-linux-valida-se-o-usuario-e-o-dono-do-arquivodiretorio-e-aplica-as-permissoes-de-dono-depois-ele-valida-se-o-grupo-pertence-aos-que-tem-acesso-ao-arquivodiretorio-e-depois-aplica-as-permissoes-de-grupo-caso-nao-seja-dono-e-nem-pertenca-aos-grupos-com-politicas-de-acesso-o-sistema-valida-as-permissoes-do-grupo-outros","text":"","title":"O LINUX VALIDA SE O USU\u00c1RIO \u00c9 O DONO DO ARQUIVO/DIRET\u00d3RIO, E APLICA AS PERMISS\u00d5ES DE DONO, DEPOIS ELE VALIDA SE O GRUPO PERTENCE AOS QUE TEM ACESSO AO ARQUIVO/DIRET\u00d3RIO, E DEPOIS APLICA AS PERMISS\u00d5ES DE GRUPO, CASO N\u00c3O SEJA DONO E NEM PERTEN\u00c7A AOS GRUPOS COM POL\u00cdTICAS DE ACESSO, O SISTEMA VALIDA AS PERMISS\u00d5ES DO GRUPO 'OUTROS'."},{"location":"Permissoes_Linux-02/#modificando-permissoes-de-arquivosdiretorios-com-o-comando-chmod","text":"chmod [op\u00e7\u00f5es] [permiss\u00f5es] [arquivo/diret\u00f3rio]","title":"MODIFICANDO PERMISS\u00d5ES DE ARQUIVOS/DIRET\u00d3RIOS COM O COMANDO chmod:"},{"location":"Permissoes_Linux-02/#o-linux-entende-as-letras-iniciais-u-g-e-o-como-usuario-grupo-e-outros-para-setar-as-permissoes-com-adicao-do-simbolo-de-para-adicionar-e-do-simbolo-de-para-remover-permissao","text":"","title":"O LINUX ENTENDE AS LETRAS INICIAIS u, g E o, como usuario, grupo E outros para setar as permiss\u00f5es, com adi\u00e7\u00e3o do s\u00edmbolo de '+' para adicionar e do s\u00edmbolo de '-' para remover permiss\u00e3o."},{"location":"Permissoes_Linux-02/#para-dar-permissao-de-execucao-a-um-script-para-o-usuario-logado-usamos-a-combinacao","text":"$ chmod +x /home/snarl/aplicativo.sh $ ls -l","title":"PARA DAR PERMISS\u00c3O DE EXECU\u00c7\u00c3O A UM SCRIPT, PARA O USU\u00c1RIO LOGADO, USAMOS A COMBINA\u00c7\u00c3O:"},{"location":"Permissoes_Linux-02/#ja-para-uma-permissao-de-escrita-para-grupo-e-outros-ficaria","text":"$ chmod go+w /home/snarl/aplicativo.sh","title":"J\u00c1 PARA UMA PERMISS\u00c3O DE ESCRITA PARA GRUPO E OUTROS, FICARIA"},{"location":"Permissoes_Linux-02/#para-remover-a-permissao-de-escrita-para-grupo-e-leitura-para-outros-ficaria","text":"$ chmod o-w, o-r /home/snarl/aplicativo.sh $ ls -l","title":"PARA REMOVER A PERMISS\u00c3O DE ESCRITA PARA GRUPO E LEITURA PARA 'OUTROS', FICARIA:"},{"location":"Permissoes_Linux-02/#outro-modo-de-modificar-permissoes-e-usando-uma-combinacao-em-octal-onde-um-conjunto-de-8-numeros-define-as-permissoes-de-acesso","text":"Valor Octal | Valor Bin\u00e1rio rwx Caracteres Significado 0 000 \u2212\u2212\u2212 nenhuma permiss\u00e3o de acesso 1 001 \u2212\u2212x permiss\u00e3o de execu\u00e7\u00e3o 2 010 -w- permiss\u00e3o de grava\u00e7\u00e3o 3 011 -wx permiss\u00e3o de grava\u00e7\u00e3o e execu\u00e7\u00e3o 4 100 r\u2212\u2212 permiss\u00e3o de leitura 5 101 r-x permiss\u00e3o de leitura e execu\u00e7\u00e3o 6 110 rw- permiss\u00e3o de leitura e grava\u00e7\u00e3o 7 111 rwx permiss\u00e3o de leitura, grava\u00e7\u00e3o e execu\u00e7\u00e3o","title":"OUTRO MODO DE MODIFICAR PERMISS\u00d5ES, \u00c9 USANDO UMA COMBINA\u00c7\u00c3O EM OCTAL, ONDE UM CONJUNTO DE 8 N\u00daMEROS DEFINE AS PERMISS\u00d5ES DE ACESSO"},{"location":"Permissoes_Linux-02/#ou-seja-para-remover-todas-as-permissoes-usamos","text":"$ chmod 000 /home/snarl/aplicativo.sh $ ls -l","title":"OU SEJA, PARA REMOVER TODAS AS PERMISS\u00d5ES, USAMOS:"},{"location":"Permissoes_Linux-02/#entao-se-temos-x1-w2-e-r4-podemos-criar-combinacoes-de-octais-para-definir-acessos","text":"","title":"ENT\u00c3O SE TEMOS X=1, W=2 E R=4, PODEMOS CRIAR COMBINA\u00c7\u00d5ES DE OCTAIS PARA DEFINIR ACESSOS."},{"location":"Permissoes_Linux-02/#por-exemplo-se-fossemos-dar-permissao-de-rwx-para-o-dono-e-de-rx-para-os-grupos-e-outros-fariamos-as-seguintes-combinacoes","text":"$ chmod 755 /home/snarl/aplicativo.sh","title":"POR EXEMPLO, SE FOSSEMOS DAR PERMISS\u00c3O DE RWX PARA O DONO E DE RX PARA OS GRUPOS E OUTROS, FAR\u00cdAMOS AS SEGUINTES COMBINA\u00c7\u00d5ES:"},{"location":"Permissoes_Linux-02/#pois-acesso-total-corresponde-a-rwx7-e-acesso-somente-leitura-e-execucao-corresponde-a-rx5","text":"","title":"POIS ACESSO TOTAL CORRESPONDE \u00c1 rwx=7 E ACESSO SOMENTE LEITURA E EXECU\u00c7\u00c3O CORRESPONDE \u00c1 rx=5"},{"location":"Permissoes_Linux-02/#modificando-proprietario-de-arquivosdiretorios-com-o-comando-chown","text":"","title":"MODIFICANDO PROPRIET\u00c1RIO DE ARQUIVOS/DIRET\u00d3RIOS COM O COMANDO chown"},{"location":"Permissoes_Linux-02/#o-comando-chown-serve-para-mudar-o-usuario-dono-ou-o-grupo-dono-de-um-determinado-arquivodiretorio","text":"chown [op\u00e7oes] [dono:grupo] [diret\u00f3rio/arquivo] $ chown -R snarl:users /home/snarl/aplicativo.sh","title":"O COMANDO chown SERVE PARA MUDAR O 'USU\u00c1RIO DONO' OU O 'GRUPO DONO', DE UM DETERMINADO ARQUIVO/DIRET\u00d3RIO:"},{"location":"Permissoes_Linux-02/#sendo-que-o-r-valida-o-comando-recursivamente-em-caso-de-aplicado-a-diretorios","text":"","title":"Sendo que o -R valida o comando recursivamente, em caso de aplicado \u00e1 diret\u00f3rios."},{"location":"Raid/","text":"\ud83d\udcc1 RAID - Redundant Array of Independent Disks: Raid \u00e9 uma tecnologia de armazenamento que envolve a combina\u00e7\u00e3o de v\u00e1rios discos r\u00edgidos (ou unidades de estado s\u00f3lido) em uma \u00fanica unidade l\u00f3gica para melhorar o desempenho, a redund\u00e2ncia ou uma combina\u00e7\u00e3o de ambos. RAID \u00e9 usado principalmente para melhorar a confiabilidade e/ou o desempenho do armazenamento de dados em sistemas de computador. RAID 0 (striping): S\u00e3o usados no m\u00ednimo 2 discos nessa configura\u00e7\u00e3o. A capacidade de armazenamento \u00e9 a soma dos discos utilizados. N\u00e3o possui nenhum backup (redund\u00e2ncia), embora melhore de forma significante a performance, dando mais velocidade de I/O. Exemplo, RAID 0 com dois discos de 200 GB cada um totalizando em 400 GB o volume montado no RAID. Se um disco falhar \u00e9 perdido todo o conte\u00fado. Possui striping, ou seja, os discos executam tarefas como leitura e grava\u00e7\u00e3o de dados de forma simult\u00e2nea, entregando maior desempenho e liberando a capacidade total dos discos para armazenar informa\u00e7\u00f5es. RAID 1 (espelhamento): S\u00e3o usados no m\u00ednimo 2 discos nessa configura\u00e7\u00e3o. A capacidade de armazenamento \u00e9 metade da soma total dos discos. Exemplo, RAID 0 com dois discos de 200 GB cada um deles, o espa\u00e7o total no volume montado ser\u00e1 de 200 GB. Se um disco falhar, o conte\u00fado n\u00e3o \u00e9 perdido. RAID 4: S\u00e3o usados no m\u00ednimo 3 discos nessa configura\u00e7\u00e3o. Um dos discos \u00e9 dedicado \u00e0 paridade. A capacidade de armazenamento \u00e9 a soma de todos os discos, menos um. Exemplo, 3 discos de 100GB cada um, resulta em um RAID 4 de 200GB. O pr\u00f3ximo n\u00edvel de RAID, o 5, possui mais vantagens se comparado com o RAID 4. RAID 5: S\u00e3o usados no m\u00ednimo 3 discos nessa configura\u00e7\u00e3o. Possui paridade e striping. Conforme o RAID 4, a capacidade de armazenamento \u00e9 a soma de todos os discos, menos um. RAID 6: Existe um segundo disco de paridade, diferentemente do RAID 5, que possui apenas 1. RAID 10: combina\u00e7\u00e3o do RAID 0 e do RAID 1. Dois ou mais RAID 0 se juntam, formando um RAID 1, e por consequ\u00eancia, um RAID 10. RAID 50 e RAID 60: S\u00e3o combina\u00e7\u00f5es de RAID 5 e RAID 0 ou RAID 6 e RAID 0, respectivamente. Eles oferecem um equil\u00edbrio entre desempenho e redund\u00e2ncia, adequados para aplicativos de alto desempenho e alta disponibilidade. MDADM \"md\" significa m\u00faltiplos dispositivos. O \"adm\" de mdadm \u00e9 abrevia\u00e7\u00e3o para administra\u00e7\u00e3o: sudo apt install mdadm -y Estou utilizando uma m\u00e1quina virtual, com o Debian Linux. Nesta m\u00e1quina, possuo os seguintes discos: /dev/sda - 50GB (Disco principal) /dev/sdb - 2GB /dev/sdc - 2GB /dev/sdd - 2GB /dev/sde - 2GB sudo -i mdadm --create /dev/md0 --level=0 --raid-devices=4 /dev/sdb /dev/sdc /dev/sdd /dev/sde mdadm: Defaulting to version 4.1 metadata mdadm: array /dev/md0 started Agora o disco virtual chamado /dev/md0 foi criado em meu sistema. Devemos ent\u00e3o atualizar o arquivo de configura\u00e7\u00e3o do mdadm, for\u00e7ando o dispositivo a se chamar /dev/md0. Caso contr\u00e1rio, o udev ir\u00e1 automaticamente renome\u00e1-lo para /dev/md127: mdadm --detail --scan /dev/md0 >> /etc/mdadm/mdadm.conf update-initramfs -u cat /proc/mdstat sudo mdadm --detail /dev/md0 mkfs.ext4 /dev/md0 mkdir /mnt/md0 mount /dev/md0 /mnt/md0 df -h /dev/md0 7,9G 36M 7,4G 1% /mnt/md0 Para remover o RAID com o MDADM: umount /dev/md0 mdadm --stop /dev/md0 mdadm --zero-superblock /dev/sdb mdadm --zero-superblock /dev/sdc mdadm --zero-superblock /dev/sdd mdadm --zero-superblock /dev/sde nano /etc/mdadm/mdadm.conf ARRAY /dev/md0 metadata=1.2 name=debian:0 UUID=5ecf1997:9d6ea966:a3590659:e36f5a88 update-initramfs -u THAT\u2019S ALL FOLKS!!","title":"\ud83d\udcc1 RAID - Redundant Array of Independent Disks:"},{"location":"Raid/#raid-redundant-array-of-independent-disks","text":"Raid \u00e9 uma tecnologia de armazenamento que envolve a combina\u00e7\u00e3o de v\u00e1rios discos r\u00edgidos (ou unidades de estado s\u00f3lido) em uma \u00fanica unidade l\u00f3gica para melhorar o desempenho, a redund\u00e2ncia ou uma combina\u00e7\u00e3o de ambos. RAID \u00e9 usado principalmente para melhorar a confiabilidade e/ou o desempenho do armazenamento de dados em sistemas de computador.","title":"\ud83d\udcc1 RAID - Redundant Array of Independent Disks:"},{"location":"Raid/#raid-0-striping","text":"S\u00e3o usados no m\u00ednimo 2 discos nessa configura\u00e7\u00e3o. A capacidade de armazenamento \u00e9 a soma dos discos utilizados. N\u00e3o possui nenhum backup (redund\u00e2ncia), embora melhore de forma significante a performance, dando mais velocidade de I/O. Exemplo, RAID 0 com dois discos de 200 GB cada um totalizando em 400 GB o volume montado no RAID. Se um disco falhar \u00e9 perdido todo o conte\u00fado. Possui striping, ou seja, os discos executam tarefas como leitura e grava\u00e7\u00e3o de dados de forma simult\u00e2nea, entregando maior desempenho e liberando a capacidade total dos discos para armazenar informa\u00e7\u00f5es.","title":"RAID 0 (striping):"},{"location":"Raid/#raid-1-espelhamento","text":"S\u00e3o usados no m\u00ednimo 2 discos nessa configura\u00e7\u00e3o. A capacidade de armazenamento \u00e9 metade da soma total dos discos. Exemplo, RAID 0 com dois discos de 200 GB cada um deles, o espa\u00e7o total no volume montado ser\u00e1 de 200 GB. Se um disco falhar, o conte\u00fado n\u00e3o \u00e9 perdido.","title":"RAID 1 (espelhamento):"},{"location":"Raid/#raid-4","text":"S\u00e3o usados no m\u00ednimo 3 discos nessa configura\u00e7\u00e3o. Um dos discos \u00e9 dedicado \u00e0 paridade. A capacidade de armazenamento \u00e9 a soma de todos os discos, menos um. Exemplo, 3 discos de 100GB cada um, resulta em um RAID 4 de 200GB. O pr\u00f3ximo n\u00edvel de RAID, o 5, possui mais vantagens se comparado com o RAID 4.","title":"RAID 4:"},{"location":"Raid/#raid-5","text":"S\u00e3o usados no m\u00ednimo 3 discos nessa configura\u00e7\u00e3o. Possui paridade e striping. Conforme o RAID 4, a capacidade de armazenamento \u00e9 a soma de todos os discos, menos um.","title":"RAID 5:"},{"location":"Raid/#raid-6","text":"Existe um segundo disco de paridade, diferentemente do RAID 5, que possui apenas 1.","title":"RAID 6:"},{"location":"Raid/#raid-10","text":"combina\u00e7\u00e3o do RAID 0 e do RAID 1. Dois ou mais RAID 0 se juntam, formando um RAID 1, e por consequ\u00eancia, um RAID 10.","title":"RAID 10:"},{"location":"Raid/#raid-50-e-raid-60","text":"S\u00e3o combina\u00e7\u00f5es de RAID 5 e RAID 0 ou RAID 6 e RAID 0, respectivamente. Eles oferecem um equil\u00edbrio entre desempenho e redund\u00e2ncia, adequados para aplicativos de alto desempenho e alta disponibilidade.","title":"RAID 50 e RAID 60:"},{"location":"Raid/#mdadm-md-significa-multiplos-dispositivos-o-adm-de-mdadm-e-abreviacao-para-administracao","text":"sudo apt install mdadm -y","title":"MDADM \"md\" significa m\u00faltiplos dispositivos. O \"adm\" de mdadm \u00e9 abrevia\u00e7\u00e3o para administra\u00e7\u00e3o:"},{"location":"Raid/#estou-utilizando-uma-maquina-virtual-com-o-debian-linux-nesta-maquina-possuo-os-seguintes-discos","text":"/dev/sda - 50GB (Disco principal) /dev/sdb - 2GB /dev/sdc - 2GB /dev/sdd - 2GB /dev/sde - 2GB sudo -i mdadm --create /dev/md0 --level=0 --raid-devices=4 /dev/sdb /dev/sdc /dev/sdd /dev/sde mdadm: Defaulting to version 4.1 metadata mdadm: array /dev/md0 started","title":"Estou utilizando uma m\u00e1quina virtual, com o Debian Linux. Nesta m\u00e1quina, possuo os seguintes discos:"},{"location":"Raid/#agora-o-disco-virtual-chamado-devmd0-foi-criado-em-meu-sistema-devemos-entao-atualizar-o-arquivo-de-configuracao-do-mdadm-forcando-o-dispositivo-a-se-chamar-devmd0-caso-contrario-o-udev-ira-automaticamente-renomea-lo-para-devmd127","text":"mdadm --detail --scan /dev/md0 >> /etc/mdadm/mdadm.conf update-initramfs -u cat /proc/mdstat sudo mdadm --detail /dev/md0 mkfs.ext4 /dev/md0 mkdir /mnt/md0 mount /dev/md0 /mnt/md0 df -h /dev/md0 7,9G 36M 7,4G 1% /mnt/md0","title":"Agora o disco virtual chamado /dev/md0 foi criado em meu sistema. Devemos ent\u00e3o atualizar o arquivo de configura\u00e7\u00e3o do mdadm, for\u00e7ando o dispositivo a se chamar /dev/md0. Caso contr\u00e1rio, o udev ir\u00e1 automaticamente renome\u00e1-lo para /dev/md127:"},{"location":"Raid/#para-remover-o-raid-com-o-mdadm","text":"umount /dev/md0 mdadm --stop /dev/md0 mdadm --zero-superblock /dev/sdb mdadm --zero-superblock /dev/sdc mdadm --zero-superblock /dev/sdd mdadm --zero-superblock /dev/sde nano /etc/mdadm/mdadm.conf ARRAY /dev/md0 metadata=1.2 name=debian:0 UUID=5ecf1997:9d6ea966:a3590659:e36f5a88 update-initramfs -u THAT\u2019S ALL FOLKS!!","title":"Para remover o RAID com o MDADM:"},{"location":"Systemd/","text":"\ud83d\udcc1 Tutorial Completo de systemd \ud83d\udcd6 Introdu\u00e7\u00e3o O systemd \u00e9 um system and service manager para sistemas Linux modernos. Ele substitui o SysVinit tradicional e prov\u00ea recursos avan\u00e7ados para gerenciamento de servi\u00e7os, inicializa\u00e7\u00e3o do sistema, logging, controle de depend\u00eancias e gerenciamento de recursos. \ud83d\udee0\ufe0f Conceitos Fundamentais O que \u00e9 o systemd? Gerenciador de servi\u00e7os : Controla inicializa\u00e7\u00e3o, interrup\u00e7\u00e3o e supervis\u00e3o de processos. Gerenciador de unidades (units) : Tudo no systemd \u00e9 representado como uma unit . Inicializa\u00e7\u00e3o paralela : Acelera o boot executando servi\u00e7os em paralelo. Integra\u00e7\u00e3o com journal : Sistema de logs centralizado ( journalctl ). Tipos de Units .service \u2192 Representa servi\u00e7os (daemons). .socket \u2192 Define sockets para ativa\u00e7\u00e3o sob demanda. .target \u2192 Agrupamento l\u00f3gico de units (substitui runlevels ). .mount e .automount \u2192 Gerenciam pontos de montagem. .timer \u2192 Tarefas agendadas (substitui cron em alguns cen\u00e1rios). .slice e .scope \u2192 Gerenciam recursos (CPU, mem\u00f3ria). \ud83d\ude80 Comandos Essenciais Verificar status systemctl status nginx.service Iniciar / Parar / Reiniciar systemctl start nginx.service systemctl stop nginx.service systemctl restart nginx.service Habilitar / Desabilitar (no boot) systemctl enable nginx.service systemctl disable nginx.service Listar servi\u00e7os ativos systemctl list-units --type=service Recarregar unidades ap\u00f3s altera\u00e7\u00f5es systemctl daemon-reload \ud83e\udde9 Trabalhando com Units Estrutura de uma Unit .service Exemplo: /etc/systemd/system/meuapp.service [Unit] Description=Meu Aplicativo Exemplo After=network.target [Service] ExecStart=/usr/bin/python3 /opt/meuapp/app.py Restart=always User=meuusuario WorkingDirectory=/opt/meuapp [Install] WantedBy=multi-user.target Explica\u00e7\u00e3o: Description : Descri\u00e7\u00e3o do servi\u00e7o. After : Define depend\u00eancias de inicializa\u00e7\u00e3o. ExecStart : Comando que inicia o processo. Restart : Pol\u00edtica de rein\u00edcio (ex: always, on-failure). User : Usu\u00e1rio que executa o processo. WorkingDirectory : Diret\u00f3rio de trabalho. WantedBy : Indica em qual target o servi\u00e7o ser\u00e1 ativado. Ativar novo servi\u00e7o sudo systemctl daemon-reload sudo systemctl enable meuapp.service sudo systemctl start meuapp.service \u23f1\ufe0f Timers (Agendamentos) Exemplo de timer que roda um script diariamente: Arquivo /etc/systemd/system/backup.service [Unit] Description=Backup Di\u00e1rio [Service] ExecStart=/usr/local/bin/backup.sh Arquivo /etc/systemd/system/backup.timer [Unit] Description=Agendamento de Backup Di\u00e1rio [Timer] OnCalendar=daily Persistent=true [Install] WantedBy=timers.target Ativar: sudo systemctl enable backup.timer sudo systemctl start backup.timer Ver timers ativos: systemctl list-timers \ud83d\udcdc Logs e Diagn\u00f3stico Ver logs de todo o sistema: journalctl Ver logs de um servi\u00e7o espec\u00edfico: journalctl -u nginx.service Acompanhar em tempo real: journalctl -u meuapp.service -f \ud83d\udd12 Gerenciamento de Recursos O systemd integra-se ao cgroups do kernel Linux para controlar recursos: Exemplo: limitar mem\u00f3ria de um servi\u00e7o ( /etc/systemd/system/meuapp.service.d/limites.conf ): [Service] MemoryMax=500M CPUQuota=50% Aplicar: systemctl daemon-reexec systemctl restart meuapp.service \ud83d\udd04 Targets e Boot Targets comuns graphical.target \u2192 Interface gr\u00e1fica. multi-user.target \u2192 Multiusu\u00e1rio, sem GUI. rescue.target \u2192 Modo de recupera\u00e7\u00e3o. emergency.target \u2192 Modo de emerg\u00eancia. Ver target atual: systemctl get-default Alterar target padr\u00e3o: systemctl set-default multi-user.target Entrar em modo de emerg\u00eancia: systemctl isolate emergency.target \ud83e\uddea Exemplos Avan\u00e7ados Servi\u00e7o com depend\u00eancia de banco de dados [Unit] Description=Aplicativo Web After=network.target mariadb.service Requires=mariadb.service Socket Activation Arquivo /etc/systemd/system/meuapp.socket : [Unit] Description=Socket para MeuApp [Socket] ListenStream=8080 [Install] WantedBy=sockets.target Arquivo /etc/systemd/system/meuapp.service : [Service] ExecStart=/opt/meuapp/server --socket-activated \ud83d\udcda Conclus\u00e3o O systemd \u00e9 muito mais do que um simples substituto do init : - Fornece controle detalhado sobre servi\u00e7os. - Possibilita agendamentos com timers . - Facilita o monitoramento via journal . - Gerencia recursos de forma integrada. \u00c9 uma ferramenta essencial para administradores de sistemas Linux modernos.","title":"\ud83d\udcc1 Tutorial Completo de systemd"},{"location":"Systemd/#tutorial-completo-de-systemd","text":"","title":"\ud83d\udcc1 Tutorial Completo de systemd"},{"location":"Systemd/#introducao","text":"O systemd \u00e9 um system and service manager para sistemas Linux modernos. Ele substitui o SysVinit tradicional e prov\u00ea recursos avan\u00e7ados para gerenciamento de servi\u00e7os, inicializa\u00e7\u00e3o do sistema, logging, controle de depend\u00eancias e gerenciamento de recursos.","title":"\ud83d\udcd6 Introdu\u00e7\u00e3o"},{"location":"Systemd/#conceitos-fundamentais","text":"","title":"\ud83d\udee0\ufe0f Conceitos Fundamentais"},{"location":"Systemd/#o-que-e-o-systemd","text":"Gerenciador de servi\u00e7os : Controla inicializa\u00e7\u00e3o, interrup\u00e7\u00e3o e supervis\u00e3o de processos. Gerenciador de unidades (units) : Tudo no systemd \u00e9 representado como uma unit . Inicializa\u00e7\u00e3o paralela : Acelera o boot executando servi\u00e7os em paralelo. Integra\u00e7\u00e3o com journal : Sistema de logs centralizado ( journalctl ).","title":"O que \u00e9 o systemd?"},{"location":"Systemd/#tipos-de-units","text":".service \u2192 Representa servi\u00e7os (daemons). .socket \u2192 Define sockets para ativa\u00e7\u00e3o sob demanda. .target \u2192 Agrupamento l\u00f3gico de units (substitui runlevels ). .mount e .automount \u2192 Gerenciam pontos de montagem. .timer \u2192 Tarefas agendadas (substitui cron em alguns cen\u00e1rios). .slice e .scope \u2192 Gerenciam recursos (CPU, mem\u00f3ria).","title":"Tipos de Units"},{"location":"Systemd/#comandos-essenciais","text":"","title":"\ud83d\ude80 Comandos Essenciais"},{"location":"Systemd/#verificar-status","text":"systemctl status nginx.service","title":"Verificar status"},{"location":"Systemd/#iniciar-parar-reiniciar","text":"systemctl start nginx.service systemctl stop nginx.service systemctl restart nginx.service","title":"Iniciar / Parar / Reiniciar"},{"location":"Systemd/#habilitar-desabilitar-no-boot","text":"systemctl enable nginx.service systemctl disable nginx.service","title":"Habilitar / Desabilitar (no boot)"},{"location":"Systemd/#listar-servicos-ativos","text":"systemctl list-units --type=service","title":"Listar servi\u00e7os ativos"},{"location":"Systemd/#recarregar-unidades-apos-alteracoes","text":"systemctl daemon-reload","title":"Recarregar unidades ap\u00f3s altera\u00e7\u00f5es"},{"location":"Systemd/#trabalhando-com-units","text":"","title":"\ud83e\udde9 Trabalhando com Units"},{"location":"Systemd/#estrutura-de-uma-unit-service","text":"Exemplo: /etc/systemd/system/meuapp.service [Unit] Description=Meu Aplicativo Exemplo After=network.target [Service] ExecStart=/usr/bin/python3 /opt/meuapp/app.py Restart=always User=meuusuario WorkingDirectory=/opt/meuapp [Install] WantedBy=multi-user.target Explica\u00e7\u00e3o: Description : Descri\u00e7\u00e3o do servi\u00e7o. After : Define depend\u00eancias de inicializa\u00e7\u00e3o. ExecStart : Comando que inicia o processo. Restart : Pol\u00edtica de rein\u00edcio (ex: always, on-failure). User : Usu\u00e1rio que executa o processo. WorkingDirectory : Diret\u00f3rio de trabalho. WantedBy : Indica em qual target o servi\u00e7o ser\u00e1 ativado.","title":"Estrutura de uma Unit .service"},{"location":"Systemd/#ativar-novo-servico","text":"sudo systemctl daemon-reload sudo systemctl enable meuapp.service sudo systemctl start meuapp.service","title":"Ativar novo servi\u00e7o"},{"location":"Systemd/#timers-agendamentos","text":"Exemplo de timer que roda um script diariamente: Arquivo /etc/systemd/system/backup.service [Unit] Description=Backup Di\u00e1rio [Service] ExecStart=/usr/local/bin/backup.sh Arquivo /etc/systemd/system/backup.timer [Unit] Description=Agendamento de Backup Di\u00e1rio [Timer] OnCalendar=daily Persistent=true [Install] WantedBy=timers.target Ativar: sudo systemctl enable backup.timer sudo systemctl start backup.timer Ver timers ativos: systemctl list-timers","title":"\u23f1\ufe0f Timers (Agendamentos)"},{"location":"Systemd/#logs-e-diagnostico","text":"Ver logs de todo o sistema: journalctl Ver logs de um servi\u00e7o espec\u00edfico: journalctl -u nginx.service Acompanhar em tempo real: journalctl -u meuapp.service -f","title":"\ud83d\udcdc Logs e Diagn\u00f3stico"},{"location":"Systemd/#gerenciamento-de-recursos","text":"O systemd integra-se ao cgroups do kernel Linux para controlar recursos: Exemplo: limitar mem\u00f3ria de um servi\u00e7o ( /etc/systemd/system/meuapp.service.d/limites.conf ): [Service] MemoryMax=500M CPUQuota=50% Aplicar: systemctl daemon-reexec systemctl restart meuapp.service","title":"\ud83d\udd12 Gerenciamento de Recursos"},{"location":"Systemd/#targets-e-boot","text":"","title":"\ud83d\udd04 Targets e Boot"},{"location":"Systemd/#targets-comuns","text":"graphical.target \u2192 Interface gr\u00e1fica. multi-user.target \u2192 Multiusu\u00e1rio, sem GUI. rescue.target \u2192 Modo de recupera\u00e7\u00e3o. emergency.target \u2192 Modo de emerg\u00eancia. Ver target atual: systemctl get-default Alterar target padr\u00e3o: systemctl set-default multi-user.target Entrar em modo de emerg\u00eancia: systemctl isolate emergency.target","title":"Targets comuns"},{"location":"Systemd/#exemplos-avancados","text":"","title":"\ud83e\uddea Exemplos Avan\u00e7ados"},{"location":"Systemd/#servico-com-dependencia-de-banco-de-dados","text":"[Unit] Description=Aplicativo Web After=network.target mariadb.service Requires=mariadb.service","title":"Servi\u00e7o com depend\u00eancia de banco de dados"},{"location":"Systemd/#socket-activation","text":"Arquivo /etc/systemd/system/meuapp.socket : [Unit] Description=Socket para MeuApp [Socket] ListenStream=8080 [Install] WantedBy=sockets.target Arquivo /etc/systemd/system/meuapp.service : [Service] ExecStart=/opt/meuapp/server --socket-activated","title":"Socket Activation"},{"location":"Systemd/#conclusao","text":"O systemd \u00e9 muito mais do que um simples substituto do init : - Fornece controle detalhado sobre servi\u00e7os. - Possibilita agendamentos com timers . - Facilita o monitoramento via journal . - Gerencia recursos de forma integrada. \u00c9 uma ferramenta essencial para administradores de sistemas Linux modernos.","title":"\ud83d\udcda Conclus\u00e3o"},{"location":"Universo_NIX/","text":"\ud83d\udcc1 O Universo *nix - Conceitos O Unix Conceituando o Unix In\u00edcio do Unics com Ken Thompson e Denis Ritchie em 1969 Reescrito em 1973 na linguagem C e renomeado para Unix O Unix na atualidade A filosofia KISS (Keep It Simple Stupid) O GNU Richard Stalmann Conceituando o GNU (GNU is Not Unix) Princ\u00edpios e filosofia por tr\u00e1s do GNU Como o GNU auxilia no mundo do SL O movimento de Software Livre e a Licen\u00e7a GPL Conceituando a Freee Software Fundation Princ\u00edpios e filosofia por tr\u00e1s da GPL As 4 liberdades do SL Como a GPL afeta o desenvolvimento de software no Linux Introdu\u00e7\u00e3o ao Sistema Operacional Linux O que \u00e9 o Linux? Hist\u00f3ria e evolu\u00e7\u00e3o do Linux As diversas distribui\u00e7\u00f5es Linux e suas deriva\u00e7\u00f5es Distros Linux mais populares na atualidade O Kernel Linux Conceituando o Kernel Interliga\u00e7\u00e3o entre Harware e Software Como o Kernel trabalha Por que usar Linux em Servidores Vantagens do Linux como sistema operacional de servidor Casos de uso comuns para servidores Linux Firewall, Controlador de Dom\u00ednio, Servidor de Arquivos, DNS, Proxy, e-Mail, FTP, DHCP Exemplos de empresas que usam Linux em servidores O Mercado de Trabalho para Profissionais Linux Demandas do mercado para profissionais de Linux Carreiras relacionadas ao Linux Certifica\u00e7\u00f5es Linux e sua import\u00e2ncia Principais Diferen\u00e7as entre Linux e Windows Arquitetura de sistemas Modelo de licenciamento Interfaces de linha de comando vs. interfaces gr\u00e1ficas Principais Diferen\u00e7as entre Linux e Unix Hist\u00f3ria e rela\u00e7\u00e3o entre Linux e Unix Diferen\u00e7as na arquitetura e recursos FreeBSD, NetBSD, OpenBSD, Solaris, AIX, MacOS Guia para Instala\u00e7\u00e3o do Debian Linux Baixando uma imagem ISO do Debian Linux Passos para a instala\u00e7\u00e3o do Debian Linux Configura\u00e7\u00e3o inicial ap\u00f3s a instala\u00e7\u00e3o Estrutura de Diret\u00f3rios no Linux Vis\u00e3o geral da hierarquia de diret\u00f3rios Significado e conte\u00fado de diret\u00f3rios comuns Import\u00e2ncia do FHS para a padroniza\u00e7\u00e3o dos diret\u00f3rios Arquitetura do Sistema Operacional Linux Componentes principais do sistema operacional Linux e a intera\u00e7\u00e3o com Harware Kernel, Bibliotecas do sistema, Shell, Aplica\u00e7\u00f5es, espa\u00e7o de usu\u00e1rio, drivers e m\u00f3dulos, ger\u00eancia de pacotes Diversos Sistemas de Arquivos no Linux Conceituando Sistema de Arquivos Inodes/Metadados, tempo, permiss\u00e3o, tipo, tamanho, endere\u00e7o Ext4, FAT32, XFS, Btrfs e outros sistemas de arquivos Escolhendo o sistema de arquivos certo para diferentes casos de uso Parti\u00e7\u00f5es Linux Conceituando particionamento Parti\u00e7\u00e3o prim\u00e1ria, parti\u00e7\u00e3o secund\u00e1ria, parti\u00e7\u00e3o extendida, parti\u00e7\u00e3o l\u00f3gica, Comandos e utilit\u00e1rios de particionamento Parti\u00e7\u00e3o MBR e EFI Diversas Distribui\u00e7\u00f5es Linux Explorando diferentes distribui\u00e7\u00f5es (Slackware, Debian, RedHat, OpenSUSE, etc) As distros derivadas. Ubuntu, Fedora, Mint, Kali, Raspian, Android Escolhendo a distribui\u00e7\u00e3o certa para suas necessidades Diversas Interfaces Gr\u00e1ficas do Linux GNOME, KDE, XFCE, Mate, Cinnamon e outras interfaces gr\u00e1ficas Personaliza\u00e7\u00e3o e usabilidade Gerenciamento de Boot no Linux Conceituando o boot do sistema O Lilo O GRUB (Grand Unified Bootloader) Configura\u00e7\u00e3o do GRUB Solu\u00e7\u00e3o de problemas de inicializa\u00e7\u00e3o Uso do Terminal no Linux Conceituando o Terminal (ts,tty) Navega\u00e7\u00e3o e manipula\u00e7\u00e3o de diret\u00f3rios Comandos b\u00e1sicos do Linux Redirecionamento e pipes Tipos de Arquivos no Linux Arquivos regulares, diret\u00f3rios, links simb\u00f3licos, dispositivos, etc Permiss\u00f5es e propriedades de arquivos Permiss\u00f5es no Linux Entendendo as permiss\u00f5es de usu\u00e1rio, arquivo e diret\u00f3rio Modificando permiss\u00f5es e atributos, chmod, chown, chattr Montagem de Diret\u00f3rios no Linux Montando dispositivos de armazenamento Montagem autom\u00e1tica vs. manual Compacta\u00e7\u00e3o de Arquivos no Linux Compress\u00e3o e descompress\u00e3o de arquivos Formatos de compacta\u00e7\u00e3o (tar, gzip, zip) Contas de Usu\u00e1rios e Grupos no Linux Gerenciando usu\u00e1rios e grupos Controle de acesso e seguran\u00e7a Gerenciamento de rede em Servidores Linux Conceituando endere\u00e7o ip Configurando ip din\u00e2mico e ip fixo Conceituando DNS Conceituando Hostname Acesso Remoto e transfer\u00eancia de arquivos por SSH Conceituando o SSH (Secure Shell) Configurando acesso SSH Seguran\u00e7a em conex\u00f5es SSH scp, ssh-keygen, sshcopy-id An\u00e1lise de Processos e logs no Linux Monitoramento e gerenciamento de processos Comandos ps, top, htop, logs com systemd, etc Gerenciamento de Servi\u00e7os com systemd O que \u00e9 systemd? Gerenciando servi\u00e7os, unidades e inicializa\u00e7\u00e3o Outros gerenciadores de inicializa\u00e7\u00e3o Automatiza\u00e7\u00e3o de Tarefas com Linux Agendamento de tarefas com cron Scripting e automa\u00e7\u00e3o de tarefas repetitivas RAID com Linux Introdu\u00e7\u00e3o a RAID (Redundant Array of Independent Disks) Configurando RAID no Linux LVM com Linux O que \u00e9 LVM (Logical Volume Manager) Gerenciamento de volumes l\u00f3gicos DHCP Server Conceito de Servidor de DHCP Instala\u00e7\u00e3o de pacotes e edi\u00e7\u00e3o de arquivos do dhcp server Web Server Conceituando o Servidor de P\u00e1ginas Web Instala\u00e7\u00e3o dos pacotes do Apache Server Configura\u00e7\u00e3o do Apache Server Primeira p\u00e1gina Web O Nginx Server Proxy Server Conceito de Proxy Server Instala\u00e7\u00e3o e configura\u00e7\u00e3o do Squid Proxy Server Bloqueios e logs de usu\u00e1rios NFS Server Conceituando o NFS (Network File Sistem) Instalando os pacotes do NFS Configurando acesso NFS Seguran\u00e7a em conex\u00f5es NFS FTP Server Conceituando o Servidor de FTP Configurando acesso FTP Seguran\u00e7a em conex\u00f5es FTP sftp File Server Conceito de Servidor de Arquivos Instala\u00e7\u00e3o dos pacotes Samba4 compilado Configura\u00e7\u00e3o do File Server Backups de dados com scripts O que \u00e9 backup? Criando scripts de backup Gerenciando de backups automaticos com cron Controlador de Dom\u00ednio Prim\u00e1rio Conceito de DC01 Instala\u00e7\u00e3o dos pacotes Samba4 Configura\u00e7\u00e3o do DC01 Controlador de Dom\u00ednio Prim\u00e1rio Secund\u00e1rio Conceito de DC02 Instala\u00e7\u00e3o dos pacotes Samba4 Configura\u00e7\u00e3o do DC02 DNS Server Conceito de DNS Instala\u00e7\u00e3o dos pacotes BIND9 Configura\u00e7\u00e3o do bind NTP Server Conceito de NTP Instala\u00e7\u00e3o dos pacotes NTP Configura\u00e7\u00e3o do NTP Firewall Conceito de Firewall Instala\u00e7\u00e3o dos pacotes do iptables Configura\u00e7\u00e3o do script firewall.sh Inicializa\u00e7\u00e3o com o sistema Virtualiza\u00e7\u00e3o Conceito de Virtualiza\u00e7\u00e3o Instala\u00e7\u00e3o do Hipervisor Virtualbox Instala\u00e7\u00e3o do Hipervisor QEMU/Virt-manager Os 50 Principais Comandos do Linux Revis\u00e3o dos 50 comandos mais utilizados no Linux Exemplos de uso pr\u00e1tico THAT\u2019S ALL FOLKS!!","title":"\ud83d\udcc1 O Universo *nix - Conceitos"},{"location":"Universo_NIX/#o-universo-nix-conceitos","text":"","title":"\ud83d\udcc1 O Universo *nix - Conceitos"},{"location":"Universo_NIX/#o-unix","text":"Conceituando o Unix In\u00edcio do Unics com Ken Thompson e Denis Ritchie em 1969 Reescrito em 1973 na linguagem C e renomeado para Unix O Unix na atualidade A filosofia KISS (Keep It Simple Stupid)","title":"O Unix"},{"location":"Universo_NIX/#o-gnu","text":"Richard Stalmann Conceituando o GNU (GNU is Not Unix) Princ\u00edpios e filosofia por tr\u00e1s do GNU Como o GNU auxilia no mundo do SL","title":"O GNU"},{"location":"Universo_NIX/#o-movimento-de-software-livre-e-a-licenca-gpl","text":"Conceituando a Freee Software Fundation Princ\u00edpios e filosofia por tr\u00e1s da GPL As 4 liberdades do SL Como a GPL afeta o desenvolvimento de software no Linux","title":"O movimento de Software Livre e a Licen\u00e7a GPL"},{"location":"Universo_NIX/#introducao-ao-sistema-operacional-linux","text":"O que \u00e9 o Linux? Hist\u00f3ria e evolu\u00e7\u00e3o do Linux As diversas distribui\u00e7\u00f5es Linux e suas deriva\u00e7\u00f5es Distros Linux mais populares na atualidade","title":"Introdu\u00e7\u00e3o ao Sistema Operacional Linux"},{"location":"Universo_NIX/#o-kernel-linux","text":"Conceituando o Kernel Interliga\u00e7\u00e3o entre Harware e Software Como o Kernel trabalha","title":"O Kernel Linux"},{"location":"Universo_NIX/#por-que-usar-linux-em-servidores","text":"Vantagens do Linux como sistema operacional de servidor Casos de uso comuns para servidores Linux Firewall, Controlador de Dom\u00ednio, Servidor de Arquivos, DNS, Proxy, e-Mail, FTP, DHCP Exemplos de empresas que usam Linux em servidores","title":"Por que usar Linux em Servidores"},{"location":"Universo_NIX/#o-mercado-de-trabalho-para-profissionais-linux","text":"Demandas do mercado para profissionais de Linux Carreiras relacionadas ao Linux Certifica\u00e7\u00f5es Linux e sua import\u00e2ncia","title":"O Mercado de Trabalho para Profissionais Linux"},{"location":"Universo_NIX/#principais-diferencas-entre-linux-e-windows","text":"Arquitetura de sistemas Modelo de licenciamento Interfaces de linha de comando vs. interfaces gr\u00e1ficas","title":"Principais Diferen\u00e7as entre Linux e Windows"},{"location":"Universo_NIX/#principais-diferencas-entre-linux-e-unix","text":"Hist\u00f3ria e rela\u00e7\u00e3o entre Linux e Unix Diferen\u00e7as na arquitetura e recursos FreeBSD, NetBSD, OpenBSD, Solaris, AIX, MacOS","title":"Principais Diferen\u00e7as entre Linux e Unix"},{"location":"Universo_NIX/#guia-para-instalacao-do-debian-linux","text":"Baixando uma imagem ISO do Debian Linux Passos para a instala\u00e7\u00e3o do Debian Linux Configura\u00e7\u00e3o inicial ap\u00f3s a instala\u00e7\u00e3o","title":"Guia para Instala\u00e7\u00e3o do Debian Linux"},{"location":"Universo_NIX/#estrutura-de-diretorios-no-linux","text":"Vis\u00e3o geral da hierarquia de diret\u00f3rios Significado e conte\u00fado de diret\u00f3rios comuns Import\u00e2ncia do FHS para a padroniza\u00e7\u00e3o dos diret\u00f3rios","title":"Estrutura de Diret\u00f3rios no Linux"},{"location":"Universo_NIX/#arquitetura-do-sistema-operacional-linux","text":"Componentes principais do sistema operacional Linux e a intera\u00e7\u00e3o com Harware Kernel, Bibliotecas do sistema, Shell, Aplica\u00e7\u00f5es, espa\u00e7o de usu\u00e1rio, drivers e m\u00f3dulos, ger\u00eancia de pacotes","title":"Arquitetura do Sistema Operacional Linux"},{"location":"Universo_NIX/#diversos-sistemas-de-arquivos-no-linux","text":"Conceituando Sistema de Arquivos Inodes/Metadados, tempo, permiss\u00e3o, tipo, tamanho, endere\u00e7o Ext4, FAT32, XFS, Btrfs e outros sistemas de arquivos Escolhendo o sistema de arquivos certo para diferentes casos de uso","title":"Diversos Sistemas de Arquivos no Linux"},{"location":"Universo_NIX/#particoes-linux","text":"Conceituando particionamento Parti\u00e7\u00e3o prim\u00e1ria, parti\u00e7\u00e3o secund\u00e1ria, parti\u00e7\u00e3o extendida, parti\u00e7\u00e3o l\u00f3gica, Comandos e utilit\u00e1rios de particionamento Parti\u00e7\u00e3o MBR e EFI","title":"Parti\u00e7\u00f5es Linux"},{"location":"Universo_NIX/#diversas-distribuicoes-linux","text":"Explorando diferentes distribui\u00e7\u00f5es (Slackware, Debian, RedHat, OpenSUSE, etc) As distros derivadas. Ubuntu, Fedora, Mint, Kali, Raspian, Android Escolhendo a distribui\u00e7\u00e3o certa para suas necessidades","title":"Diversas Distribui\u00e7\u00f5es Linux"},{"location":"Universo_NIX/#diversas-interfaces-graficas-do-linux","text":"GNOME, KDE, XFCE, Mate, Cinnamon e outras interfaces gr\u00e1ficas Personaliza\u00e7\u00e3o e usabilidade","title":"Diversas Interfaces Gr\u00e1ficas do Linux"},{"location":"Universo_NIX/#gerenciamento-de-boot-no-linux","text":"Conceituando o boot do sistema O Lilo O GRUB (Grand Unified Bootloader) Configura\u00e7\u00e3o do GRUB Solu\u00e7\u00e3o de problemas de inicializa\u00e7\u00e3o","title":"Gerenciamento de Boot no Linux"},{"location":"Universo_NIX/#uso-do-terminal-no-linux","text":"Conceituando o Terminal (ts,tty) Navega\u00e7\u00e3o e manipula\u00e7\u00e3o de diret\u00f3rios Comandos b\u00e1sicos do Linux Redirecionamento e pipes","title":"Uso do Terminal no Linux"},{"location":"Universo_NIX/#tipos-de-arquivos-no-linux","text":"Arquivos regulares, diret\u00f3rios, links simb\u00f3licos, dispositivos, etc Permiss\u00f5es e propriedades de arquivos","title":"Tipos de Arquivos no Linux"},{"location":"Universo_NIX/#permissoes-no-linux","text":"Entendendo as permiss\u00f5es de usu\u00e1rio, arquivo e diret\u00f3rio Modificando permiss\u00f5es e atributos, chmod, chown, chattr","title":"Permiss\u00f5es no Linux"},{"location":"Universo_NIX/#montagem-de-diretorios-no-linux","text":"Montando dispositivos de armazenamento Montagem autom\u00e1tica vs. manual","title":"Montagem de Diret\u00f3rios no Linux"},{"location":"Universo_NIX/#compactacao-de-arquivos-no-linux","text":"Compress\u00e3o e descompress\u00e3o de arquivos Formatos de compacta\u00e7\u00e3o (tar, gzip, zip)","title":"Compacta\u00e7\u00e3o de Arquivos no Linux"},{"location":"Universo_NIX/#contas-de-usuarios-e-grupos-no-linux","text":"Gerenciando usu\u00e1rios e grupos Controle de acesso e seguran\u00e7a","title":"Contas de Usu\u00e1rios e Grupos no Linux"},{"location":"Universo_NIX/#gerenciamento-de-rede-em-servidores-linux","text":"Conceituando endere\u00e7o ip Configurando ip din\u00e2mico e ip fixo Conceituando DNS Conceituando Hostname","title":"Gerenciamento de rede em Servidores Linux"},{"location":"Universo_NIX/#acesso-remoto-e-transferencia-de-arquivos-por-ssh","text":"Conceituando o SSH (Secure Shell) Configurando acesso SSH Seguran\u00e7a em conex\u00f5es SSH scp, ssh-keygen, sshcopy-id","title":"Acesso Remoto e transfer\u00eancia de arquivos por SSH"},{"location":"Universo_NIX/#analise-de-processos-e-logs-no-linux","text":"Monitoramento e gerenciamento de processos Comandos ps, top, htop, logs com systemd, etc","title":"An\u00e1lise de Processos e logs no Linux"},{"location":"Universo_NIX/#gerenciamento-de-servicos-com-systemd","text":"O que \u00e9 systemd? Gerenciando servi\u00e7os, unidades e inicializa\u00e7\u00e3o Outros gerenciadores de inicializa\u00e7\u00e3o","title":"Gerenciamento de Servi\u00e7os com systemd"},{"location":"Universo_NIX/#automatizacao-de-tarefas-com-linux","text":"Agendamento de tarefas com cron Scripting e automa\u00e7\u00e3o de tarefas repetitivas","title":"Automatiza\u00e7\u00e3o de Tarefas com Linux"},{"location":"Universo_NIX/#raid-com-linux","text":"Introdu\u00e7\u00e3o a RAID (Redundant Array of Independent Disks) Configurando RAID no Linux","title":"RAID com Linux"},{"location":"Universo_NIX/#lvm-com-linux","text":"O que \u00e9 LVM (Logical Volume Manager) Gerenciamento de volumes l\u00f3gicos","title":"LVM com Linux"},{"location":"Universo_NIX/#dhcp-server","text":"Conceito de Servidor de DHCP Instala\u00e7\u00e3o de pacotes e edi\u00e7\u00e3o de arquivos do dhcp server","title":"DHCP Server"},{"location":"Universo_NIX/#web-server","text":"Conceituando o Servidor de P\u00e1ginas Web Instala\u00e7\u00e3o dos pacotes do Apache Server Configura\u00e7\u00e3o do Apache Server Primeira p\u00e1gina Web O Nginx Server","title":"Web Server"},{"location":"Universo_NIX/#proxy-server","text":"Conceito de Proxy Server Instala\u00e7\u00e3o e configura\u00e7\u00e3o do Squid Proxy Server Bloqueios e logs de usu\u00e1rios","title":"Proxy Server"},{"location":"Universo_NIX/#nfs-server","text":"Conceituando o NFS (Network File Sistem) Instalando os pacotes do NFS Configurando acesso NFS Seguran\u00e7a em conex\u00f5es NFS","title":"NFS Server"},{"location":"Universo_NIX/#ftp-server","text":"Conceituando o Servidor de FTP Configurando acesso FTP Seguran\u00e7a em conex\u00f5es FTP sftp","title":"FTP Server"},{"location":"Universo_NIX/#file-server","text":"Conceito de Servidor de Arquivos Instala\u00e7\u00e3o dos pacotes Samba4 compilado Configura\u00e7\u00e3o do File Server","title":"File Server"},{"location":"Universo_NIX/#backups-de-dados-com-scripts","text":"O que \u00e9 backup? Criando scripts de backup Gerenciando de backups automaticos com cron","title":"Backups de dados com scripts"},{"location":"Universo_NIX/#controlador-de-dominio-primario","text":"Conceito de DC01 Instala\u00e7\u00e3o dos pacotes Samba4 Configura\u00e7\u00e3o do DC01","title":"Controlador de Dom\u00ednio Prim\u00e1rio"},{"location":"Universo_NIX/#controlador-de-dominio-primario-secundario","text":"Conceito de DC02 Instala\u00e7\u00e3o dos pacotes Samba4 Configura\u00e7\u00e3o do DC02","title":"Controlador de Dom\u00ednio Prim\u00e1rio Secund\u00e1rio"},{"location":"Universo_NIX/#dns-server","text":"Conceito de DNS Instala\u00e7\u00e3o dos pacotes BIND9 Configura\u00e7\u00e3o do bind","title":"DNS Server"},{"location":"Universo_NIX/#ntp-server","text":"Conceito de NTP Instala\u00e7\u00e3o dos pacotes NTP Configura\u00e7\u00e3o do NTP","title":"NTP Server"},{"location":"Universo_NIX/#firewall","text":"Conceito de Firewall Instala\u00e7\u00e3o dos pacotes do iptables Configura\u00e7\u00e3o do script firewall.sh Inicializa\u00e7\u00e3o com o sistema","title":"Firewall"},{"location":"Universo_NIX/#virtualizacao","text":"Conceito de Virtualiza\u00e7\u00e3o Instala\u00e7\u00e3o do Hipervisor Virtualbox Instala\u00e7\u00e3o do Hipervisor QEMU/Virt-manager","title":"Virtualiza\u00e7\u00e3o"},{"location":"Universo_NIX/#os-50-principais-comandos-do-linux","text":"Revis\u00e3o dos 50 comandos mais utilizados no Linux Exemplos de uso pr\u00e1tico THAT\u2019S ALL FOLKS!!","title":"Os 50 Principais Comandos do Linux"},{"location":"Usuarios_e_Grupos-1/","text":"\ud83d\udcc1 Gerenciamento de Usu\u00e1rios e Grupos no Linux - Primeira parte. Este tutorial abrange os comandos essenciais para a cria\u00e7\u00e3o, modifica\u00e7\u00e3o e exclus\u00e3o de usu\u00e1rios e grupos, al\u00e9m de como gerenciar suas permiss\u00f5es no sistema Linux. 1 - Entendendo Usu\u00e1rios e Grupos No Linux, usu\u00e1rios s\u00e3o as entidades que interagem com o sistema, enquanto grupos s\u00e3o cole\u00e7\u00f5es de usu\u00e1rios. Eles s\u00e3o usados para organizar usu\u00e1rios e aplicar permiss\u00f5es de forma eficiente. Usu\u00e1rio Root: O superusu\u00e1rio com controle total sobre o sistema. Use-o com extrema cautela. Usu\u00e1rios Regulares: Usu\u00e1rios com privil\u00e9gios limitados. Usu\u00e1rios do Sistema: Usu\u00e1rios com privil\u00e9gios espec\u00edficos de servi\u00e7os/aplicativos. Grupos Prim\u00e1rios: O grupo padr\u00e3o ao qual um usu\u00e1rio pertence no momento da cria\u00e7\u00e3o. Grupos Suplementares: Grupos adicionais aos quais um usu\u00e1rio pode pertencer. 2 - Gerenciando Usu\u00e1rios Criando um Novo Usu\u00e1rio, use o comando useradd. sudo useradd [op\u00e7\u00f5es] <nome_do_usuario> Op\u00e7\u00f5es Comuns: -m Cria o diret\u00f3rio home do usu\u00e1rio se ele n\u00e3o existir. (Altamente recomendado) -s : Especifica o shell de login do usu\u00e1rio (ex: /bin/bash, /bin/zsh). -g : Define o grupo prim\u00e1rio do usu\u00e1rio. -G : Adiciona o usu\u00e1rio a grupos suplementares. -c \" \": Adiciona um coment\u00e1rio sobre o usu\u00e1rio (ex: nome completo). Exemplo: sudo useradd -m -s /usr/bin/fish -aG www-data,sudo -c \"Jo\u00e3o Silva\" joaosilva Aten\u00e7\u00e3o Se a op\u00e7\u00e3o -a for omitida no comando usermod acima, o usu\u00e1rio \u00e9 removido de todos os outros grupos n\u00e3o listados em grupos_adicionais (i.e. o usu\u00e1rio ser\u00e1 membro apenas daqueles grupos em grupos_adicionais). Isso cria o usu\u00e1rio joaosilva com um diret\u00f3rio home, bash como shell padr\u00e3o, e o adiciona aos grupos www-data e sudo. 3 - Definindo a Senha de um Usu\u00e1rio Ap\u00f3s criar um usu\u00e1rio, ele est\u00e1 logando sem senha, voc\u00ea precisa definir uma senha para ele usando o comando passwd. sudo passwd <nome_do_usuario> O sistema ir\u00e1 pedir para voc\u00ea digitar a nova senha duas vezes. Exemplo: sudo passwd joaosilva 4 - Modificando um Usu\u00e1rio Existente O comando usermod \u00e9 usado para modificar as propriedades de um usu\u00e1rio. sudo usermod [op\u00e7\u00f5es] <nome_do_usuario> Op\u00e7\u00f5es Comuns: -l : Altera o nome de usu\u00e1rio (o diret\u00f3rio home e o grupo prim\u00e1rio n\u00e3o s\u00e3o alterados automaticamente). -d : Altera o diret\u00f3rio home do usu\u00e1rio. -m: Move o conte\u00fado do diret\u00f3rio home antigo para o novo (usado com -d). -s : Altera o shell de login. -g : Altera o grupo prim\u00e1rio. -G : Adiciona o usu\u00e1rio a grupos suplementares (sobrescreve os grupos existentes se n\u00e3o usar -a). -aG : Adiciona o usu\u00e1rio a grupos suplementares sem remover os existentes. (Altamente recomendado) -L: Bloqueia a conta do usu\u00e1rio. -U: Desbloqueia a conta do usu\u00e1rio. Exemplos: Para adicionar joaosilva ao grupo docker sem remover outros grupos: sudo usermod -aG docker joaosilva Para mudar o nome de usu\u00e1rio de joaosilva para jsilva: sudo usermod -l jsilva joaosilva Importante: Ap\u00f3s renomear um usu\u00e1rio com -l, o diret\u00f3rio home e o grupo prim\u00e1rio ainda ter\u00e3o o nome antigo. Voc\u00ea precisar\u00e1 renome\u00e1-los manualmente: sudo mv /home/joaosilva /home/jsilva sudo groupmod -n jsilva joaosilva sudo usermod -d /home/jsilva -m jsilva Adiconar um usu\u00e1rio \u00e1 um grupo espec\u00edfico com o comando adduser: sudo adduser jsilva tape Adiconar um usu\u00e1rio \u00e1 um grupo espec\u00edfico com o comando gpasswd: sudo gpasswd -a jsilva tape 5 - Excluindo um Usu\u00e1rio Use o comando userdel para remover um usu\u00e1rio. sudo userdel [op\u00e7\u00f5es] <nome_do_usuario> Op\u00e7\u00f5es Comuns: -r: Remove o diret\u00f3rio home do usu\u00e1rio e o mail spool. (Altamente recomendado) Exemplo: sudo userdel -r joaosilva 6 - Gerenciando Grupos 3.1. Criando um Novo Grupo Use o comando groupadd para criar um novo grupo. sudo groupadd [op\u00e7\u00f5es] <nome_do_grupo> Exemplo: sudo groupadd desenvolvedores 7 - Modificando um Grupo Existente O comando groupmod \u00e9 usado para modificar as propriedades de um grupo. sudo groupmod [op\u00e7\u00f5es] <nome_do_grupo> Op\u00e7\u00f5es Comuns: -n : Altera o nome do grupo. Exemplo: Para mudar o nome do grupo desenvolvedores para devs: sudo groupmod -n devs desenvolvedores 8 - Excluindo um Grupo Use o comando groupdel para remover um grupo. sudo groupdel <nome_do_grupo> Exemplo: sudo groupdel devs 9 - Gerenciando Membros do Grupo Adicionando Usu\u00e1rios a um Grupo Para adicionar um usu\u00e1rio a um grupo existente, a maneira mais comum \u00e9 usar usermod -aG. sudo usermod -aG <nome_do_grupo> <nome_do_usuario> Exemplo: sudo usermod -aG www-data joaosilva 10 - Removendo Usu\u00e1rios de um Grupo Para remover um usu\u00e1rio de um grupo, voc\u00ea pode usar gpasswd ou deluser (dependendo da distribui\u00e7\u00e3o). Usando gpasswd (mais comum e recomendado): sudo gpasswd -d <nome_do_usuario> <nome_do_grupo> Exemplo: sudo gpasswd -d joaosilva www-data Usando deluser (dispon\u00edvel em algumas distribui\u00e7\u00f5es como Debian/Ubuntu): sudo deluser <nome_do_usuario> <nome_do_grupo> Exemplo: sudo deluser joaosilva www-data 11 - Visualizando Informa\u00e7\u00f5es de Usu\u00e1rios e Grupos Listar Usu\u00e1rios As informa\u00e7\u00f5es dos usu\u00e1rios s\u00e3o armazenadas em /etc/passwd. Voc\u00ea pode visualiz\u00e1-lo com cat ou less. cat /etc/passwd Listar Grupos As informa\u00e7\u00f5es dos grupos s\u00e3o armazenadas em /etc/group. cat /etc/group Visualizar Informa\u00e7\u00f5es de um Usu\u00e1rio Espec\u00edfico Use o comando id para ver o ID do usu\u00e1rio, grupo prim\u00e1rio e grupos suplementares de um usu\u00e1rio. id <nome_do_usuario> Exemplo: id joaosilva 5.4. Visualizar Membros de um Grupo grep <nome_do_grupo> /etc/group Exemplo: grep sudo /etc/group Ou, em algumas distribui\u00e7\u00f5es, voc\u00ea pode usar members (se instalado). members <nome_do_grupo> 12 - Permiss\u00f5es de Arquivos e Diret\u00f3rios As permiss\u00f5es no Linux s\u00e3o baseadas em usu\u00e1rio, grupo e outros. r (leitura): 4 w (escrita): 2 x (execu\u00e7\u00e3o): 1 A combina\u00e7\u00e3o dessas permiss\u00f5es \u00e9 um n\u00famero octal. Exemplo: rwx (4+2+1 = 7), rw- (4+2+0 = 6), r-x (4+0+1 = 5). 6.1. Alterando Permiss\u00f5es (chmod) Use chmod para alterar as permiss\u00f5es de um arquivo ou diret\u00f3rio. chmod <permiss\u00f5es_octais> <arquivo/diret\u00f3rio> Exemplo: Dar ao propriet\u00e1rio, grupo e outros permiss\u00e3o total (leitura, escrita, execu\u00e7\u00e3o) para um script: chmod 777 meu_script.sh Dar ao propriet\u00e1rio leitura/escrita, ao grupo leitura e a outros nenhuma permiss\u00e3o para um arquivo: chmod 640 meu_arquivo.txt Alterando o Propriet\u00e1rio (chown) Use chown para alterar o propriet\u00e1rio de um arquivo ou diret\u00f3rio. sudo chown <novo_proprietario> <arquivo/diret\u00f3rio> Exemplo: sudo chown joaosilva meu_arquivo.txt 6.3. Alterando o Grupo Propriet\u00e1rio (chgrp) Use chgrp para alterar o grupo propriet\u00e1rio de um arquivo ou diret\u00f3rio. sudo chgrp <novo_grupo> <arquivo/diret\u00f3rio> Exemplo: sudo chgrp devs meu_arquivo.txt Voc\u00ea tamb\u00e9m pode usar chown para alterar o propriet\u00e1rio e o grupo simultaneamente: sudo chown <proprietario>:<grupo> <arquivo/diret\u00f3rio> Exemplo: sudo chown joaosilva:devs meu_arquivo.txt Considera\u00e7\u00f5es Finais Sempre use sudo: A maioria dos comandos de gerenciamento de usu\u00e1rios e grupos requer privil\u00e9gios de superusu\u00e1rio. Seguran\u00e7a: Evite dar permiss\u00f5es excessivas. Siga o princ\u00edpio do menor privil\u00e9gio. Documenta\u00e7\u00e3o: Consulte as p\u00e1ginas man para obter informa\u00e7\u00f5es detalhadas sobre cada comando (ex: man useradd). Backup: Sempre fa\u00e7a backup de arquivos de configura\u00e7\u00e3o importantes (como /etc/passwd, /etc/group, /etc/shadow) antes de fazer grandes altera\u00e7\u00f5es. That's all folks","title":"\ud83d\udcc1 Gerenciamento de Usu\u00e1rios e Grupos no Linux - Primeira parte."},{"location":"Usuarios_e_Grupos-1/#gerenciamento-de-usuarios-e-grupos-no-linux-primeira-parte","text":"","title":"\ud83d\udcc1 Gerenciamento de Usu\u00e1rios e Grupos no Linux - Primeira parte."},{"location":"Usuarios_e_Grupos-1/#este-tutorial-abrange-os-comandos-essenciais-para-a-criacao-modificacao-e-exclusao-de-usuarios-e-grupos-alem-de-como-gerenciar-suas-permissoes-no-sistema-linux","text":"1 - Entendendo Usu\u00e1rios e Grupos","title":"Este tutorial abrange os comandos essenciais para a cria\u00e7\u00e3o, modifica\u00e7\u00e3o e exclus\u00e3o de usu\u00e1rios e grupos, al\u00e9m de como gerenciar suas permiss\u00f5es no sistema Linux."},{"location":"Usuarios_e_Grupos-1/#no-linux-usuarios-sao-as-entidades-que-interagem-com-o-sistema-enquanto-grupos-sao-colecoes-de-usuarios-eles-sao-usados-para-organizar-usuarios-e-aplicar-permissoes-de-forma-eficiente","text":"Usu\u00e1rio Root: O superusu\u00e1rio com controle total sobre o sistema. Use-o com extrema cautela. Usu\u00e1rios Regulares: Usu\u00e1rios com privil\u00e9gios limitados. Usu\u00e1rios do Sistema: Usu\u00e1rios com privil\u00e9gios espec\u00edficos de servi\u00e7os/aplicativos. Grupos Prim\u00e1rios: O grupo padr\u00e3o ao qual um usu\u00e1rio pertence no momento da cria\u00e7\u00e3o. Grupos Suplementares: Grupos adicionais aos quais um usu\u00e1rio pode pertencer. 2 - Gerenciando Usu\u00e1rios","title":"No Linux, usu\u00e1rios s\u00e3o as entidades que interagem com o sistema, enquanto grupos s\u00e3o cole\u00e7\u00f5es de usu\u00e1rios. Eles s\u00e3o usados para organizar usu\u00e1rios e aplicar permiss\u00f5es de forma eficiente."},{"location":"Usuarios_e_Grupos-1/#criando-um-novo-usuario-use-o-comando-useradd","text":"sudo useradd [op\u00e7\u00f5es] <nome_do_usuario>","title":"Criando um Novo Usu\u00e1rio, use o comando useradd."},{"location":"Usuarios_e_Grupos-1/#opcoes-comuns","text":"-m Cria o diret\u00f3rio home do usu\u00e1rio se ele n\u00e3o existir. (Altamente recomendado) -s : Especifica o shell de login do usu\u00e1rio (ex: /bin/bash, /bin/zsh). -g : Define o grupo prim\u00e1rio do usu\u00e1rio. -G : Adiciona o usu\u00e1rio a grupos suplementares. -c \" \": Adiciona um coment\u00e1rio sobre o usu\u00e1rio (ex: nome completo).","title":"Op\u00e7\u00f5es Comuns:"},{"location":"Usuarios_e_Grupos-1/#exemplo","text":"sudo useradd -m -s /usr/bin/fish -aG www-data,sudo -c \"Jo\u00e3o Silva\" joaosilva Aten\u00e7\u00e3o Se a op\u00e7\u00e3o -a for omitida no comando usermod acima, o usu\u00e1rio \u00e9 removido de todos os outros grupos n\u00e3o listados em grupos_adicionais (i.e. o usu\u00e1rio ser\u00e1 membro apenas daqueles grupos em grupos_adicionais).","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#isso-cria-o-usuario-joaosilva-com-um-diretorio-home-bash-como-shell-padrao-e-o-adiciona-aos-grupos-www-data-e-sudo","text":"3 - Definindo a Senha de um Usu\u00e1rio","title":"Isso cria o usu\u00e1rio joaosilva com um diret\u00f3rio home, bash como shell padr\u00e3o, e o adiciona aos grupos www-data e sudo."},{"location":"Usuarios_e_Grupos-1/#apos-criar-um-usuario-ele-esta-logando-sem-senha-voce-precisa-definir-uma-senha-para-ele-usando-o-comando-passwd","text":"sudo passwd <nome_do_usuario>","title":"Ap\u00f3s criar um usu\u00e1rio, ele est\u00e1 logando sem senha, voc\u00ea precisa definir uma senha para ele usando o comando passwd."},{"location":"Usuarios_e_Grupos-1/#o-sistema-ira-pedir-para-voce-digitar-a-nova-senha-duas-vezes","text":"","title":"O sistema ir\u00e1 pedir para voc\u00ea digitar a nova senha duas vezes."},{"location":"Usuarios_e_Grupos-1/#exemplo_1","text":"sudo passwd joaosilva 4 - Modificando um Usu\u00e1rio Existente","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#o-comando-usermod-e-usado-para-modificar-as-propriedades-de-um-usuario","text":"sudo usermod [op\u00e7\u00f5es] <nome_do_usuario>","title":"O comando usermod \u00e9 usado para modificar as propriedades de um usu\u00e1rio."},{"location":"Usuarios_e_Grupos-1/#opcoes-comuns_1","text":"-l : Altera o nome de usu\u00e1rio (o diret\u00f3rio home e o grupo prim\u00e1rio n\u00e3o s\u00e3o alterados automaticamente). -d : Altera o diret\u00f3rio home do usu\u00e1rio. -m: Move o conte\u00fado do diret\u00f3rio home antigo para o novo (usado com -d). -s : Altera o shell de login. -g : Altera o grupo prim\u00e1rio. -G : Adiciona o usu\u00e1rio a grupos suplementares (sobrescreve os grupos existentes se n\u00e3o usar -a). -aG : Adiciona o usu\u00e1rio a grupos suplementares sem remover os existentes. (Altamente recomendado) -L: Bloqueia a conta do usu\u00e1rio. -U: Desbloqueia a conta do usu\u00e1rio.","title":"Op\u00e7\u00f5es Comuns:"},{"location":"Usuarios_e_Grupos-1/#exemplos","text":"","title":"Exemplos:"},{"location":"Usuarios_e_Grupos-1/#para-adicionar-joaosilva-ao-grupo-docker-sem-remover-outros-grupos","text":"sudo usermod -aG docker joaosilva","title":"Para adicionar joaosilva ao grupo docker sem remover outros grupos:"},{"location":"Usuarios_e_Grupos-1/#para-mudar-o-nome-de-usuario-de-joaosilva-para-jsilva","text":"sudo usermod -l jsilva joaosilva","title":"Para mudar o nome de usu\u00e1rio de joaosilva para jsilva:"},{"location":"Usuarios_e_Grupos-1/#importante-apos-renomear-um-usuario-com-l-o-diretorio-home-e-o-grupo-primario-ainda-terao-o-nome-antigo-voce-precisara-renomea-los-manualmente","text":"sudo mv /home/joaosilva /home/jsilva sudo groupmod -n jsilva joaosilva sudo usermod -d /home/jsilva -m jsilva","title":"Importante: Ap\u00f3s renomear um usu\u00e1rio com -l, o diret\u00f3rio home e o grupo prim\u00e1rio ainda ter\u00e3o o nome antigo. Voc\u00ea precisar\u00e1 renome\u00e1-los manualmente:"},{"location":"Usuarios_e_Grupos-1/#adiconar-um-usuario-a-um-grupo-especifico-com-o-comando-adduser","text":"sudo adduser jsilva tape","title":"Adiconar um usu\u00e1rio \u00e1 um grupo espec\u00edfico com o comando adduser:"},{"location":"Usuarios_e_Grupos-1/#adiconar-um-usuario-a-um-grupo-especifico-com-o-comando-gpasswd","text":"sudo gpasswd -a jsilva tape 5 - Excluindo um Usu\u00e1rio","title":"Adiconar um usu\u00e1rio \u00e1 um grupo espec\u00edfico com o comando gpasswd:"},{"location":"Usuarios_e_Grupos-1/#use-o-comando-userdel-para-remover-um-usuario","text":"sudo userdel [op\u00e7\u00f5es] <nome_do_usuario>","title":"Use o comando userdel para remover um usu\u00e1rio."},{"location":"Usuarios_e_Grupos-1/#opcoes-comuns_2","text":"-r: Remove o diret\u00f3rio home do usu\u00e1rio e o mail spool. (Altamente recomendado)","title":"Op\u00e7\u00f5es Comuns:"},{"location":"Usuarios_e_Grupos-1/#exemplo_2","text":"sudo userdel -r joaosilva 6 - Gerenciando Grupos","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#31-criando-um-novo-grupo","text":"","title":"3.1. Criando um Novo Grupo"},{"location":"Usuarios_e_Grupos-1/#use-o-comando-groupadd-para-criar-um-novo-grupo","text":"sudo groupadd [op\u00e7\u00f5es] <nome_do_grupo>","title":"Use o comando groupadd para criar um novo grupo."},{"location":"Usuarios_e_Grupos-1/#exemplo_3","text":"sudo groupadd desenvolvedores 7 - Modificando um Grupo Existente","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#o-comando-groupmod-e-usado-para-modificar-as-propriedades-de-um-grupo","text":"sudo groupmod [op\u00e7\u00f5es] <nome_do_grupo>","title":"O comando groupmod \u00e9 usado para modificar as propriedades de um grupo."},{"location":"Usuarios_e_Grupos-1/#opcoes-comuns_3","text":"-n : Altera o nome do grupo.","title":"Op\u00e7\u00f5es Comuns:"},{"location":"Usuarios_e_Grupos-1/#exemplo_4","text":"","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#para-mudar-o-nome-do-grupo-desenvolvedores-para-devs","text":"sudo groupmod -n devs desenvolvedores 8 - Excluindo um Grupo","title":"Para mudar o nome do grupo desenvolvedores para devs:"},{"location":"Usuarios_e_Grupos-1/#use-o-comando-groupdel-para-remover-um-grupo","text":"sudo groupdel <nome_do_grupo>","title":"Use o comando groupdel para remover um grupo."},{"location":"Usuarios_e_Grupos-1/#exemplo_5","text":"sudo groupdel devs 9 - Gerenciando Membros do Grupo","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#adicionando-usuarios-a-um-grupo","text":"","title":"Adicionando Usu\u00e1rios a um Grupo"},{"location":"Usuarios_e_Grupos-1/#para-adicionar-um-usuario-a-um-grupo-existente-a-maneira-mais-comum-e-usar-usermod-ag","text":"sudo usermod -aG <nome_do_grupo> <nome_do_usuario>","title":"Para adicionar um usu\u00e1rio a um grupo existente, a maneira mais comum \u00e9 usar usermod -aG."},{"location":"Usuarios_e_Grupos-1/#exemplo_6","text":"sudo usermod -aG www-data joaosilva 10 - Removendo Usu\u00e1rios de um Grupo","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#para-remover-um-usuario-de-um-grupo-voce-pode-usar-gpasswd-ou-deluser-dependendo-da-distribuicao","text":"","title":"Para remover um usu\u00e1rio de um grupo, voc\u00ea pode usar gpasswd ou deluser (dependendo da distribui\u00e7\u00e3o)."},{"location":"Usuarios_e_Grupos-1/#usando-gpasswd-mais-comum-e-recomendado","text":"sudo gpasswd -d <nome_do_usuario> <nome_do_grupo>","title":"Usando gpasswd (mais comum e recomendado):"},{"location":"Usuarios_e_Grupos-1/#exemplo_7","text":"sudo gpasswd -d joaosilva www-data","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#usando-deluser-disponivel-em-algumas-distribuicoes-como-debianubuntu","text":"sudo deluser <nome_do_usuario> <nome_do_grupo>","title":"Usando deluser (dispon\u00edvel em algumas distribui\u00e7\u00f5es como Debian/Ubuntu):"},{"location":"Usuarios_e_Grupos-1/#exemplo_8","text":"sudo deluser joaosilva www-data 11 - Visualizando Informa\u00e7\u00f5es de Usu\u00e1rios e Grupos","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#listar-usuarios","text":"","title":"Listar Usu\u00e1rios"},{"location":"Usuarios_e_Grupos-1/#as-informacoes-dos-usuarios-sao-armazenadas-em-etcpasswd-voce-pode-visualiza-lo-com-cat-ou-less","text":"cat /etc/passwd","title":"As informa\u00e7\u00f5es dos usu\u00e1rios s\u00e3o armazenadas em /etc/passwd. Voc\u00ea pode visualiz\u00e1-lo com cat ou less."},{"location":"Usuarios_e_Grupos-1/#listar-grupos","text":"","title":"Listar Grupos"},{"location":"Usuarios_e_Grupos-1/#as-informacoes-dos-grupos-sao-armazenadas-em-etcgroup","text":"cat /etc/group","title":"As informa\u00e7\u00f5es dos grupos s\u00e3o armazenadas em /etc/group."},{"location":"Usuarios_e_Grupos-1/#visualizar-informacoes-de-um-usuario-especifico","text":"","title":"Visualizar Informa\u00e7\u00f5es de um Usu\u00e1rio Espec\u00edfico"},{"location":"Usuarios_e_Grupos-1/#use-o-comando-id-para-ver-o-id-do-usuario-grupo-primario-e-grupos-suplementares-de-um-usuario","text":"id <nome_do_usuario>","title":"Use o comando id para ver o ID do usu\u00e1rio, grupo prim\u00e1rio e grupos suplementares de um usu\u00e1rio."},{"location":"Usuarios_e_Grupos-1/#exemplo_9","text":"id joaosilva","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#54-visualizar-membros-de-um-grupo","text":"grep <nome_do_grupo> /etc/group","title":"5.4. Visualizar Membros de um Grupo"},{"location":"Usuarios_e_Grupos-1/#exemplo_10","text":"grep sudo /etc/group","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#ou-em-algumas-distribuicoes-voce-pode-usar-members-se-instalado","text":"members <nome_do_grupo> 12 - Permiss\u00f5es de Arquivos e Diret\u00f3rios","title":"Ou, em algumas distribui\u00e7\u00f5es, voc\u00ea pode usar members (se instalado)."},{"location":"Usuarios_e_Grupos-1/#as-permissoes-no-linux-sao-baseadas-em-usuario-grupo-e-outros","text":"r (leitura): 4 w (escrita): 2 x (execu\u00e7\u00e3o): 1","title":"As permiss\u00f5es no Linux s\u00e3o baseadas em usu\u00e1rio, grupo e outros."},{"location":"Usuarios_e_Grupos-1/#a-combinacao-dessas-permissoes-e-um-numero-octal","text":"","title":"A combina\u00e7\u00e3o dessas permiss\u00f5es \u00e9 um n\u00famero octal."},{"location":"Usuarios_e_Grupos-1/#exemplo_11","text":"rwx (4+2+1 = 7), rw- (4+2+0 = 6), r-x (4+0+1 = 5).","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#61-alterando-permissoes-chmod","text":"","title":"6.1. Alterando Permiss\u00f5es (chmod)"},{"location":"Usuarios_e_Grupos-1/#use-chmod-para-alterar-as-permissoes-de-um-arquivo-ou-diretorio","text":"chmod <permiss\u00f5es_octais> <arquivo/diret\u00f3rio>","title":"Use chmod para alterar as permiss\u00f5es de um arquivo ou diret\u00f3rio."},{"location":"Usuarios_e_Grupos-1/#exemplo_12","text":"","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#dar-ao-proprietario-grupo-e-outros-permissao-total-leitura-escrita-execucao-para-um-script","text":"chmod 777 meu_script.sh","title":"Dar ao propriet\u00e1rio, grupo e outros permiss\u00e3o total (leitura, escrita, execu\u00e7\u00e3o) para um script:"},{"location":"Usuarios_e_Grupos-1/#dar-ao-proprietario-leituraescrita-ao-grupo-leitura-e-a-outros-nenhuma-permissao-para-um-arquivo","text":"chmod 640 meu_arquivo.txt","title":"Dar ao propriet\u00e1rio leitura/escrita, ao grupo leitura e a outros nenhuma permiss\u00e3o para um arquivo:"},{"location":"Usuarios_e_Grupos-1/#alterando-o-proprietario-chown","text":"","title":"Alterando o Propriet\u00e1rio (chown)"},{"location":"Usuarios_e_Grupos-1/#use-chown-para-alterar-o-proprietario-de-um-arquivo-ou-diretorio","text":"sudo chown <novo_proprietario> <arquivo/diret\u00f3rio>","title":"Use chown para alterar o propriet\u00e1rio de um arquivo ou diret\u00f3rio."},{"location":"Usuarios_e_Grupos-1/#exemplo_13","text":"sudo chown joaosilva meu_arquivo.txt","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#63-alterando-o-grupo-proprietario-chgrp","text":"","title":"6.3. Alterando o Grupo Propriet\u00e1rio (chgrp)"},{"location":"Usuarios_e_Grupos-1/#use-chgrp-para-alterar-o-grupo-proprietario-de-um-arquivo-ou-diretorio","text":"sudo chgrp <novo_grupo> <arquivo/diret\u00f3rio>","title":"Use chgrp para alterar o grupo propriet\u00e1rio de um arquivo ou diret\u00f3rio."},{"location":"Usuarios_e_Grupos-1/#exemplo_14","text":"sudo chgrp devs meu_arquivo.txt","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#voce-tambem-pode-usar-chown-para-alterar-o-proprietario-e-o-grupo-simultaneamente","text":"sudo chown <proprietario>:<grupo> <arquivo/diret\u00f3rio>","title":"Voc\u00ea tamb\u00e9m pode usar chown para alterar o propriet\u00e1rio e o grupo simultaneamente:"},{"location":"Usuarios_e_Grupos-1/#exemplo_15","text":"sudo chown joaosilva:devs meu_arquivo.txt","title":"Exemplo:"},{"location":"Usuarios_e_Grupos-1/#consideracoes-finais","text":"Sempre use sudo: A maioria dos comandos de gerenciamento de usu\u00e1rios e grupos requer privil\u00e9gios de superusu\u00e1rio. Seguran\u00e7a: Evite dar permiss\u00f5es excessivas. Siga o princ\u00edpio do menor privil\u00e9gio. Documenta\u00e7\u00e3o: Consulte as p\u00e1ginas man para obter informa\u00e7\u00f5es detalhadas sobre cada comando (ex: man useradd). Backup: Sempre fa\u00e7a backup de arquivos de configura\u00e7\u00e3o importantes (como /etc/passwd, /etc/group, /etc/shadow) antes de fazer grandes altera\u00e7\u00f5es. That's all folks","title":"Considera\u00e7\u00f5es Finais"},{"location":"Usuarios_e_Grupos-2/","text":"\ud83d\udcc1 Gerenciamento de Usu\u00e1rios e Grupos no Linux - Segunda parte. Como devemos proceder para adicionar um usu\u00e1rio a um grupo no sistema operacional Linux? Tornar um usu\u00e1rio membro de um grupo \u00e9 uma tarefa simples, que pode ser realizada com o uso dos comandos useradd, adduser, gpasswd ou usermod no terminal. Os comandos useradd e adduser (que \u00e9 um script na verdade) permitem criar um novo usu\u00e1rio no sistema, e al\u00e9m disso tamb\u00e9m permitem adicionar um usu\u00e1rio j\u00e1 existente a um grupo determinado. J\u00e1 o comando usermod permite modificar a conta de um usu\u00e1rio, e isso inclui torn\u00e1-lo membro de grupos existentes no sistema. Tamb\u00e9m vamos mostrar o comando gpasswd, que entre outras coisas permite gerenciar os grupos do sistema. Grupos prim\u00e1rios e grupos secund\u00e1rios: Grupo Prim\u00e1rio \u2013 \u00c9 o grupo criado juntamente com o usu\u00e1rio. Normalmente \u00e9 igual ao seu nome de login. Grupos Secund\u00e1rios \u2013 Os usu\u00e1rios tamb\u00e9m podem ser membros de outros grupos no sistema Linux. S\u00e3o muito \u00fateis para realizar compartilhamento de arquivos, diret\u00f3rios, dar permiss\u00f5es e outros elementos. As informa\u00e7\u00f5es sobre os grupos do sistema e usu\u00e1rios membros ficam armazenadas no arquivo /etc/group, o qual possui um lista dos grupos e seus respectivos membros. Exemplos de comandos para adicionar um usu\u00e1rio a um grupo: Vamos adicionar o usu\u00e1rio monica ao grupo marketing: adduser monica marketing Tamb\u00e9m podemos adicionar um usu\u00e1rio a um grupo usando o comando gpasswd: gpasswd -a usu\u00e1rio grupo Por exemplo, adicionando monica ao grupo rh: gpasswd -a monica rh Podemos definir um novo grupo prim\u00e1rio para o usu\u00e1rio com o comando usermod seguido da op\u00e7\u00e3o -g. Por exemplo, vamos trocar o grupo prim\u00e1rio da monica (que \u00e9 \u201cmonica\u201d) para grupo engenheiros: usermod -g engenheiros monica Ainda com o comando usermod, podemos tornar o usu\u00e1rio membro de v\u00e1rios grupos secund\u00e1rios (suplementares) especificados ao mesmo tempo. Vamos alterar a lista de grupos secund\u00e1rios e tornar a usu\u00e1ria monica membro dos grupos planilhas e memorandos: usermod -G planilhas,memorandos monica Note que no exemplo anterior o nosso usu\u00e1rio foi adicionado aos grupos planilhas e memorandos, por\u00e9m foi retirado dos outros grupos secund\u00e1rios dos quais era membro,como o grupo rh. Para que o usu\u00e1rio continue sendo membro dos grupos e seja acrescentado a novos grupos, sem deixar de ser membro dos anteriores, acrescente a op\u00e7\u00e3o -a ao comando anterior: usermod -aG planilhas,memorandos monica Verificando Verifique se o usu\u00e1rio foi adicionado a um grupo usando o comando groups seguido do nome do usu\u00e1rio: groups monica Os grupos dos quais o usu\u00e1rio \u00e9 membro aparecem listados em sequ\u00eancia, sendo que o primeiro grupo \u00e9 o grupo prim\u00e1rio do usu\u00e1rio e os demais s\u00e3o os grupos secund\u00e1rios. Removendo usu\u00e1rios de um grupo no Linux E se quisermos remover um usu\u00e1rio de um grupo? Podemos para isso usar o comando deluser, com a sintaxe a seguir: deluser usu\u00e1rio grupo Por exemplo, vamos excluir a monica do grupo de memorandos: deluser monica memorandos Tome cuidado para n\u00e3o esquecer de incluir o nome do grupo ao executar esse comando,pois voc\u00ea pode acabar excluindo a conta do usu\u00e1rio do sistema em vez de apenas retir\u00e1-lo de um grupo! Uma forma mais segura de excluir um usu\u00e1rio de um grupo \u00e9 por meio do comando gpasswd, como segue a sintaxe: gpasswd -d usu\u00e1rio grupo Remover o usu\u00e1rio monica do grupo planilhas: gpasswd -d monica planilhas","title":"\ud83d\udcc1 Gerenciamento de Usu\u00e1rios e Grupos no Linux - Segunda parte."},{"location":"Usuarios_e_Grupos-2/#gerenciamento-de-usuarios-e-grupos-no-linux-segunda-parte","text":"","title":"\ud83d\udcc1 Gerenciamento de Usu\u00e1rios e Grupos no Linux - Segunda parte."},{"location":"Usuarios_e_Grupos-2/#como-devemos-proceder-para-adicionar-um-usuario-a-um-grupo-no-sistema-operacional-linux","text":"Tornar um usu\u00e1rio membro de um grupo \u00e9 uma tarefa simples, que pode ser realizada com o uso dos comandos useradd, adduser, gpasswd ou usermod no terminal. Os comandos useradd e adduser (que \u00e9 um script na verdade) permitem criar um novo usu\u00e1rio no sistema, e al\u00e9m disso tamb\u00e9m permitem adicionar um usu\u00e1rio j\u00e1 existente a um grupo determinado. J\u00e1 o comando usermod permite modificar a conta de um usu\u00e1rio, e isso inclui torn\u00e1-lo membro de grupos existentes no sistema. Tamb\u00e9m vamos mostrar o comando gpasswd, que entre outras coisas permite gerenciar os grupos do sistema.","title":"Como devemos proceder para adicionar um usu\u00e1rio a um grupo no sistema operacional Linux?"},{"location":"Usuarios_e_Grupos-2/#grupos-primarios-e-grupos-secundarios","text":"Grupo Prim\u00e1rio \u2013 \u00c9 o grupo criado juntamente com o usu\u00e1rio. Normalmente \u00e9 igual ao seu nome de login. Grupos Secund\u00e1rios \u2013 Os usu\u00e1rios tamb\u00e9m podem ser membros de outros grupos no sistema Linux. S\u00e3o muito \u00fateis para realizar compartilhamento de arquivos, diret\u00f3rios, dar permiss\u00f5es e outros elementos. As informa\u00e7\u00f5es sobre os grupos do sistema e usu\u00e1rios membros ficam armazenadas no arquivo /etc/group, o qual possui um lista dos grupos e seus respectivos membros.","title":"Grupos prim\u00e1rios e grupos secund\u00e1rios:"},{"location":"Usuarios_e_Grupos-2/#exemplos-de-comandos-para-adicionar-um-usuario-a-um-grupo","text":"Vamos adicionar o usu\u00e1rio monica ao grupo marketing: adduser monica marketing Tamb\u00e9m podemos adicionar um usu\u00e1rio a um grupo usando o comando gpasswd: gpasswd -a usu\u00e1rio grupo Por exemplo, adicionando monica ao grupo rh: gpasswd -a monica rh Podemos definir um novo grupo prim\u00e1rio para o usu\u00e1rio com o comando usermod seguido da op\u00e7\u00e3o -g. Por exemplo, vamos trocar o grupo prim\u00e1rio da monica (que \u00e9 \u201cmonica\u201d) para grupo engenheiros: usermod -g engenheiros monica Ainda com o comando usermod, podemos tornar o usu\u00e1rio membro de v\u00e1rios grupos secund\u00e1rios (suplementares) especificados ao mesmo tempo. Vamos alterar a lista de grupos secund\u00e1rios e tornar a usu\u00e1ria monica membro dos grupos planilhas e memorandos: usermod -G planilhas,memorandos monica Note que no exemplo anterior o nosso usu\u00e1rio foi adicionado aos grupos planilhas e memorandos, por\u00e9m foi retirado dos outros grupos secund\u00e1rios dos quais era membro,como o grupo rh. Para que o usu\u00e1rio continue sendo membro dos grupos e seja acrescentado a novos grupos, sem deixar de ser membro dos anteriores, acrescente a op\u00e7\u00e3o -a ao comando anterior: usermod -aG planilhas,memorandos monica","title":"Exemplos de comandos para adicionar um usu\u00e1rio a um grupo:"},{"location":"Usuarios_e_Grupos-2/#verificando","text":"Verifique se o usu\u00e1rio foi adicionado a um grupo usando o comando groups seguido do nome do usu\u00e1rio: groups monica Os grupos dos quais o usu\u00e1rio \u00e9 membro aparecem listados em sequ\u00eancia, sendo que o primeiro grupo \u00e9 o grupo prim\u00e1rio do usu\u00e1rio e os demais s\u00e3o os grupos secund\u00e1rios.","title":"Verificando"},{"location":"Usuarios_e_Grupos-2/#removendo-usuarios-de-um-grupo-no-linux","text":"E se quisermos remover um usu\u00e1rio de um grupo? Podemos para isso usar o comando deluser, com a sintaxe a seguir: deluser usu\u00e1rio grupo Por exemplo, vamos excluir a monica do grupo de memorandos: deluser monica memorandos Tome cuidado para n\u00e3o esquecer de incluir o nome do grupo ao executar esse comando,pois voc\u00ea pode acabar excluindo a conta do usu\u00e1rio do sistema em vez de apenas retir\u00e1-lo de um grupo! Uma forma mais segura de excluir um usu\u00e1rio de um grupo \u00e9 por meio do comando gpasswd, como segue a sintaxe: gpasswd -d usu\u00e1rio grupo","title":"Removendo usu\u00e1rios de um grupo no Linux"},{"location":"Usuarios_e_Grupos-2/#remover-o-usuario-monica-do-grupo-planilhas","text":"gpasswd -d monica planilhas","title":"Remover o usu\u00e1rio monica do grupo planilhas:"},{"location":"Visao_Geral/","text":"\ud83d\udcd8 Guia de Estudos - Certifica\u00e7\u00e3o LPIC-1 Este guia cont\u00e9m os principais t\u00f3picos cobrados no exame LPIC-1 . \ud83d\udd17 P\u00e1gina oficial da LPI \ud83d\udcd1 Sum\u00e1rio Exame 101 T\u00f3pico 101 - Arquitetura do Sistema T\u00f3pico 102 - Instala\u00e7\u00e3o e Gerenciamento de Pacotes T\u00f3pico 103 - Comandos Linux T\u00f3pico 104 - Dispositivos, Sistemas de Arquivos e FHS Exame 102 T\u00f3pico 105 - Shell e Scripts T\u00f3pico 106 - Interfaces de Usu\u00e1rios e Desktops T\u00f3pico 107 - Tarefas Administrativas T\u00f3pico 108 - Servi\u00e7os Essenciais do Sistema T\u00f3pico 109 - Fundamentos de Rede T\u00f3pico 110 - Seguran\u00e7a \ud83d\udcd5 Exame 101 (T\u00f3picos 101 a 104) \ud83d\udd39 T\u00f3pico 101 - Arquitetura do Sistema 101.1 Identificar e editar configura\u00e7\u00f5es de hardware \u00c1reas de Conhecimento 1. Habilitar/desabilitar perif\u00e9ricos integrados 2. Configurar sistemas com perif\u00e9ricos externos (ex.: teclado) 3. Diferenciar tipos de dispositivos de armazenamento 4. Coldplug x Hotplug 5. Determinar recursos de hardware 6. Utilizar ferramentas de listagem ( lsusb , lspci , etc.) 7. Manipular dispositivos USB 8. Conceitos: sysfs , udev , dbus Ferramentas e Arquivos - Diret\u00f3rios \u2192 /sys/ , /proc/ , /dev/ - M\u00f3dulos \u2192 modprobe , lsmod - Listagem \u2192 lspci , lsusb 101.2 In\u00edcio (Boot) de Sistema \u00c1reas de Conhecimento - Comandos/op\u00e7\u00f5es de bootloader e kernel - Sequ\u00eancia de inicializa\u00e7\u00e3o do BIOS - Conhecimento do SysVinit e systemd - No\u00e7\u00f5es de Upstart - Logs de eventos de inicializa\u00e7\u00e3o Ferramentas e Arquivos - Logs \u2192 dmesg - Firmware \u2192 BIOS - Boot \u2192 bootloader , kernel , initramfs - Inicializa\u00e7\u00e3o \u2192 init , SysVinit , systemd 101.3 Runlevels, Boot Targets, Desligar e Reiniciar \u00c1reas de Conhecimento - Definir runlevel e boot target padr\u00e3o - Alternar entre runlevels/boot targets (modo single user) - Desligar/reiniciar pela linha de comando - Avisar usu\u00e1rios antes de altera\u00e7\u00f5es cr\u00edticas - Encerrar processos corretamente Ferramentas e Arquivos - Configura\u00e7\u00e3o \u2192 /etc/inittab , /etc/init.d/ , /etc/systemd/ , /usr/lib/systemd/ - Gerenciamento \u2192 shutdown , init , telinit - Systemd \u2192 systemd , systemctl - Comunica\u00e7\u00e3o \u2192 wall \ud83d\udd39 T\u00f3pico 102 - Instala\u00e7\u00e3o e Gerenciamento de Pacotes Exemplos de ferramentas por categoria: \u00c1rea Utilit\u00e1rios Parti\u00e7\u00f5es e sistemas de arquivos / , /var , /home , /boot , swap Bootloader (GRUB) menu.lst , grub.cfg , grub-install , grub-mkconfig , MBR Bibliotecas compartilhadas ldd , ldconfig , /etc/ld.so.conf , LD_LIBRARY_PATH Debian dpkg , apt-get , apt-cache , aptitude , /etc/apt/sources.list RedHat rpm , yum , /etc/yum.conf , /etc/yum.repos.d/ Virtualiza\u00e7\u00e3o M\u00e1quinas Virtuais, Cont\u00eaineres, cloud-init , chaves SSH \ud83d\udd39 T\u00f3pico 103 - Comandos Linux Organizados por tema: Linha de Comando \u2192 bash , echo , env , history , alias , PATH Filtros de Texto \u2192 cat , cut , head , sed , sort , uniq , wc Gerenciamento de Arquivos \u2192 cp , mv , rm , find , tar , dd , gzip Pipes e Redirecionamentos \u2192 tee , xargs , operadores > , >> , 2> Processos \u2192 ps , top , kill , jobs , nohup , screen , tmux Prioridade de Execu\u00e7\u00e3o \u2192 nice , renice Regex em Arquivos \u2192 grep , egrep , sed , regex(7) Edi\u00e7\u00e3o de Arquivos \u2192 vi , nano , emacs , vari\u00e1veis EDITOR \ud83d\udd39 T\u00f3pico 104 - Dispositivos, Sistemas de Arquivos e FHS Parti\u00e7\u00f5es e FS \u2192 fdisk , gdisk , parted , mkfs , mkswap Integridade FS \u2192 fsck , tune2fs , xfs_repair Montagem/Desmontagem \u2192 mount , umount , /etc/fstab , lsblk Permiss\u00f5es e Propriedade \u2192 chmod , umask , chown , chgrp Links \u2192 ln , ls Localiza\u00e7\u00e3o de Arquivos \u2192 find , locate , updatedb , which , /etc/updatedb.conf \ud83d\udcd5 Exame 102 (T\u00f3picos 105 a 110) \ud83d\udd39 T\u00f3pico 105 - Shell e Scripts Ambiente de Shell \u2192 PATH , alias , ~/.bashrc , /etc/profile Scripts B\u00e1sicos \u2192 for , while , if , read , exec , && , || \ud83d\udd39 T\u00f3pico 106 - Interfaces de Usu\u00e1rios e Desktops X11 \u2192 /etc/X11/xorg.conf , xhost , DISPLAY Desktops \u2192 KDE, Gnome, Xfce, VNC, RDP Acessibilidade \u2192 Leitor de Tela, Alto Contraste, Teclado Virtual \ud83d\udd39 T\u00f3pico 107 - Tarefas Administrativas Usu\u00e1rios/Grupos \u2192 useradd , usermod , /etc/passwd , /etc/shadow Automatiza\u00e7\u00e3o \u2192 cron , at , systemd timers Internacionaliza\u00e7\u00e3o \u2192 LANG , LC_ALL , /etc/localtime , timedatectl \ud83d\udd39 T\u00f3pico 108 - Servi\u00e7os Essenciais do Sistema Hora/Data \u2192 date , hwclock , ntpd , chrony Logs \u2192 rsyslog , logrotate , journalctl MTA \u2192 sendmail , postfix , mail Impress\u00e3o \u2192 cups , lpq , lpr \ud83d\udd39 T\u00f3pico 109 - Fundamentos de Rede Protocolos \u2192 TCP, UDP, ICMP, IPv4, IPv6, portas comuns Configura\u00e7\u00e3o de Rede \u2192 /etc/hosts , nmcli , hostnamectl Solu\u00e7\u00e3o de Problemas \u2192 ping , traceroute , ip , netstat DNS Cliente \u2192 /etc/resolv.conf , host , dig , getent \ud83d\udd39 T\u00f3pico 110 - Seguran\u00e7a Administra\u00e7\u00e3o de Seguran\u00e7a \u2192 find , passwd , nmap , sudo , ulimit Seguran\u00e7a de Host \u2192 /etc/shadow , /etc/hosts.allow , systemd.socket Criptografia \u2192 ssh , ssh-keygen , gpg , authorized_keys \ud83d\udccc Dica Final : estude os comandos na pr\u00e1tica, simulando cen\u00e1rios reais em laborat\u00f3rio.","title":"\ud83d\udcd8 Guia de Estudos - Certifica\u00e7\u00e3o LPIC-1"},{"location":"Visao_Geral/#guia-de-estudos-certificacao-lpic-1","text":"Este guia cont\u00e9m os principais t\u00f3picos cobrados no exame LPIC-1 . \ud83d\udd17 P\u00e1gina oficial da LPI","title":"\ud83d\udcd8 Guia de Estudos - Certifica\u00e7\u00e3o LPIC-1"},{"location":"Visao_Geral/#sumario","text":"Exame 101 T\u00f3pico 101 - Arquitetura do Sistema T\u00f3pico 102 - Instala\u00e7\u00e3o e Gerenciamento de Pacotes T\u00f3pico 103 - Comandos Linux T\u00f3pico 104 - Dispositivos, Sistemas de Arquivos e FHS Exame 102 T\u00f3pico 105 - Shell e Scripts T\u00f3pico 106 - Interfaces de Usu\u00e1rios e Desktops T\u00f3pico 107 - Tarefas Administrativas T\u00f3pico 108 - Servi\u00e7os Essenciais do Sistema T\u00f3pico 109 - Fundamentos de Rede T\u00f3pico 110 - Seguran\u00e7a","title":"\ud83d\udcd1 Sum\u00e1rio"},{"location":"Visao_Geral/#exame-101-topicos-101-a-104","text":"","title":"\ud83d\udcd5 Exame 101 (T\u00f3picos 101 a 104)"},{"location":"Visao_Geral/#topico-101-arquitetura-do-sistema","text":"","title":"\ud83d\udd39 T\u00f3pico 101 - Arquitetura do Sistema"},{"location":"Visao_Geral/#1011-identificar-e-editar-configuracoes-de-hardware","text":"\u00c1reas de Conhecimento 1. Habilitar/desabilitar perif\u00e9ricos integrados 2. Configurar sistemas com perif\u00e9ricos externos (ex.: teclado) 3. Diferenciar tipos de dispositivos de armazenamento 4. Coldplug x Hotplug 5. Determinar recursos de hardware 6. Utilizar ferramentas de listagem ( lsusb , lspci , etc.) 7. Manipular dispositivos USB 8. Conceitos: sysfs , udev , dbus Ferramentas e Arquivos - Diret\u00f3rios \u2192 /sys/ , /proc/ , /dev/ - M\u00f3dulos \u2192 modprobe , lsmod - Listagem \u2192 lspci , lsusb","title":"101.1 Identificar e editar configura\u00e7\u00f5es de hardware"},{"location":"Visao_Geral/#1012-inicio-boot-de-sistema","text":"\u00c1reas de Conhecimento - Comandos/op\u00e7\u00f5es de bootloader e kernel - Sequ\u00eancia de inicializa\u00e7\u00e3o do BIOS - Conhecimento do SysVinit e systemd - No\u00e7\u00f5es de Upstart - Logs de eventos de inicializa\u00e7\u00e3o Ferramentas e Arquivos - Logs \u2192 dmesg - Firmware \u2192 BIOS - Boot \u2192 bootloader , kernel , initramfs - Inicializa\u00e7\u00e3o \u2192 init , SysVinit , systemd","title":"101.2 In\u00edcio (Boot) de Sistema"},{"location":"Visao_Geral/#1013-runlevels-boot-targets-desligar-e-reiniciar","text":"\u00c1reas de Conhecimento - Definir runlevel e boot target padr\u00e3o - Alternar entre runlevels/boot targets (modo single user) - Desligar/reiniciar pela linha de comando - Avisar usu\u00e1rios antes de altera\u00e7\u00f5es cr\u00edticas - Encerrar processos corretamente Ferramentas e Arquivos - Configura\u00e7\u00e3o \u2192 /etc/inittab , /etc/init.d/ , /etc/systemd/ , /usr/lib/systemd/ - Gerenciamento \u2192 shutdown , init , telinit - Systemd \u2192 systemd , systemctl - Comunica\u00e7\u00e3o \u2192 wall","title":"101.3 Runlevels, Boot Targets, Desligar e Reiniciar"},{"location":"Visao_Geral/#topico-102-instalacao-e-gerenciamento-de-pacotes","text":"Exemplos de ferramentas por categoria: \u00c1rea Utilit\u00e1rios Parti\u00e7\u00f5es e sistemas de arquivos / , /var , /home , /boot , swap Bootloader (GRUB) menu.lst , grub.cfg , grub-install , grub-mkconfig , MBR Bibliotecas compartilhadas ldd , ldconfig , /etc/ld.so.conf , LD_LIBRARY_PATH Debian dpkg , apt-get , apt-cache , aptitude , /etc/apt/sources.list RedHat rpm , yum , /etc/yum.conf , /etc/yum.repos.d/ Virtualiza\u00e7\u00e3o M\u00e1quinas Virtuais, Cont\u00eaineres, cloud-init , chaves SSH","title":"\ud83d\udd39 T\u00f3pico 102 - Instala\u00e7\u00e3o e Gerenciamento de Pacotes"},{"location":"Visao_Geral/#topico-103-comandos-linux","text":"Organizados por tema: Linha de Comando \u2192 bash , echo , env , history , alias , PATH Filtros de Texto \u2192 cat , cut , head , sed , sort , uniq , wc Gerenciamento de Arquivos \u2192 cp , mv , rm , find , tar , dd , gzip Pipes e Redirecionamentos \u2192 tee , xargs , operadores > , >> , 2> Processos \u2192 ps , top , kill , jobs , nohup , screen , tmux Prioridade de Execu\u00e7\u00e3o \u2192 nice , renice Regex em Arquivos \u2192 grep , egrep , sed , regex(7) Edi\u00e7\u00e3o de Arquivos \u2192 vi , nano , emacs , vari\u00e1veis EDITOR","title":"\ud83d\udd39 T\u00f3pico 103 - Comandos Linux"},{"location":"Visao_Geral/#topico-104-dispositivos-sistemas-de-arquivos-e-fhs","text":"Parti\u00e7\u00f5es e FS \u2192 fdisk , gdisk , parted , mkfs , mkswap Integridade FS \u2192 fsck , tune2fs , xfs_repair Montagem/Desmontagem \u2192 mount , umount , /etc/fstab , lsblk Permiss\u00f5es e Propriedade \u2192 chmod , umask , chown , chgrp Links \u2192 ln , ls Localiza\u00e7\u00e3o de Arquivos \u2192 find , locate , updatedb , which , /etc/updatedb.conf","title":"\ud83d\udd39 T\u00f3pico 104 - Dispositivos, Sistemas de Arquivos e FHS"},{"location":"Visao_Geral/#exame-102-topicos-105-a-110","text":"","title":"\ud83d\udcd5 Exame 102 (T\u00f3picos 105 a 110)"},{"location":"Visao_Geral/#topico-105-shell-e-scripts","text":"Ambiente de Shell \u2192 PATH , alias , ~/.bashrc , /etc/profile Scripts B\u00e1sicos \u2192 for , while , if , read , exec , && , ||","title":"\ud83d\udd39 T\u00f3pico 105 - Shell e Scripts"},{"location":"Visao_Geral/#topico-106-interfaces-de-usuarios-e-desktops","text":"X11 \u2192 /etc/X11/xorg.conf , xhost , DISPLAY Desktops \u2192 KDE, Gnome, Xfce, VNC, RDP Acessibilidade \u2192 Leitor de Tela, Alto Contraste, Teclado Virtual","title":"\ud83d\udd39 T\u00f3pico 106 - Interfaces de Usu\u00e1rios e Desktops"},{"location":"Visao_Geral/#topico-107-tarefas-administrativas","text":"Usu\u00e1rios/Grupos \u2192 useradd , usermod , /etc/passwd , /etc/shadow Automatiza\u00e7\u00e3o \u2192 cron , at , systemd timers Internacionaliza\u00e7\u00e3o \u2192 LANG , LC_ALL , /etc/localtime , timedatectl","title":"\ud83d\udd39 T\u00f3pico 107 - Tarefas Administrativas"},{"location":"Visao_Geral/#topico-108-servicos-essenciais-do-sistema","text":"Hora/Data \u2192 date , hwclock , ntpd , chrony Logs \u2192 rsyslog , logrotate , journalctl MTA \u2192 sendmail , postfix , mail Impress\u00e3o \u2192 cups , lpq , lpr","title":"\ud83d\udd39 T\u00f3pico 108 - Servi\u00e7os Essenciais do Sistema"},{"location":"Visao_Geral/#topico-109-fundamentos-de-rede","text":"Protocolos \u2192 TCP, UDP, ICMP, IPv4, IPv6, portas comuns Configura\u00e7\u00e3o de Rede \u2192 /etc/hosts , nmcli , hostnamectl Solu\u00e7\u00e3o de Problemas \u2192 ping , traceroute , ip , netstat DNS Cliente \u2192 /etc/resolv.conf , host , dig , getent","title":"\ud83d\udd39 T\u00f3pico 109 - Fundamentos de Rede"},{"location":"Visao_Geral/#topico-110-seguranca","text":"Administra\u00e7\u00e3o de Seguran\u00e7a \u2192 find , passwd , nmap , sudo , ulimit Seguran\u00e7a de Host \u2192 /etc/shadow , /etc/hosts.allow , systemd.socket Criptografia \u2192 ssh , ssh-keygen , gpg , authorized_keys \ud83d\udccc Dica Final : estude os comandos na pr\u00e1tica, simulando cen\u00e1rios reais em laborat\u00f3rio.","title":"\ud83d\udd39 T\u00f3pico 110 - Seguran\u00e7a"}]}